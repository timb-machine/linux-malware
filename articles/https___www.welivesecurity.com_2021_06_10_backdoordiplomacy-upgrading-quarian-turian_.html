<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/css/main.css?id=09d01dd87b618f2315ce" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Adam Burgher',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>

<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>BackdoorDiplomacy: Upgrading from Quarian to Turian | WeLiveSecurity</title>
<meta name="description" content="ESET Research uncovers BackdoorDiplomacy, a new APT group that mainly targets ministries in the Middle East and Africa and deploys a backdoor ESET calls Turian."/>
<link rel="canonical" href="https://www.welivesecurity.com/2021/06/10/backdoordiplomacy-upgrading-quarian-turian/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="BackdoorDiplomacy: Upgrading from Quarian to Turian | WeLiveSecurity" />
<meta property="og:description" content="ESET Research uncovers BackdoorDiplomacy, a new APT group that mainly targets ministries in the Middle East and Africa and deploys a backdoor ESET calls Turian." />
<meta property="og:url" content="https://www.welivesecurity.com/2021/06/10/backdoordiplomacy-upgrading-quarian-turian/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2021-06-10T12:00:08+00:00" />
<meta property="article:modified_time" content="2021-08-02T10:41:53+00:00" />
<meta property="og:updated_time" content="2021-08-02T10:41:53+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/06/eset-research-apt-backdoordiplomacy-quarian-turian.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2021/06/eset-research-apt-backdoordiplomacy-quarian-turian.jpg" />
<meta property="og:image:width" content="623" />
<meta property="og:image:height" content="415" />
<meta property="og:image:alt" content="eset-research-apt-backdoordiplomacy-quarian-turian" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET Research uncovers BackdoorDiplomacy, a new APT group that mainly targets ministries in the Middle East and Africa and deploys a backdoor ESET calls Turian." />
<meta name="twitter:title" content="BackdoorDiplomacy: Upgrading from Quarian to Turian | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/06/eset-research-apt-backdoordiplomacy-quarian-turian.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/fr/2021/06/10/backdoordiplomacy-quarian-turian/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2021/06/10/backdoordiplomacy-upgrading-quarian-turian/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2021/06/10/backdoordiplomacy-actualizando-quarian-turian-backdoor-utilizado-contra-organizaciones-diplomaticas/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2021/06/11/backdoordiplomacy-von-quarian-zu-turian/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>

<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2021/06/10/backdoordiplomacy-quarian-turian/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2021/06/10/backdoordiplomacy-actualizando-quarian-turian-backdoor-utilizado-contra-organizaciones-diplomaticas/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2021/06/11/backdoordiplomacy-von-quarian-zu-turian/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2021/06/10/backdoordiplomacy-quarian-turian/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2021/06/10/backdoordiplomacy-actualizando-quarian-turian-backdoor-utilizado-contra-organizaciones-diplomaticas/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2021/06/11/backdoordiplomacy-von-quarian-zu-turian/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong>					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2021/06/eset-research-backdoordiplomacy-quarian-turian-apt.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>BackdoorDiplomacy: Upgrading from Quarian to Turian</h1>
<div class="excerpt">ESET researchers discover a new campaign that evolved from the Quarian backdoor</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/aburgher/" title="Adam Burgher">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2021/06/Adam-Burgher-222x179.jpg" alt="Adam Burgher">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/aburgher/" title="Adam Burgher">
                    Adam Burgher                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2021-06-10 14:00:08">10 Jun 2021 - 02:00PM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F06%2F10%2Fbackdoordiplomacy-upgrading-quarian-turian%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F06%2F10%2Fbackdoordiplomacy-upgrading-quarian-turian%2F&text=BackdoorDiplomacy: Upgrading from Quarian to Turian%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F06%2F10%2Fbackdoordiplomacy-upgrading-quarian-turian%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET researchers discover a new campaign that evolved from the Quarian backdoor</p>
                            </div>

                            <h2>Executive summary</h2>
<p>An APT group that we are calling BackdoorDiplomacy, due to the main vertical of its victims, has been targeting Ministries of Foreign Affairs and telecommunication companies in Africa and the Middle East since at least 2017. For initial infection vectors, the group favors exploiting vulnerable internet-exposed devices such as web servers and management interfaces for networking equipment. Once on a system, its operators make use of open-source tools for scanning the environment and lateral movement. Interactive access is achieved in two ways: (1) via a custom backdoor we are calling Turian that is derived from the Quarian backdoor; and (2) in fewer instances, when more direct and interactive access is required, certain open-source remote access tools are deployed. In several instances, the group has been observed targeting removable media for data collection and exfiltration. Finally, both Windows and Linux operating systems have been targeted.</p>
<h2>Links with known groups</h2>
<p>BackdoorDiplomacy shares commonalities with several other Asian groups. Most obvious among them is the connection between the Turian backdoor and the Quarian backdoor. Specific observations regarding the Turian-Quarian connection are recorded below in the <em>Turian</em> section. We believe this group is also linked with a group Kaspersky referred to as “<a href="https://securelist.com/apt-trends-report-q2-2020/97937/" target="_blank" rel="noopener"><em>CloudComputating</em></a>” that was also analyzed by <a href="https://www.sophos.com/en-us/threat-center/threat-analyses/viruses-and-spyware/Troj~SVProxy-A/detailed-analysis.aspx" target="_blank" rel="noopener"><em>Sophos</em></a>.</p>
<p>Several victims were compromised via mechanisms that closely matched the <a href="https://www.fortinet.com/blog/threat-research/rehashed-rat-used-in-apt-campaign-against-vietnamese-organizations" target="_blank" rel="noopener"><em>Rehashed Rat</em></a> and a <a href="https://www.intezer.com/blog/research/miragefox-apt15-resurfaces-with-new-tools-based-on-old-ones/" target="_blank" rel="noopener"><em>MirageFox-APT15</em></a> campaign documented by Fortinet in 2017 and Intezer in 2018, respectively. The BackdoorDiplomacy operators made use of their specific form of DLL Search-Order Hijacking.</p>
<p>Finally, the network encryption method BackdoorDiplomacy uses is quite similar to a backdoor <a href="https://news.drweb.com/show/?i=13907&amp;lng=en" target="_blank" rel="noopener"><em>Dr.Web</em></a> calls <a href="https://vms.drweb.co.jp/search/?q=BackDoor.Whitebird.1&amp;lng=en" target="_blank" rel="noopener"><em>Backdoor.Whitebird.1</em></a>. Whitebird was used to target government institutions in Kazakhstan and Kyrgyzstan (both neighbors of a BackdoorDiplomacy victim in Uzbekistan) within the same 2017-to-present timeframe in which BackdoorDiplomacy has been active.</p>
<h2>Victimology</h2>
<p>Quarian was used to target the <a href="https://securelist.com/a-targeted-attack-against-the-syrian-ministry-of-foreign-affairs/34742/" target="_blank" rel="noopener"><em>Syrian Ministry of Foreign Affairs in 2012</em></a>, as well as the <a href="https://threatconnect.com/blog/divide-and-conquer/" target="_blank" rel="noopener"><em>US State Department in 2013</em></a>. This trend of targeting Ministries of Foreign Affairs continues with Turian.</p>
<p>Victims have been discovered in the Ministries of Foreign Affairs of several African countries, as well as in Europe, the Middle East, and Asia. Additional targets include telecommunication companies in Africa, and at least one Middle Eastern charity. In each case, operators employed similar tactics, techniques, and procedures (TTPs), but modified the tools used, even within close geographic regions, likely to make tracking the group more difficult. See Figure 1 for a map of victims by country and vertical.</p>
<div id="attachment_151510" style="width: 810px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-1.-Victims-by-country-and-vertical.jpg"><img class="wp-image-151510" src="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-1.-Victims-by-country-and-vertical-300x182.jpg" alt="" width="800" height="485" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-1.-Victims-by-country-and-vertical-300x182.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-1.-Victims-by-country-and-vertical-768x466.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-1.-Victims-by-country-and-vertical-1024x621.jpg 1024w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><em>Figure 1. Victims by country and vertical</em></p></div>
<h2>Attack vectors</h2>
<p>BackdoorDiplomacy targeted servers with internet-exposed ports, likely exploiting unpatched vulnerabilities or poorly enforced file-upload security. In one specific instance, we observed the operators exploit an F5 BIP-IP vulnerability (<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-5902" target="_blank" rel="noopener"><em>CVE-2020-5902</em></a>) to drop a Linux backdoor. In another, a Microsoft Exchange server was exploited via a PowerShell dropper that installed <a href="https://attack.mitre.org/software/S0020/" target="_blank" rel="noopener"><em>China Chopper</em></a>, a well-known webshell in use, by various groups, since 2013. In a third, we observed a <a href="https://www.plesk.com/" target="_blank" rel="noopener"><em>Plesk</em></a> server with poorly configured file-upload security execute another webshell similar to China Chopper. See Figure 2 for an overview of the exploit chain.</p>
<div id="attachment_151511" style="width: 810px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-2.-Exploit-chain-from-initial-compromise-to-backdoor-with-CC-communications.jpg"><img class="wp-image-151511" src="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-2.-Exploit-chain-from-initial-compromise-to-backdoor-with-CC-communications-300x93.jpg" alt="" width="800" height="248" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-2.-Exploit-chain-from-initial-compromise-to-backdoor-with-CC-communications-300x93.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-2.-Exploit-chain-from-initial-compromise-to-backdoor-with-CC-communications-768x238.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-2.-Exploit-chain-from-initial-compromise-to-backdoor-with-CC-communications-1024x317.jpg 1024w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><em>Figure 2. Exploit chain from initial compromise to backdoor with C&amp;C communications</em></p></div>
<h2>Reconnaissance and lateral movement</h2>
<p>Following the initial compromise, in many instances the BackdoorDiplomacy group employed open-source reconnaissance and red-team tools to evaluate the environment for additional targets of opportunity and lateral movement. Among the tools documented are:</p>
<ul>
<li><a href="https://rootkiter.com/EarthWorm/en/index.html" target="_blank" rel="noopener"><em>EarthWorm</em></a>, a simple network tunnel with SOCKS v5 server and port transfer functionalities</li>
<li><a href="https://github.com/gentilkiwi/mimikatz/wiki" target="_blank" rel="noopener"><em>Mimikatz</em></a>, and various versions including <a href="https://github.com/GhostPack/SafetyKatz" target="_blank" rel="noopener"><em>SafetyKatz</em></a></li>
<li><a href="http://www.unixwiz.net/tools/nbtscan.html" target="_blank" rel="noopener"><em>Nbtscan</em></a>, a command line NetBIOS scanner for Windows</li>
<li><a href="http://netcat.sourceforge.net/" target="_blank" rel="noopener"><em>NetCat</em></a>, a networking utility that reads and writes data across network connections</li>
<li><a href="https://ss64.com/nt/portqry.html" target="_blank" rel="noopener"><em>PortQry</em></a>, a tool to display the status of TCP and UDP ports on remote systems</li>
<li><a href="https://github.com/3gstudent/Smbtouch-Scanner" target="_blank" rel="noopener"><em>SMBTouch</em></a>, used to determine whether a target is vulnerable to EternalBlue</li>
<li>Various tools from the ShadowBrokers dump of NSA tools including, but not limited to:
<ul>
<li>DoublePulsar</li>
<li>EternalBlue</li>
<li>EternalRocks</li>
<li>EternalSynergy</li>
</ul>
</li>
</ul>
<p>Commonly used directories for staging recon and lateral movement tools include:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">C:\Program Files\Windows Mail\en-US\</span></li>
<li><span style="font-family: courier new, courier, monospace;">%LOCALAPPDATA%\Microsoft\InstallAgent\Checkpoints\</span></li>
<li><span style="font-family: courier new, courier, monospace;">C:\ProgramData\ESET\ESET Security\Logs\eScan\</span></li>
<li><span style="font-family: courier new, courier, monospace;">%USERPROFILE%\ESET\ESET Security\Logs\eScan\</span></li>
<li><span style="font-family: courier new, courier, monospace;">C:\Program Files\hp\hponcfg\</span></li>
<li><span style="font-family: courier new, courier, monospace;">C:\Program Files\hp\hpssa\</span></li>
<li><span style="font-family: courier new, courier, monospace;">C:\hp\hpsmh\</span></li>
<li><span style="font-family: courier new, courier, monospace;">C:\ProgramData\Mozilla\updates\</span></li>
</ul>
<p>Of the tools listed above, many were obfuscated with VMProtect (v1.60-2.05), a recurring theme with BackdoorDiplomacy tools.</p>
<h2>Windows</h2>
<h3>Backdoor droppers</h3>
<p>In some instances, operators were observed uploading backdoor droppers. Operators attempted to disguise their backdoor droppers and evade detection in various ways.</p>
<ul>
<li>Naming conventions designed to blend into normal operations (e.g. <span style="font-family: courier new, courier, monospace;">amsc.exe</span>, <span style="font-family: courier new, courier, monospace;">msvsvr.dll</span>, <span style="font-family: courier new, courier, monospace;">alg.exe</span>)</li>
<li>Dropping implants in folders named for legitimate software (e.g., <span style="font-family: courier new, courier, monospace;">C:\Program Files\hp</span>, <span style="font-family: courier new, courier, monospace;">C:\ProgramData\ESET</span>, <span style="font-family: courier new, courier, monospace;">C:\ProgramData\Mozilla</span>)</li>
<li><a href="https://attack.mitre.org/techniques/T1574/001/" target="_blank" rel="noopener"><em>DLL search order hijacking</em></a></li>
</ul>
<p>In one such instance, the operators uploaded, via a webshell, both <span style="font-family: courier new, courier, monospace;">ScnCfg.exe</span> (SHA-1: <span style="font-family: courier new, courier, monospace;">573C35AB1F243D6806DEDBDD7E3265BC5CBD5B9A</span>), a legitimate McAfee executable, and <span style="font-family: courier new, courier, monospace;">vsodscpl.dll</span>, a malicious DLL named after a legitimate McAfee DLL that is called by <span style="font-family: courier new, courier, monospace;">ScnCfg.exe</span>. The version of <span style="font-family: courier new, courier, monospace;">vsodscpl.dll</span> (SHA-1: <span style="font-family: courier new, courier, monospace;">FCD8129EA56C8C406D1461CE9DB3E02E616D2AA9</span>) deployed was called by <span style="font-family: courier new, courier, monospace;">ScnCfg.exe</span>, at which point <span style="font-family: courier new, courier, monospace;">vsodscpl.dll</span> extracted Turian embedded within its code, wrote it to memory, and executed it.</p>
<p>On a different system, operators dropped a legitimate copy of <span style="font-family: courier new, courier, monospace;">credwize.exe</span>, the Microsoft Credential Backup and Restore Wizard, on disk and used it to execute the malicious library <span style="font-family: courier new, courier, monospace;">New.dll</span>, another Turian variant.</p>
<h3>Turian</h3>
<p>About half of the samples we collected were obfuscated with VMProtect. A compilation of observed operator commands is included in the <em>Operator commands</em> section. Unique network encryption schemes are individually discussed below as well.</p>
<h4><strong>Similarities with Quarian</strong></h4>
<p>The initial reporting by Kaspersky notes that the victims of Quarian were at the Syrian Ministry of Foreign Affairs, a similar target-set of Turian.</p>
<p>In many of the Turian samples we collected, there are obvious similarities with Quarian. Mutexes are used by both to verify that only one instance is running, although the mutexes used are dissimilarly named. We observed the following mutexes used by Turian:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">winsupdatetw</span></li>
<li><span style="font-family: courier new, courier, monospace;">clientsix</span></li>
<li><span style="font-family: courier new, courier, monospace;">client</span></li>
<li><span style="font-family: courier new, courier, monospace;">updatethres</span></li>
<li>Others: dynamically generated based on the system’s hostname, limited to eight hex characters, lower-case, and prefaced with a leading zero</li>
</ul>
<p>C&amp;C server domains and IP addresses are extracted with similar XOR routines; where Quarian uses a decryption key of <span style="font-family: courier new, courier, monospace;">0x44</span>, Turian uses <span style="font-family: courier new, courier, monospace;">0xA9</span>.</p>
<p>Turian and Quarian both read the first four bytes from the file <span style="font-family: courier new, courier, monospace;">cf</span> in the same directory as the malware’s executable, which are then used as the sleep length as part of the C&amp;C beacon routine.</p>
<p>The Turian network connection process follows a similar pattern to Quarian, attempting to make a direct connection. If that fails due to a local proxy with a response of 407 (Authorization Required), both try to use locally cached credentials. However, the request sent to the proxy by Turian does not contain any of the grammatical mistakes that Quarian sent. See Figure 3 for a comparison of proxy connection attempts.</p>
<div id="attachment_151512" style="width: 810px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-3.-Comparison-of-proxy-connection-attempts-Turian-left-and-Quarian-right.jpg"><img class="wp-image-151512" src="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-3.-Comparison-of-proxy-connection-attempts-Turian-left-and-Quarian-right-300x40.jpg" alt="" width="800" height="106" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-3.-Comparison-of-proxy-connection-attempts-Turian-left-and-Quarian-right-300x40.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-3.-Comparison-of-proxy-connection-attempts-Turian-left-and-Quarian-right-768x102.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-3.-Comparison-of-proxy-connection-attempts-Turian-left-and-Quarian-right-1024x135.jpg 1024w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><em>Figure 3. Comparison of proxy connection attempts, Turian (left) and Quarian (right)</em></p></div>
<p>Finally, both Turian and Quarian create a remote shell by copying <span style="font-family: courier new, courier, monospace;">cmd.exe</span> to<span style="font-family: courier new, courier, monospace;"> alg.exe</span>.</p>
<h4><strong>Persistence</strong></h4>
<p>After initial execution, Turian establishes persistence by creating the file <span style="font-family: courier new, courier, monospace;">tmp.bat</span> in the current working directory, writing the following lines to the file, then running the file:</p>
<p style="margin-left: 3%; margin-right: 3%;"><span style="font-family: courier new, courier, monospace;">ReG aDd HKEY_CURRENT_USER\sOFtWArE\MIcrOsOft\WindOwS\CurRentVeRsiOn\RuN /v Turian_filename&gt; /t REG_SZ /d “&lt;location_of_Turian_on_disk&gt;\&lt;Turian_fiilename&gt;” /f</span></p>
<p style="margin-left: 3%; margin-right: 2%;"><span style="font-family: courier new, courier, monospace;">ReG aDd HKEY_LOCAL_MACHINE\sOFtWArE\MIcrOsOft\WindOwS\CurRentVeRsiOn\RuN /v &lt;Turian_filename&gt; /t REG_SZ /d “&lt;location_of_Turian_on_disk&gt;\&lt;Turian_fiilename&gt;” /f</span></p>
<p style="margin-left: 3%; margin-right: 3%;"><span style="font-family: courier new, courier, monospace;">del %0</span></p>
<p>Turian then checks for the presence of the file <span style="font-family: courier new, courier, monospace;">Sharedaccess.ini</span> in its working directory. If that file is present, Turian attempts to load the C&amp;C IP or domain from there, if present. We did not observe Turian pass IPs or domains in this manner but testing confirmed Turian looks to load the C&amp;C address from here first. After checking <span style="font-family: courier new, courier, monospace;">Sharedaccess.ini</span>, Turian attempts to connect with a hardcoded IP or domain and sets up its network encryption protocol.</p>
<h4><strong>Network encryption</strong></h4>
<p>Quarian is known to have used both an eight-byte XOR key (see Talos on <a href="https://blog.talosintelligence.com/2012/12/quarian.html" target="_blank" rel="noopener"><em>Quarian: Reversing the C&amp;C Protocol</em></a>) and an eight-byte nonce to create a session key (see ThreatConnect on Quarian Network Protocol Analysis in <a href="https://threatconnect.com/blog/divide-and-conquer/" target="_blank" rel="noopener"><em>Divide and Conquer: Unmasking China’s ‘Quarian’ Campaigns Through Community</em></a>). Turian has a distinct method for exchanging network encryption keys. See Figure 4 for a breakdown of the Turian network encryption setup.</p>
<div id="attachment_151513" style="width: 810px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-4.-Turian-network-encryption-setup.jpg"><img class="wp-image-151513" src="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-4.-Turian-network-encryption-setup-300x232.jpg" alt="" width="800" height="618" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-4.-Turian-network-encryption-setup-300x232.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-4.-Turian-network-encryption-setup-768x594.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-4.-Turian-network-encryption-setup-1024x792.jpg 1024w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><em>Figure 4. Turian network encryption setup</em></p></div>
<p>After receiving the last 56-byte packet, Turian calls the network encryption initialization function in Figure 5, and accepts the 56 bytes of data in the last C&amp;C packet as the only argument.</p>
<div id="attachment_151514" style="width: 675px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-5.-Hex-Rays-decompiled-view-of-the-encryption-key-initialization-function.jpg"><img class="wp-image-151514 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-5.-Hex-Rays-decompiled-view-of-the-encryption-key-initialization-function.jpg" alt="" width="665" height="905" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-5.-Hex-Rays-decompiled-view-of-the-encryption-key-initialization-function.jpg 665w, https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-5.-Hex-Rays-decompiled-view-of-the-encryption-key-initialization-function-220x300.jpg 220w" sizes="(max-width: 665px) 100vw, 665px" /></a><p class="wp-caption-text"><em>Figure 5. Hex-Rays decompiled view of the encryption key initialization function</em></p></div>
<p>A second network encryption setup was also observed, as depicted in Figure 6.</p>
<div id="attachment_151515" style="width: 810px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-6.-Second-Turian-network-encryption-set-up-protocol.jpg"><img class="wp-image-151515" src="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-6.-Second-Turian-network-encryption-set-up-protocol-300x234.jpg" alt="" width="800" height="625" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-6.-Second-Turian-network-encryption-set-up-protocol-300x234.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-6.-Second-Turian-network-encryption-set-up-protocol-768x600.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-6.-Second-Turian-network-encryption-set-up-protocol.jpg 847w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><em>Figure 6. Second Turian network encryption set up protocol</em></p></div>
<p>The last iteration of the four-iteration loop (QWORD byte[5]) is used as the seed for the key initialization function, as shown below in Figure 7.</p>
<div id="attachment_151516" style="width: 705px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-7.-Second-key-initialization-function.jpg"><img class="wp-image-151516 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-7.-Second-key-initialization-function.jpg" alt="" width="695" height="860" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-7.-Second-key-initialization-function.jpg 695w, https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-7.-Second-key-initialization-function-242x300.jpg 242w" sizes="(max-width: 695px) 100vw, 695px" /></a><p class="wp-caption-text"><em>Figure 7. Second key initialization function</em></p></div>
<h3>Operator commands</h3>
<p>The full list of Turian operator commands is shown in Table 1.</p>
<p><em>Table 1. Turian C&amp;C commands</em></p>

<table id="tablepress-936" class="tablepress tablepress-id-936">
<thead>
<tr class="row-1 odd">
	<th class="column-1">ID</th><th class="column-2">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">0x01</td><td class="column-2">Get system information including OS version, memory usage, local hostname, system adapter info, internal IP, current username, state of the directory service installation and domain data.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">0x02</td><td class="column-2">Interactive shell – copy <span style="font-family: courier new, courier, monospace;">%WINDIR%\system32\cmd.exe </span>to <span style="font-family: courier new, courier, monospace;">%WINDIR%\alg.exe</span> and spawn <span style="font-family: courier new, courier, monospace;">alg.exe</span> in a new thread.</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">0x03</td><td class="column-2">Spawn a new thread, acknowledge the command and wait for one of the three-digit commands below.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">0x04</td><td class="column-2">Take screenshot.</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">0x103/203</td><td class="column-2">Write file.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">0x403</td><td class="column-2">List directory.</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">0x503</td><td class="column-2">Move file.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">0x603</td><td class="column-2">Delete file.</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">0x703</td><td class="column-2">Get startup info.</td>
</tr>
</tbody>
</table>

<h2>Targeting removable media</h2>
<p>A subset of victims was targeted with data collection executables that were designed to look for removable media (most likely USB flash drives). The implant routinely scans for such drives, specifically targeting removable media (return value of <span style="font-family: courier new, courier, monospace;">GetDriveType</span> is 2). If found, the implant uses an embedded version of WinRAR to execute these hardcoded commands:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">CMD.exe /C %s a -m5 -hp1qaz@WSX3edc -r %s %s\\*.*</span></li>
<li><span style="font-family: courier new, courier, monospace;">CMD.exe /C %s a -m5 -hpMyHost-1 -r %s %s\\*.*</span></li>
<li><span style="font-family: courier new, courier, monospace;">CMD.exe /C rd /s /q \&#8221;%s&#8221;\</span></li>
</ul>
<p>The parameters in the command break out to:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">a</span> == add files to archive</li>
<li><span style="font-family: courier new, courier, monospace;">-m[0:5]</span> == compression level</li>
<li><span style="font-family: courier new, courier, monospace;">-hp&lt;password&gt;</span></li>
<li><span style="font-family: courier new, courier, monospace;">-r</span> == recurse subdirectories</li>
<li><span style="font-family: courier new, courier, monospace;">rd</span> == remove directory</li>
<li><span style="font-family: courier new, courier, monospace;">/s</span> == delete a directory tree</li>
<li><span style="font-family: courier new, courier, monospace;">/q</span> == quiet mode</li>
<li><span style="font-family: courier new, courier, monospace;">\&#8221;%s&#8221;\</span> == directory to act on</li>
</ul>
<p>The implant, upon detecting a removable media being inserted, attempts to copy all the files on the drive to a password-protected archive and puts the archive in the following directory, which is hardcoded and so the same for every victim:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">C:\RECYCLER\S-1-3-33-854245398-2067806209-0000980848-2003\</span></li>
</ul>
<p>The implant also has the capability to delete files, based on the third command listed above.</p>
<h3>Remote access tools</h3>
<p>Occasionally, BackdoorDiplomacy’s operators require a greater degree of access or more interactivity than that  provided by Turian. On those occasions, they employ open-source remote access tools such as <a href="https://github.com/quasar/Quasar" target="_blank" rel="noopener"><em>Quasar</em></a>, which offers a wide variety of capabilities and runs on virtually all versions of Windows.</p>
<h2>Linux</h2>
<p>We discovered, via a shared C&amp;C server domain, a <a href="https://isc.sans.edu/diary/F5+BigIP+vulnerability+exploitation+followed+by+a+backdoor+implant+attempt/26322" target="_blank" rel="noopener"><em>Linux backdoor</em></a> using similar network infrastructure and that was deployed after exploiting a known vulnerability in F5 BIG-IP load balancers’ traffic management user interface (TMUI), which permits remote code execution (RCE). The Linux variant attempts to persist by writing itself to <a href="https://www.programmersought.com/article/62905849883/" target="_blank" rel="noopener"><em>/etc/init.d/rc.local</em></a></p>
<p>Next, it runs through a loop to extract strings from memory:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">bash -version</span></li>
<li><span style="font-family: courier new, courier, monospace;">echo $PWD</span></li>
<li><span style="font-family: courier new, courier, monospace;">/bin/sh</span></li>
<li><span style="font-family: courier new, courier, monospace;">/tmp/AntiVirtmp</span></li>
<li><span style="font-family: courier new, courier, monospace;">eth0</span></li>
<li><span style="font-family: courier new, courier, monospace;">/proc/%d/exe</span></li>
</ul>
<p>Then, it calls its daemon function and forks off a child process which then begins the work of decrypting the C&amp;C IP address and/or domain name then initiates a loop that reaches out to the C&amp;C using <span style="font-family: courier new, courier, monospace;">Mozilla/5.0 (X11; Linux i686; rv:22.0) Firefox/22.0</span> as its user-agent. This C&amp;C loop continues until a successful connection is made. Once a connection is established, the Linux agent goes through a similar network encryption setup to what the Windows version of Turian carries out. See Figure 8 for the network encryption protocol used by the Linux variant of Turian.</p>
<div id="attachment_151517" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-8.-Linux-Turian-variant-network-encryption-protocol-setup-routine.jpg"><img class="wp-image-151517" src="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-8.-Linux-Turian-variant-network-encryption-protocol-setup-routine-300x232.jpg" alt="" width="750" height="581" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-8.-Linux-Turian-variant-network-encryption-protocol-setup-routine-300x232.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-8.-Linux-Turian-variant-network-encryption-protocol-setup-routine-768x595.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-8.-Linux-Turian-variant-network-encryption-protocol-setup-routine-1024x794.jpg 1024w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><em>Figure 8. Linux Turian variant &#8211; network encryption protocol setup routine</em></p></div>
<p>After receiving the last 56-byte packet, the Linux agent calls the network encryption key initialization function depicted in Figure 9.</p>
<div id="attachment_151518" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-9.-Hex-Rays-decompiled-network-encryption-key-initialization-function.jpg"><img class="wp-image-151518" src="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-9.-Hex-Rays-decompiled-network-encryption-key-initialization-function-300x182.jpg" alt="" width="750" height="456" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-9.-Hex-Rays-decompiled-network-encryption-key-initialization-function-300x182.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-9.-Hex-Rays-decompiled-network-encryption-key-initialization-function-768x467.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2021/06/Figure-9.-Hex-Rays-decompiled-network-encryption-key-initialization-function.jpg 804w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><em>Figure 9. Hex-Rays decompiled network encryption key initialization function</em></p></div>
<p>Upon successful completion of the network protocol setup, it forks off another child process and attempts to spawn a TTY reverse shell :</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">python -c &#8216;import pty; pty.spawn(&#8220;/bin/sh&#8221;)&#8217;</span></li>
</ul>
<h2>Conclusion</h2>
<p>BackdoorDiplomacy is a group that primarily targets diplomatic organizations in the Middle East and Africa, and less frequently, telecommunication companies. Their initial attack methodology is focused on exploiting vulnerable internet-exposed applications on webservers, in order to drop and execute a webshell. Post compromise, via the webshell, BackdoorDiplomacy deploys open-source software for reconnaissance and information gathering, and favors the use of DLL search order hijacking to install its backdoor, Turian. Finally, BackdoorDiplomacy employs a separate executable to detect removable media, likely USB flash drives, and copy their contents to the main drive’s recycle bin.</p>
<p>BackdoorDiplomacy shares tactics, techniques, and procedures with other Asian groups. Turian likely represents a next stage evolution of Quarian, the backdoor last observed in use in 2013 against diplomatic targets in Syria and the United States. Turian’s network encryption protocol is nearly identical to the network encryption protocol used by Whitebird, a backdoor operated by Calypso, another Asian group. Whitebird was deployed within diplomatic organizations in Kazakhstan and Kyrgyzstan during the same timeframe as BackdoorDiplomacy (2017-2020). Additionally, BackdoorDiplomacy and APT15 use the same techniques and tactics to drop their backdoors on systems, namely the aforementioned DLL search order hijacking.</p>
<p>BackdoorDiplomacy is also cross-platform group targeting both Windows and Linux systems. The Linux variant of Turian shares the same network encryption protocol characteristics and attempts to return a TTY reverse shell to the operator.</p>
<h2>IoCs</h2>
<h3>Samples</h3>

<table id="tablepress-937" class="tablepress tablepress-id-937">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Filename</th><th class="column-3">ESET Detection Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">3C0DB3A5194E1568E8E2164149F30763B7F3043D</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">logout.aspx</span></td><td class="column-3">ASP/Webshell.H</td><td class="column-4">BackdoorDiplomacy webshell – variant N2</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">32EF3F67E06C43C18E34FB56E6E62A6534D1D694</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">current.aspx</span></td><td class="column-3">ASP/Webshell.O</td><td class="column-4">BackdoorDiplomacy webshell – variant S1</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">8C4D2ED23958919FE10334CCFBE8D78CD0D991A8</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">errorEE.aspx</span></td><td class="column-3">ASP/Webshell.J</td><td class="column-4">BackdoorDiplomacy webshell – variant N1</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">C0A3F78CF7F0B592EF813B15FC0F1D28D94C9604</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">App_Web_xcg2dubs.dll</span></td><td class="column-3">MSIL/Webshell.C</td><td class="column-4">BackdoorDiplomacy webshell – variant N3</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">CDD583BB6333644472733617B6DCEE2681238A11</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">N/A</span></td><td class="column-3">Linux/Agent.KD</td><td class="column-4">Linux Turian backdoor</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">FA6C20F00F3C57643F312E84CC7E46A0C7BABE75</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">N/A</span></td><td class="column-3">Linux/Agent.KD</td><td class="column-4">Linux Turian backdoor</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">5F87FBFE30CA5D6347F4462D02685B6E1E90E464</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">ScnCfg.exe</span></td><td class="column-3">Win32/Agent.TGO</td><td class="column-4">Windows Turian backdoor</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">B6936BD6F36A48DD1460EEB4AB8473C7626142AC</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">VMSvc.exe</span></td><td class="column-3">Win32/Agent.QKK</td><td class="column-4">Windows Turian backdoor</td>
</tr>
<tr class="row-10 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">B16393DFFB130304AD627E6872403C67DD4C0AF3</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">svchost.exe</span></td><td class="column-3">Win32/Agent.TZI</td><td class="column-4">Windows Turian backdoor</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">9DBBEBEBBA20B1014830B9DE4EC9331E66A159DF</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">nvsvc.exe</span></td><td class="column-3">Win32/Agent.UJH</td><td class="column-4">Windows Turian backdoor</td>
</tr>
<tr class="row-12 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">564F1C32F2A2501C3C7B51A13A08969CDC3B0390</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">AppleVersions.dll</span></td><td class="column-3">Win64/Agent.HA</td><td class="column-4">Windows Turian backdoor</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">6E1BB476EE964FFF26A86E4966D7B82E7BACBF47</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">MozillaUpdate.exe</span></td><td class="column-3">Win32/Agent.UJH</td><td class="column-4">Windows Turian backdoor</td>
</tr>
<tr class="row-14 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">FBB0A4F4C90B513C4E51F0D0903C525360FAF3B7</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">nvsvc.exe</span></td><td class="column-3">Win32/Agent.QAY</td><td class="column-4">Windows Turian backdoor</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">2183AE45ADEF97500A26DBBF69D910B82BFE721A</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">nvsvcv.exe</span></td><td class="column-3">Win32/Agent.UFX</td><td class="column-4">Windows Turian backdoor</td>
</tr>
<tr class="row-16 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">849B970652678748CEBF3C4D90F435AE1680601F</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">efsw.exe</span></td><td class="column-3">Win32/Agent.UFX</td><td class="column-4">Windows Turian backdoor</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">C176F36A7FC273C9C98EA74A34B8BAB0F490E19E</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">iexplore32.exe</span></td><td class="column-3">Win32/Agent.QAY</td><td class="column-4">Windows Turian backdoor</td>
</tr>
<tr class="row-18 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">626EFB29B0C58461D831858825765C05E1098786</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">iexplore32.exe</span></td><td class="column-3">Win32/Agent.UFX</td><td class="column-4">Windows Turian backdoor</td>
</tr>
<tr class="row-19 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">40E73BF21E31EE99B910809B3B4715AF017DB061</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">explorer32.exe</span></td><td class="column-3">Win32/Agent.QAY</td><td class="column-4">Windows Turian backdoor</td>
</tr>
<tr class="row-20 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">255F54DE241A3D12DEBAD2DF47BAC5601895E458</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">Duser.dll</span></td><td class="column-3">Win32/Agent.URH</td><td class="column-4">Windows Turian backdoor</td>
</tr>
<tr class="row-21 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">A99CF07FBA62A63A44C6D5EF6B780411CF1B1073</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">Duser.dll</span></td><td class="column-3">Win64/Agent.HA</td><td class="column-4">Windows Turian backdoor</td>
</tr>
<tr class="row-22 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">934B3934FDB4CD55DC4EA1577F9A394E9D74D660</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">Duser.dll</span></td><td class="column-3">Win32/Agent.TQI</td><td class="column-4">Windows Turian backdoor</td>
</tr>
<tr class="row-23 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">EF4DF176916CE5882F88059011072755E1ECC482</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">iexplore32.exe</span></td><td class="column-3">Win32/Agent.QAY</td><td class="column-4">Windows Turian backdoor</td>
</tr>
</tbody>
</table>

<h3>Network</h3>
<h4><strong>C&amp;Cs</strong></h4>

<table id="tablepress-938" class="tablepress tablepress-id-938">
<thead>
<tr class="row-1 odd">
	<th class="column-1">AS</th><th class="column-2">Hoster</th><th class="column-3">IP address</th><th class="column-4">Domain</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">AS20473</td><td class="column-2">AS-CHOOPA</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">199.247.9[.]67</span></td><td class="column-4"><span style="font-family: courier new, courier, monospace;">bill.microsoftbuys[.]com</span></td>
</tr>
<tr class="row-3 odd">
	<td rowspan="2" class="column-1">AS132839</td><td rowspan="2" class="column-2">POWER LINE DATACENTER</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">43.251.105[.]218</span></td><td rowspan="3" class="column-4"><span style="font-family: courier new, courier, monospace;">dnsupdate.dns2[.]us</span></td>
</tr>
<tr class="row-4 even">
	<td class="column-3"><span style="font-family: courier new, courier, monospace;">43.251.105[.]222</span></td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">AS40065</td><td class="column-2">Cnservers LLC</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">162.209.167[.]154</span></td>
</tr>
<tr class="row-6 even">
	<td class="column-1">AS132839</td><td class="column-2">POWER LINE DATACENTER</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">43.225.126[.]179</span></td><td class="column-4"><span style="font-family: courier new, courier, monospace;">www.intelupdate.dns1[.]us</span></td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">AS46573</td><td class="column-2">LAYER-HOST</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">23.247.47[.]252</span></td><td class="column-4"><span style="font-family: courier new, courier, monospace;">www.intelupdate.dns1[.]us</span></td>
</tr>
<tr class="row-8 even">
	<td class="column-1">AS132839</td><td class="column-2">POWER LINE DATACENTER</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">43.251.105[.]222</span></td><td rowspan="2" class="column-4"><span style="font-family: courier new, courier, monospace;">winupdate.ns02[.]us</span></td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">AS40065</td><td class="column-2">Cnservers LLC</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">162.209.167[.]189</span></td>
</tr>
<tr class="row-10 even">
	<td rowspan="2" class="column-1">AS25820</td><td rowspan="2" class="column-2">IT7NET</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">23.83.224[.]178</span></td><td rowspan="3" class="column-4"><span style="font-family: courier new, courier, monospace;">winupdate.ns02[.]us</span></td>
</tr>
<tr class="row-11 odd">
	<td class="column-3"><span style="font-family: courier new, courier, monospace;">23.106.140[.]207</span></td>
</tr>
<tr class="row-12 even">
	<td class="column-1">AS132839</td><td class="column-2">POWER LINE DATACENTER</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">43.251.105[.]218</span></td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">AS20473</td><td class="column-2">AS-CHOOPA</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">45.76.120[.]84</span></td><td rowspan="2" class="column-4"><span style="font-family: courier new, courier, monospace;">icta.worldmessg[.]com</span></td>
</tr>
<tr class="row-14 even">
	<td rowspan="4" class="column-1">AS20473</td><td rowspan="4" class="column-2">AS-CHOOPA</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">78.141.243[.]45</span></td>
</tr>
<tr class="row-15 odd">
	<td class="column-3"><span style="font-family: courier new, courier, monospace;">78.141.196[.]159</span></td><td class="column-4"><span style="font-family: courier new, courier, monospace;">Infoafrica[.]top</span></td>
</tr>
<tr class="row-16 even">
	<td class="column-3"><span style="font-family: courier new, courier, monospace;">45.77.215[.]53</span></td><td class="column-4"><span style="font-family: courier new, courier, monospace;">szsz.pmdskm[.]top</span></td>
</tr>
<tr class="row-17 odd">
	<td class="column-3"><span style="font-family: courier new, courier, monospace;">207.148.8[.]82</span></td><td class="column-4"><span style="font-family: courier new, courier, monospace;">pmdskm[.]top</span></td>
</tr>
<tr class="row-18 even">
	<td rowspan="2" class="column-1">AS132839</td><td rowspan="2" class="column-2">POWER LINE DATACENTER</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">43.251.105[.]139</span></td><td class="column-4"><span style="font-family: courier new, courier, monospace;">www.freedns02.dns2[.]us</span></td>
</tr>
<tr class="row-19 odd">
	<td class="column-3"><span style="font-family: courier new, courier, monospace;">43.251.105[.]139</span></td><td class="column-4"><span style="font-family: courier new, courier, monospace;">web.vpnkerio[.]com</span></td>
</tr>
<tr class="row-20 even">
	<td class="column-1">AS20473</td><td class="column-2">AS-CHOOPA</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">45.77.215[.]53</span></td><td class="column-4"></td>
</tr>
<tr class="row-21 odd">
	<td class="column-1">AS135377</td><td class="column-2">UCloud (HK) Holdings Group Limited</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">152.32.180[.]34</span></td><td class="column-4"></td>
</tr>
<tr class="row-22 even">
	<td class="column-1">AS132839</td><td class="column-2">POWER LINE DATACENTER</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">43.251.105[.]218</span></td><td class="column-4"><span style="font-family: courier new, courier, monospace;">officeupdates.cleansite[.]us</span></td>
</tr>
<tr class="row-23 odd">
	<td rowspan="3" class="column-1">AS25820</td><td rowspan="3" class="column-2">IT7NET</td><td rowspan="3" class="column-3"><span style="font-family: courier new, courier, monospace;">23.106.140[.]207</span></td><td class="column-4"><span style="font-family: courier new, courier, monospace;">dynsystem.imbbs[.]in</span></td>
</tr>
<tr class="row-24 even">
	<td class="column-4"><span style="font-family: courier new, courier, monospace;">officeupdate.ns01[.]us</span></td>
</tr>
<tr class="row-25 odd">
	<td class="column-4"><span style="font-family: courier new, courier, monospace;">systeminfo.oicp[.]net</span></td>
</tr>
<tr class="row-26 even">
	<td rowspan="4" class="column-1">AS40676</td><td rowspan="4" class="column-2">Psychz Networks</td><td rowspan="4" class="column-3"><span style="font-family: courier new, courier, monospace;">23.228.203[.]130</span></td><td class="column-4"><span style="font-family: courier new, courier, monospace;">systeminfo.myftp[.]name</span></td>
</tr>
<tr class="row-27 odd">
	<td class="column-4"><span style="font-family: courier new, courier, monospace;">systeminfo.cleansite[.]info</span></td>
</tr>
<tr class="row-28 even">
	<td class="column-4"><span style="font-family: courier new, courier, monospace;">updateip.onmypc[.]net</span></td>
</tr>
<tr class="row-29 odd">
	<td class="column-4"><span style="font-family: courier new, courier, monospace;">buffetfactory.oicp[.]io</span></td>
</tr>
</tbody>
</table>

<h4><strong>Registrars</strong></h4>

<table id="tablepress-939" class="tablepress tablepress-id-939">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Registrar</th><th class="column-2">Domain</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">expdns[.]net</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">update.officenews365[.]com</span></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">ezdnscenter[.]com</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">bill.microsoftbuys[.]com</span></td>
</tr>
<tr class="row-4 even">
	<td rowspan="9" class="column-1"><span style="font-family: courier new, courier, monospace;">changeip[.]org</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">dnsupdate.dns2[.]us</span></td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">dnsupdate.dns1[.]us</span></td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">www.intelupdate.dns1[.]us</span></td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">winupdate.ns02[.]us</span></td>
</tr>
<tr class="row-8 even">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">www.freedns02.dns2[.]us</span></td>
</tr>
<tr class="row-9 odd">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">officeupdates.cleansite[.]us</span></td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">officeupdate.ns01[.]us</span></td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">systeminfo.cleansite[.]info</span></td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">updateip.onmypc[.]net</span></td>
</tr>
<tr class="row-13 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">hichina[.]com</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">Infoafrica[.]top</span></td>
</tr>
<tr class="row-14 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">domaincontrol[.]com</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">web.vpnkerio[.]com</span></td>
</tr>
<tr class="row-15 odd">
	<td rowspan="2" class="column-1"><span style="font-family: courier new, courier, monospace;">exhera[.]com</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">dynsystem.imbbs[.]in</span></td>
</tr>
<tr class="row-16 even">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">systeminfo.oicp[.]net</span></td>
</tr>
</tbody>
</table>

<h2>MITRE ATT&amp;CK techniques</h2>
<p><em>Note: This table was built using </em><a href="https://attack.mitre.org/resources/versions/" target="_blank" rel="noopener"><em>version 9</em></a><em> of the MITRE ATT&amp;CK framework.</em></p>

<table id="tablepress-940" class="tablepress tablepress-id-940">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1190/" rel="noopener" target="_blank">T1190</a></td><td class="column-3">Exploit Public-Facing Application</td><td class="column-4">BackdoorDiplomacy exploits the vulnerability CVE-2020-5902.</td>
</tr>
<tr class="row-3 odd">
	<td rowspan="2" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1059/003/" rel="noopener" target="_blank">T1059.003</a></td><td class="column-3">Windows Command Shell</td><td class="column-4">Turian relies on a batch script to create persistence.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1203/" rel="noopener" target="_blank">T1203</a></td><td class="column-3">Exploitation for Client Execution</td><td class="column-4">Turian has exploited client software vulnerabilities for execution, such as CVE-2020-5902.</td>
</tr>
<tr class="row-5 odd">
	<td rowspan="2" class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1547/001/" rel="noopener" target="_blank">T1547.001</a></td><td class="column-3">Registry Run Keys / Startup Folder</td><td class="column-4">Turian uses the HKLM and HKCU  <span style="font-family: courier new, courier, monospace;">CurrentVersion</span> Run keys to persist after reboot.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1548/002/" rel="noopener" target="_blank">T1548.002</a></td><td class="column-3">Bypass User Account Control</td><td class="column-4">Turian uses JuicyPotato to bypass UAC.</td>
</tr>
<tr class="row-7 odd">
	<td rowspan="2" class="column-1">Privilege Escalation</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1547/001/" rel="noopener" target="_blank">T1547.001</a></td><td class="column-3">Registry Run Keys / Startup Folder</td><td class="column-4">Turian uses the HKLM and HKCU   <span style="font-family: courier new, courier, monospace;">CurrentVersion</span> Run keys to persist after reboot.</td>
</tr>
<tr class="row-8 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1548/002/" rel="noopener" target="_blank">T1548.002</a></td><td class="column-3">Bypass User Account Control</td><td class="column-4">Turian uses JuicyPotato to bypass UAC.</td>
</tr>
<tr class="row-9 odd">
	<td rowspan="3" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td><td class="column-3">Deobfuscate/Decode Files or Information</td><td class="column-4">Turian uses VMProtect to obfuscate its code.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1550/" rel="noopener" target="_blank">T1550</a></td><td class="column-3">Use Alternate Authentication Material</td><td class="column-4">Turian uses Mimikatz.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1083/" rel="noopener" target="_blank">T1083</a></td><td class="column-3">File and Directory Discovery</td><td class="column-4">Turian lists drives.</td>
</tr>
<tr class="row-12 even">
	<td class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1550/" rel="noopener" target="_blank">T1550</a></td><td class="column-3">Use Alternate Authentication Material</td><td class="column-4">Turian uses Mimikatz.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">Lateral Movement</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1005/" rel="noopener" target="_blank">T1005</a></td><td class="column-3">Data from Local System</td><td class="column-4">Turian collects files from the victim’s machine.</td>
</tr>
<tr class="row-14 even">
	<td rowspan="2" class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1113/" rel="noopener" target="_blank">T1113</a></td><td class="column-3">Screen Capture</td><td class="column-4">Turian captures screenshots.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1071/001/" rel="noopener" target="_blank">T1071.001</a></td><td class="column-3">Web Protocols</td><td class="column-4">Turian uses HTTP to communicate with the C&amp;C server.</td>
</tr>
<tr class="row-16 even">
	<td rowspan="2" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1573/001/" rel="noopener" target="_blank">T1573.001</a></td><td class="column-3">Symmetric Cryptography</td><td class="column-4">Turian uses XOR routine to encrypt communication with the C&amp;C server.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1095/" rel="noopener" target="_blank">T1095</a></td><td class="column-3">Non-Application Layer Protocol</td><td class="column-4">Turian uses raw sockets to communicate with the C&amp;C server.</td>
</tr>
</tbody>
</table>

<p><a class="no-fancy" href="https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=wls-research&amp;utm_content=backdoordiplomacy-upgrading-quarian-turian" target="_blank" rel="noopener"><img class="aligncenter wp-image-151620" src="https://www.welivesecurity.com/wp-content/uploads/2021/06/ETI-2-300x169.png" alt="" width="900" height="506" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/06/ETI-2-300x169.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/06/ETI-2-768x432.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/06/ETI-2-1024x576.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/06/ETI-2-143x79.png 143w, https://www.welivesecurity.com/wp-content/uploads/2021/06/ETI-2.png 1376w" sizes="(max-width: 900px) 100vw, 900px" /></a></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/aburgher/" title="Adam Burgher">
                    Adam Burgher                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2021-06-10 14:00:08">10 Jun 2021 - 02:00PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="NEWSLETTER" value="We Live Security">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button>
						Submit					</button>
				</div>
			</form>
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/12/15/dirty-dozen-latin-america-amavaldo-zumanek/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/12/banking-trojans-latin-america-research-623x415.jpg"
                                                         alt="BackdoorDiplomacy: Upgrading from Quarian to Turian">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/12/15/dirty-dozen-latin-america-amavaldo-zumanek/">
                                                    The dirty dozen of Latin America: From Amavaldo to Zumanek                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/12/02/launching-eset-research-podcast-peek-behind-scenes-eset-discoveries/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/12/eset-research-code-logo-thumbnail-623x432.png"
                                                         alt="BackdoorDiplomacy: Upgrading from Quarian to Turian">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/12/02/launching-eset-research-podcast-peek-behind-scenes-eset-discoveries/">
                                                    Launching ESET Research Podcast: A peek behind the scenes of ESET discoveries                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/12/01/jumping-air-gap-15-years-nation-state-effort/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/12/eset-research-jumping-air-gap-airgapped-malware-623x415.jpg"
                                                         alt="BackdoorDiplomacy: Upgrading from Quarian to Turian">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/12/01/jumping-air-gap-15-years-nation-state-effort/">
                                                    Jumping the air gap: 15 years of nation-state effort                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/11/16/strategic-web-compromises-middle-east-pinch-candiru/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/11/candiru-eset-research-middle-east-watering-hole-623x415.jpg"
                                                         alt="BackdoorDiplomacy: Upgrading from Quarian to Turian">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/11/16/strategic-web-compromises-middle-east-pinch-candiru/">
                                                    Strategic web compromises in the Middle East with a pinch of Candiru                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy Policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F06%2F10%2Fbackdoordiplomacy-upgrading-quarian-turian%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F06%2F10%2Fbackdoordiplomacy-upgrading-quarian-turian%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F06%2F10%2Fbackdoordiplomacy-upgrading-quarian-turian%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/js/main.js?id=fef3139dcedd23afc232"></script>
    <!-- Version: v1.4.4.685313.pro.awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"151501 https:\/\/backend.welivesecurity.com\/?p=151501","disqusShortname":"welivesecurity","disqusTitle":"BackdoorDiplomacy: Upgrading from Quarian to Turian","disqusUrl":"https:\/\/www.welivesecurity.com\/2021\/06\/10\/backdoordiplomacy-upgrading-quarian-turian\/","postId":"151501"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>
