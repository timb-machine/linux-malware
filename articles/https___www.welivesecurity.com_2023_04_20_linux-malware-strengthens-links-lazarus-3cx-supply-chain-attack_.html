<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <meta name="robots" content="max-image-preview:large">
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/css/main.css?id=c937631451c8fef9c5ad" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Peter Kálnai',
        'ArticleCategory': 'ESET Research',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });
</script>
<script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>

<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Linux malware strengthens links between Lazarus and the 3CX supply&#8209;chain attack | WeLiveSecurity</title>
<meta name="description" content="Similarities with newly discovered Linux malware used in Operation DreamJob corroborate the theory that the 3CX attack was carried out by Lazarus."/>
<link rel="canonical" href="https://www.welivesecurity.com/2023/04/20/linux-malware-strengthens-links-lazarus-3cx-supply-chain-attack/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Linux malware strengthens links between Lazarus and the 3CX supply&#8209;chain attack | WeLiveSecurity" />
<meta property="og:description" content="Similarities with newly discovered Linux malware used in Operation DreamJob corroborate the theory that the 3CX attack was carried out by Lazarus." />
<meta property="og:url" content="https://www.welivesecurity.com/2023/04/20/linux-malware-strengthens-links-lazarus-3cx-supply-chain-attack/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="ESET Research" />
<meta property="article:published_time" content="2023-04-20T09:30:34+00:00" />
<meta property="article:modified_time" content="2023-04-21T21:37:15+00:00" />
<meta property="og:updated_time" content="2023-04-21T21:37:15+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2023/04/lazarus-3cx-linux-malware-supply-chain-attack.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2023/04/lazarus-3cx-linux-malware-supply-chain-attack.jpg" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="667" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="Similarities with newly discovered Linux malware used in Operation DreamJob corroborate the theory that the 3CX attack was carried out by Lazarus." />
<meta name="twitter:title" content="Linux malware strengthens links between Lazarus and the 3CX supply&#8209;chain attack | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2023/04/lazarus-3cx-linux-malware-supply-chain-attack.jpg" />
<meta name="twitter:creator" content="@pkalnai" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-courier-new-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/courier-new.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/br/2023/05/02/malware-para-linux-reafirma-vinculo-entre-o-grupo-lazarus-e-o-ataque-a-cadeia-de-suprimentos-da-3cx/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/2023/04/20/linux-malware-strengthens-links-lazarus-3cx-supply-chain-attack/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2023/04/24/malware-linux-vincula-lazarus-ataque-cadena-suministro-3cx/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2023/04/20/linux-malware-liefert-beweis-lazarus-steckt-hinter-der-3cx-supply-chain-attacke/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
    
<script>(window.BOOMR_mq=window.BOOMR_mq||[]).push(["addVar",{"rua.upush":"false","rua.cpush":"false","rua.upre":"false","rua.cpre":"false","rua.uprl":"false","rua.cprl":"false","rua.cprf":"false","rua.trans":"","rua.cook":"false","rua.ims":"false","rua.ufprl":"false","rua.cfprl":"false","rua.isuxp":"false","rua.texp":"norulematch"}]);</script>
                              <script>!function(e){var n="https://s.go-mpulse.net/boomerang/";if("False"=="True")e.BOOMR_config=e.BOOMR_config||{},e.BOOMR_config.PageParams=e.BOOMR_config.PageParams||{},e.BOOMR_config.PageParams.pci=!0,n="https://s2.go-mpulse.net/boomerang/";if(window.BOOMR_API_key="7R9SM-QGSYF-QDLJK-UETXR-SPM6B",function(){function e(){if(!o){var e=document.createElement("script");e.id="boomr-scr-as",e.src=window.BOOMR.url,e.async=!0,i.parentNode.appendChild(e),o=!0}}function t(e){o=!0;var n,t,a,r,d=document,O=window;if(window.BOOMR.snippetMethod=e?"if":"i",t=function(e,n){var t=d.createElement("script");t.id=n||"boomr-if-as",t.src=window.BOOMR.url,BOOMR_lstart=(new Date).getTime(),e=e||d.body,e.appendChild(t)},!window.addEventListener&&window.attachEvent&&navigator.userAgent.match(/MSIE [67]\./))return window.BOOMR.snippetMethod="s",void t(i.parentNode,"boomr-async");a=document.createElement("IFRAME"),a.src="about:blank",a.title="",a.role="presentation",a.loading="eager",r=(a.frameElement||a).style,r.width=0,r.height=0,r.border=0,r.display="none",i.parentNode.appendChild(a);try{O=a.contentWindow,d=O.document.open()}catch(_){n=document.domain,a.src="javascript:var d=document.open();d.domain='"+n+"';void(0);",O=a.contentWindow,d=O.document.open()}if(n)d._boomrl=function(){this.domain=n,t()},d.write("<bo"+"dy onload='document._boomrl();'>");else if(O._boomrl=function(){t()},O.addEventListener)O.addEventListener("load",O._boomrl,!1);else if(O.attachEvent)O.attachEvent("onload",O._boomrl);d.close()}function a(e){window.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(!window.BOOMR||!window.BOOMR.version&&!window.BOOMR.snippetExecuted){window.BOOMR=window.BOOMR||{},window.BOOMR.snippetStart=(new Date).getTime(),window.BOOMR.snippetExecuted=!0,window.BOOMR.snippetVersion=12,window.BOOMR.url=n+"7R9SM-QGSYF-QDLJK-UETXR-SPM6B";var i=document.currentScript||document.getElementsByTagName("script")[0],o=!1,r=document.createElement("link");if(r.relList&&"function"==typeof r.relList.supports&&r.relList.supports("preload")&&"as"in r)window.BOOMR.snippetMethod="p",r.href=window.BOOMR.url,r.rel="preload",r.as="script",r.addEventListener("load",e),r.addEventListener("error",function(){t(!0)}),setTimeout(function(){if(!o)t(!0)},3e3),BOOMR_lstart=(new Date).getTime(),i.parentNode.appendChild(r);else t(!1);if(window.addEventListener)window.addEventListener("load",a,!1);else if(window.attachEvent)window.attachEvent("onload",a)}}(),"".length>0)if(e&&"performance"in e&&e.performance&&"function"==typeof e.performance.setResourceTimingBufferSize)e.performance.setResourceTimingBufferSize();!function(){if(BOOMR=e.BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},!BOOMR.plugins.AK){var n=""=="true"?1:0,t="",a="kbjpoos7mt6cgzcxyyqa-f-9d95afa05-clientnsv4-s.akamaihd.net",i="false"=="true"?2:1,o={"ak.v":"35","ak.cp":"1251022","ak.ai":parseInt("757730",10),"ak.ol":"0","ak.cr":41,"ak.ipv":4,"ak.proto":"http/1.1","ak.rid":"43ee445a","ak.r":31959,"ak.a2":n,"ak.m":"dscr","ak.n":"ff","ak.bpcip":"80.82.247.0","ak.cport":55793,"ak.gh":"95.100.252.31","ak.quicv":"","ak.tlsv":"tls1.3","ak.0rtt":"","ak.csrc":"-","ak.acc":"reno","ak.t":"1683473952","ak.ak":"hOBiQwZUYzCg5VSAfCLimQ==qBAmoUf7PwdEQ35Q8MexWLUrkgySZPqEDPRAemQvNqy7GPt7RuIi7WSmFgpWwcZOR6E8LZyafPiCSaF2F3mBnB8QvF/zYVv5vNb15p3i2eiFZa8cVsdpwlOE+ZTPYUbmC94Mf/G3I7+IcN3oPL2AnN3gPNJF52EGZdPjx2A1gzynnaqi95BhPMrvkFO/8fOLO/JfEInJaFpk9iDN3IxV91xnhjyhC5ScAz0eHLV8cLdtVlEqOmcheHXowf+8sHWB4N+3jfeVwpvhvCUjm0TaqcKDpp1Uz/ZAnb6c7DL/7aBwETTRiG6ETGJgB2xqA0LCmEG09RBCfyViX5+2ymSEpSi4zR1oKUfcVmuX/9fqOFqkqyWo1OIrphJEId4Npbs8J1Pv9HBJZTeT8166BMw9DLn5Hni65qghdutp7fxXEjI=","ak.pv":"12","ak.dpoabenc":"","ak.tf":i};if(""!==t)o["ak.ruds"]=t;var r={i:!1,av:function(n){var t="http.initiator";if(n&&(!n[t]||"spa_hard"===n[t]))o["ak.feo"]=void 0!==e.aFeoApplied?1:0,BOOMR.addVar(o)},rv:function(){var e=["ak.bpcip","ak.cport","ak.cr","ak.csrc","ak.gh","ak.ipv","ak.m","ak.n","ak.ol","ak.proto","ak.quicv","ak.tlsv","ak.0rtt","ak.r","ak.acc","ak.t","ak.tf"];BOOMR.removeVar(e)}};BOOMR.plugins.AK={akVars:o,akDNSPreFetchDomain:a,init:function(){if(!r.i){var e=BOOMR.subscribe;e("before_beacon",r.av,null,null),e("onbeacon",r.rv,null,null),r.i=!0}return this},is_complete:function(){return!0}}}}()}(window);</script></head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>

<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2023/05/02/malware-para-linux-reafirma-vinculo-entre-o-grupo-lazarus-e-o-ataque-a-cadeia-de-suprimentos-da-3cx/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2023/04/24/malware-linux-vincula-lazarus-ataque-cadena-suministro-3cx/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2023/04/20/linux-malware-liefert-beweis-lazarus-steckt-hinter-der-3cx-supply-chain-attacke/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://welivesecurity.com/category/ukraine-crisis-digital-security-resource-center/">
                                            Ukraine Crisis – Digital Security Resource Center                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/we-live-progress/">
                                            We Live Progress                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/resources/">
                                            Resources                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2023/05/02/malware-para-linux-reafirma-vinculo-entre-o-grupo-lazarus-e-o-ataque-a-cadeia-de-suprimentos-da-3cx/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2023/04/24/malware-linux-vincula-lazarus-ataque-cadena-suministro-3cx/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2023/04/20/linux-malware-liefert-beweis-lazarus-steckt-hinter-der-3cx-supply-chain-attacke/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong>					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2023/04/3cx-lazarus-linux-malware-supply-chain-attack.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Linux malware strengthens links between Lazarus and the 3CX supply&#8209;chain attack</h1>
<div class="excerpt">Similarities with newly discovered Linux malware used in Operation DreamJob corroborate the theory that the infamous North Korea-aligned group is behind the 3CX supply-chain attack</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/pkalnai/" title="Peter Kálnai">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2016/12/kalnai_peter_photo-222x179.png" alt="Peter Kálnai">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/pkalnai/" title="Peter Kálnai">
                    Peter Kálnai                </a>
            </div>
        </div>
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/marc-etienne/" title="Marc-Etienne M.Léveillé">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2013/06/Marc-Etienne-M.Leveille.png" alt="Marc-Etienne M.Léveillé">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/marc-etienne/" title="Marc-Etienne M.Léveillé">
                    Marc-Etienne M.Léveillé                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2023-04-20 11:30:34">20 Apr 2023 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2023%2F04%2F20%2Flinux-malware-strengthens-links-lazarus-3cx-supply-chain-attack%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2023%2F04%2F20%2Flinux-malware-strengthens-links-lazarus-3cx-supply-chain-attack%2F&text=Linux malware strengthens links between Lazarus and the 3CX supply&#8209;chain attack%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2023%2F04%2F20%2Flinux-malware-strengthens-links-lazarus-3cx-supply-chain-attack%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>Similarities with newly discovered Linux malware used in Operation DreamJob corroborate the theory that the infamous North Korea-aligned group is behind the 3CX supply-chain attack</p>
                            </div>

                            <p>ESET researchers have discovered a new Lazarus Operation DreamJob campaign targeting Linux users. Operation DreamJob is the name for a series of campaigns where the group uses social engineering techniques to compromise its targets, with fake job offers as the lure. In this case, we were able to reconstruct the full chain, from the ZIP file that delivers a fake HSBC job offer as a decoy, up until the final payload: the SimplexTea Linux backdoor distributed through an <a href="https://www.opendrive.com/" target="_blank" rel="noopener">OpenDrive</a> cloud storage account. To our knowledge, this is the first public mention of this major North Korea-aligned threat actor using Linux malware as part of this operation.</p>
<p>Additionally, this discovery helped us confirm with a high level of confidence that the recent 3CX supply-chain attack was in fact conducted by Lazarus – a link that was suspected from the very beginning and demonstrated by several security researchers since. In this blogpost, we corroborate these findings and provide additional evidence about the connection between Lazarus and the 3CX supply-chain attack.</p>
<h2>The 3CX supply-chain attack</h2>
<p>3CX is an international VoIP software developer and distributor that provides phone system services to many organizations. According to its website, 3CX has more than 600,000 customers and 12,000,000 users in various sectors including aerospace, healthcare, and hospitality. It provides client software to use its systems via a web browser, mobile app, or a desktop application. Late in March 2023, it was discovered that the desktop application for both Windows and macOS contained malicious code that enabled a group of attackers to download and run arbitrary code on all machines where the application was installed. Rapidly, it was determined that this malicious code was not something that 3CX added themselves, but that 3CX was compromised and that its software was used in a supply-chain attack driven by external threat actors to distribute additional malware to specific 3CX customers.</p>
<p>This cyber-incident has made headlines in recent days. Initially reported on March 29<sup>th</sup>, 2023 in a <a href="https://www.reddit.com/r/crowdstrike/comments/125r3uu/20230329_situational_awareness_crowdstrike/" target="_blank" rel="noopener">Reddit</a> thread by a CrowdStrike engineer, followed by an official report by <a href="https://www.crowdstrike.com/blog/crowdstrike-detects-and-prevents-active-intrusion-campaign-targeting-3cxdesktopapp-customers/" target="_blank" rel="noopener">CrowdStrike</a>, stating with high confidence that LABIRINTH CHOLLIMA, the company’s codename for Lazarus, was behind the attack (but omitting any evidence backing up the claim). Because of the seriousness of the incident, multiple security companies started to contribute their summaries of the events, namely <a href="https://news.sophos.com/en-us/2023/03/29/3cx-dll-sideloading-attack/" target="_blank" rel="noopener">Sophos</a>, <a href="https://blog.checkpoint.com/2023/03/29/3cxdesktop-app-trojanizes-in-a-supply-chain-attack-check-point-customers-remain-protected/" target="_blank" rel="noopener">Check Point</a>, <a href="https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/3cx-supply-chain-attack" target="_blank" rel="noopener">Broadcom</a>, <a href="https://www.trendmicro.com/fr_fr/research/23/c/information-on-attacks-involving-3cx-desktop-app.html" target="_blank" rel="noopener">Trend Micro</a>, and more.</p>
<p>Further, the part of the attack affecting systems running macOS was covered in detail in a <a href="https://twitter.com/patrickwardle/status/1641294247877021696" target="_blank" rel="noopener">Twitter</a> thread and a <a href="https://objective-see.org/blog/blog_0x73.html" target="_blank" rel="noopener">blogpost</a> by Patrick Wardle.</p>
<h2>Timeline of events</h2>
<div id="attachment_173259" style="width: 2155px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2023/04/1_3cx_timeline.png"><img class="wp-image-173259 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2023/04/1_3cx_timeline.png" alt="" width="2145" height="889" srcset="https://www.welivesecurity.com/wp-content/uploads/2023/04/1_3cx_timeline.png 2145w, https://www.welivesecurity.com/wp-content/uploads/2023/04/1_3cx_timeline-300x124.png 300w, https://www.welivesecurity.com/wp-content/uploads/2023/04/1_3cx_timeline-768x318.png 768w, https://www.welivesecurity.com/wp-content/uploads/2023/04/1_3cx_timeline-1024x424.png 1024w" sizes="(max-width: 2145px) 100vw, 2145px" /></a><p class="wp-caption-text"><em>Figure 1. Timeline of events related to the preparation and distribution of 3CX trojanized applications</em></p></div>
<p>The timeline shows that the perpetrators had planned the attacks long before execution; as early as December 2022. This suggests they already had a foothold inside 3CX’s network late last year.</p>
<p>While the trojanized 3CX macOS application shows it was signed in late January, we did not see the bad application in our telemetry until February 14<sup>th</sup>, 2023. It is unclear whether the malicious update for macOS was distributed prior to that date.</p>
<p>Although ESET telemetry shows the existence of the macOS second-stage payload as early as February, we did not have the sample itself, nor metadata to tip us off about its maliciousness. We include this information to help defenders determine how far back systems might have been compromised.</p>
<p>Several days before the attack was publicly revealed, a mysterious Linux downloader was submitted to VirusTotal. It downloads a new Lazarus malicious payload for Linux and we explain its relationship to the attack later in the text.</p>
<h2>Attribution of the 3CX supply-chain attack to Lazarus</h2>
<h3>What is already published</h3>
<p>There is one domain that plays a significant role in our attribution reasoning: <span style="font-family: 'courier new', courier, monospace;">journalide[.]org</span>. It is mentioned in some of the vendor reports linked above, but its presence is never explained. Interestingly, articles by <a href="https://www.sentinelone.com/blog/smoothoperator-ongoing-campaign-trojanizes-3cx-software-in-software-supply-chain-attack/" target="_blank" rel="noopener">SentinelOne</a> and <a href="https://objective-see.org/blog/blog_0x73.html" target="_blank" rel="noopener">ObjectiveSee</a> do not mention this domain. Neither does a blogpost by <a href="https://www.volexity.com/blog/2023/03/30/3cx-supply-chain-compromise-leads-to-iconic-incident/" target="_blank" rel="noopener">Volexity</a>, which even refrained from providing attribution, stating <em>“Volexity cannot currently map the disclosed activity to any threat actor”</em>. Its analysts were among the first to investigate the attack in depth and they created a tool to extract a list of C&amp;C servers from encrypted icons on GitHub. This tool is useful, as the attackers did not embed the C&amp;C servers directly in the intermediate stages, but rather used GitHub as a dead drop resolver. The intermediate stages are downloaders for Windows and macOS that we denote as IconicLoaders, and the payloads they get as IconicStealer and UpdateAgent, respectively.</p>
<p>On March 30<sup>th</sup>, Joe Desimone, a security researcher from <a href="https://www.elastic.co/kr/security-labs/elastic-users-protected-from-suddenicon-supply-chain-attack" target="_blank" rel="noopener">Elastic Security</a>, was among the first to provide, in a <a href="https://twitter.com/dez_/status/1641459372478935040" target="_blank" rel="noopener">Twitter</a> thread, substantial clues that the 3CX-driven compromises are probably linked to Lazarus. He observed that a shellcode stub prepended to the payload from <span style="font-family: 'courier new', courier, monospace;">d3dcompiler_47.dll</span> is similar to AppleJeus loader stubs attributed to Lazarus by <a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-048a">CISA</a> back in April 2021.</p>
<p>On March 31<sup>st</sup> it was <a href="https://www.cybersecuritydive.com/news/3cx-mandiant-investigate-supply-chain-attack/646543/">being</a> <a href="https://www.crn.com/news/security/3cx-supply-chain-attack-big-questions-remain" target="_blank" rel="noopener">reported</a> that 3CX had retained Mandiant to provide incident response services relating to the supply-chain attack.</p>
<p>On April 3<sup>rd</sup>, <a href="https://securelist.com/gopuram-backdoor-deployed-through-3cx-supply-chain-attack/109344/" target="_blank" rel="noopener">Kaspersky</a>, through its telemetry, showed a direct relationship between the 3CX supply-chain victims and the deployment of a backdoor dubbed Gopuram, both involving payloads with a common name, <span style="font-family: 'courier new', courier, monospace;">guard64.dll</span>. Kaspersky data shows that Gopuram is connected to Lazarus because it coexisted on victim machines alongside <a href="https://securelist.com/operation-applejeus-sequel/95596/" target="_blank" rel="noopener">AppleJeus</a>, malware that was already attributed to Lazarus. Both Gopuram and AppleJeus were observed in attacks against a cryptocurrency company.</p>
<p>Then, on April 11<sup>th</sup>, the CISO of 3CX summarized Mandiant’s interim findings in a <a href="https://www.3cx.com/blog/news/mandiant-initial-results/" target="_blank" rel="noopener">blogpost</a>. According to that report, two Windows malware samples, a shellcode loader called TAXHAUL and a complex downloader named COLDCAT, were involved in the compromise of 3CX. No hashes were provided, but Mandiant’s YARA rule, named TAXHAUL, also triggers on other samples already on VirusTotal:</p>
<ul>
<li>SHA-1: <span style="font-family: 'courier new', courier, monospace;">2ACC6F1D4656978F4D503929B8C804530D7E7CF6</span> (<span style="font-family: 'courier new', courier, monospace;">ualapi.dll</span>),</li>
<li>SHA-1: <span style="font-family: 'courier new', courier, monospace;">DCEF83D8EE080B54DC54759C59F955E73D67AA65</span> (<span style="font-family: 'courier new', courier, monospace;">wlbsctrl.dll</span>)</li>
</ul>
<p>The filenames, but not MD5s, of these samples coincide with those from Kaspersky’s blogpost. However, 3CX explicitly states that COLDCAT differs from Gopuram.</p>
<p>The next section contains a technical description of the new Lazarus malicious Linux payload we recently analyzed, as well as how it helped us strengthen the existing link between Lazarus and the 3CX compromise.</p>
<h2>Operation DreamJob with a Linux payload</h2>
<p>The Lazarus group&#8217;s Operation DreamJob involves approaching targets through LinkedIn and tempting them with job offers from industry leaders. The name was coined by ClearSky in a <a href="https://www.clearskysec.com/operation-dream-job/">paper</a> published in August 2020. That paper describes a Lazarus cyberespionage campaign targeting defense and aerospace companies. The activity has overlap with what we call Operation In(ter)ception, a series of cyberespionage attacks that have been ongoing since at least <a href="https://www.welivesecurity.com/wp-content/uploads/2020/06/ESET_Operation_Interception.pdf" target="_blank" rel="noopener">September 2019</a>. It targets aerospace, military, and defense companies and uses specific malicious, initially Windows-only, tools. During July and August 2022, we found two instances of Operation In(ter)ception targeting macOS. One malware sample was submitted to <a href="https://twitter.com/ESETresearch/status/1559553324998955010" target="_blank" rel="noopener">VirusTotal</a> from Brazil, and another attack targeted an ESET user in Argentina. A few weeks ago, a native Linux payload was found on VirusTotal with an HSBC-themed PDF lure. This completes Lazarus’s ability to target all major desktop operating systems.</p>
<p>On March 20<sup>th</sup>, a user in the country of Georgia submitted to VirusTotal a ZIP archive called <span style="font-family: 'courier new', courier, monospace;">HSBC job offer.pdf.zip</span>. Given other DreamJob campaigns by Lazarus, this payload was probably distributed through spearphishing or direct messages on LinkedIn. The archive contains a single file: a native 64-bit Intel Linux binary written in Go and named <span style="font-family: 'courier new', courier, monospace;">HSBC job offer․pdf</span>.</p>
<p>Interestingly, the file extension is not <span style="font-family: 'courier new', courier, monospace;">.pdf</span>. This is because the apparent dot character in the filename is a <a href="https://en.wikipedia.org/wiki/Leader_(typography)" target="_blank" rel="noopener">leader dot</a> represented by the U+2024 Unicode character. The use of the leader dot in the filename was probably an attempt to trick the file manager into treating the file as an executable instead of a PDF. This could cause the file to run when double-clicked instead of opening it with a PDF viewer. On execution, a decoy PDF is displayed to the user using <a href="https://portland.freedesktop.org/doc/xdg-open.html" target="_blank" rel="noopener">xdg-open</a>, which will open the document using the user’s preferred PDF viewer (see Figure 3). We decided to call this ELF downloader OdicLoader, as it has a similar role as the IconicLoaders on other platforms and the payload is fetched from OpenDrive.</p>
<p>OdicLoader drops a decoy PDF document, displays it using the system’s default PDF viewer (see Figure 2), and then downloads a second-stage backdoor from the <a href="https://www.opendrive.com/" target="_blank" rel="noopener">OpenDrive</a> cloud service. The downloaded file is stored in <span style="font-family: 'courier new', courier, monospace;">~/.config/guiconfigd</span> (SHA-1: <span style="font-family: 'courier new', courier, monospace;">0CA1723AFE261CD85B05C9EF424FC50290DCE7DF</span>). We call this second-stage backdoor SimplexTea.</p>
<p>As the last step of its execution, the OdicLoader modifies <span style="font-family: 'courier new', courier, monospace;">~/.bash_profile</span>, so SimplexTea is launched with Bash and its output is muted (<span style="font-family: 'courier new', courier, monospace;">~/.config/guiconfigd &gt;/dev/null 2&gt;&amp;1</span>).</p>
<div id="attachment_173260" style="width: 1530px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2023/04/2_scheme_OpDreamJob_Linux.png"><img class="wp-image-173260 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2023/04/2_scheme_OpDreamJob_Linux.png" alt="" width="1520" height="927" srcset="https://www.welivesecurity.com/wp-content/uploads/2023/04/2_scheme_OpDreamJob_Linux.png 1520w, https://www.welivesecurity.com/wp-content/uploads/2023/04/2_scheme_OpDreamJob_Linux-300x183.png 300w, https://www.welivesecurity.com/wp-content/uploads/2023/04/2_scheme_OpDreamJob_Linux-768x468.png 768w, https://www.welivesecurity.com/wp-content/uploads/2023/04/2_scheme_OpDreamJob_Linux-1024x625.png 1024w" sizes="(max-width: 1520px) 100vw, 1520px" /></a><p class="wp-caption-text"><em>Figure 2. Illustration of the probable chain of compromise</em></p></div>
<div id="attachment_173261" style="width: 844px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2023/04/3_HSBC_themed_lure.png"><img class="wp-image-173261 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2023/04/3_HSBC_themed_lure.png" alt="" width="834" height="1002" srcset="https://www.welivesecurity.com/wp-content/uploads/2023/04/3_HSBC_themed_lure.png 834w, https://www.welivesecurity.com/wp-content/uploads/2023/04/3_HSBC_themed_lure-250x300.png 250w, https://www.welivesecurity.com/wp-content/uploads/2023/04/3_HSBC_themed_lure-768x923.png 768w" sizes="(max-width: 834px) 100vw, 834px" /></a><p class="wp-caption-text"><em>Figure 3. An HSBC-themed lure in the Linux DreamJob campaign</em></p></div>
<p>SimplexTea is a Linux backdoor written in C++. As highlighted in Table 1, its class names are very similar to function names found in a sample, with filename <span style="font-family: 'courier new', courier, monospace;">sysnetd</span>, submitted to VirusTotal from Romania (SHA-1: <span style="font-family: 'courier new', courier, monospace;">F6760FB1F8B019AF2304EA6410001B63A1809F1D</span>). Because of the similarities in class names and function names between SimplexTea and <span style="font-family: 'courier new', courier, monospace;">sysnetd</span>, we believe SimplexTea is an updated version, rewritten from C to C++.</p>
<p><em>Table 1. Comparison of the original symbol names from two Linux backdoors submitted to VirusTotal</em></p>

<table id="tablepress-1260" class="tablepress tablepress-id-1260">
<tbody class="row-hover">
<tr class="row-1 odd">
	<td class="column-1"><p style="text-align: center;"><span style="font-family: courier new, courier, monospace;">guiconfigd</span><br />
(SimplexTea for Linux, from Georgia)</p></td><td class="column-2"><p style="text-align: center;"><span style="font-family: courier new, courier, monospace;">sysnetd</span><br />
(BADCALL for Linux, from Romania)</p></td>
</tr>
<tr class="row-2 even">
	<td class="column-1">C<FONT COLOR="#ff0000"><strong>MsgCmd</strong></font>::Start(void)</td><td class="column-2"><strong><FONT COLOR="#ff0000">MSG_Cmd</font></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">C<FONT COLOR="#ff0000"><strong>Msg</strong></font>Secure<FONT COLOR="#ff0000"><strong>Del</strong></font>::Start(void)</td><td class="column-2"><strong><FONT COLOR="#ff0000">MSG_Del</font></td>
</tr>
<tr class="row-4 even">
	<td class="column-1">C<FONT COLOR="#ff0000"><strong>MsgDir</strong></font>::Start(void)</td><td class="column-2"><strong><FONT COLOR="#ff0000">MSG_Dir</font></td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">C<FONT COLOR="#ff0000"><strong>MsgDown</strong></font>::Start(void)</td><td class="column-2"><strong><FONT COLOR="#ff0000">MSG_Down</font></td>
</tr>
<tr class="row-6 even">
	<td class="column-1">C<FONT COLOR="#ff0000"><strong>MsgExit</strong></font>::Start(void)</td><td class="column-2"><strong><FONT COLOR="#ff0000">MSG_Exit</font></td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">C<FONT COLOR="#ff0000"><strong>MsgReadConfig</strong></font>::Start(void)</td><td class="column-2"><strong><FONT COLOR="#ff0000">MSG_ReadConfig</font></td>
</tr>
<tr class="row-8 even">
	<td class="column-1">C<FONT COLOR="#ff0000"><strong>MsgRun</strong></font>::Start(void)</td><td class="column-2"><strong><FONT COLOR="#ff0000">MSG_Run</font></td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">C<FONT COLOR="#ff0000"><strong>MsgSetPath</strong></font>::Start(void)</td><td class="column-2"><strong><FONT COLOR="#ff0000">MSG_SetPath</font></td>
</tr>
<tr class="row-10 even">
	<td class="column-1">C<FONT COLOR="#ff0000"><strong>MsgSleep</strong></font>::Start(void)</td><td class="column-2"><strong><FONT COLOR="#ff0000">MSG_Sleep</font></td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">C<FONT COLOR="#ff0000"><strong>MsgTest</strong></font>::Start(void)</td><td class="column-2"><strong><FONT COLOR="#ff0000">MSG_Test</font></td>
</tr>
<tr class="row-12 even">
	<td class="column-1">C<FONT COLOR="#ff0000"><strong>MsgUp</strong></font>::Start(void)</td><td class="column-2"><strong><FONT COLOR="#ff0000">MSG_Up</font></td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">C<FONT COLOR="#ff0000"><strong>MsgWriteConfig</strong></font>::Start(void)</td><td class="column-2"><strong><FONT COLOR="#ff0000">MSG_WriteConfig</font></td>
</tr>
<tr class="row-14 even">
	<td class="column-1"></td><td class="column-2"><strong><FONT COLOR="#ff0000">MSG_GetComInfo</font></td>
</tr>
<tr class="row-15 odd">
	<td class="column-1">CMsgHibernate::Start(void)</td><td class="column-2"></td>
</tr>
<tr class="row-16 even">
	<td class="column-1">CMsgKeepCon::Start(void)</td><td class="column-2"></td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">CMsgZipDown::Start(void)</td><td class="column-2"></td>
</tr>
<tr class="row-18 even">
	<td class="column-1">CMsgZip::StartZip(void *)</td><td class="column-2"></td>
</tr>
<tr class="row-19 odd">
	<td class="column-1">CMsgZip::Start(void)</td><td class="column-2"></td>
</tr>
<tr class="row-20 even">
	<td class="column-1">CHttpWrapper::RecvData(uchar *&amp;,uint *,uint,signed char)</td><td class="column-2"></td>
</tr>
<tr class="row-21 odd">
	<td class="column-1"></td><td class="column-2">RecvMsg</td>
</tr>
<tr class="row-22 even">
	<td class="column-1">CHttpWrapper::<FONT COLOR="#ff0000"><strong>SendMsg</strong></font>(_MSG_STRUCT *)</td><td class="column-2"><FONT COLOR="#ff0000"><strong>SendMsg</strong></font></td>
</tr>
<tr class="row-23 odd">
	<td class="column-1">CHttpWrapper::SendData(uchar *,uint,uint)</td><td class="column-2"></td>
</tr>
<tr class="row-24 even">
	<td class="column-1">CHttpWrapper::SendMsg(uint,uint,uchar *,uint,uint)</td><td class="column-2"></td>
</tr>
<tr class="row-25 odd">
	<td class="column-1">CHttpWrapper::SendLoginData(uchar *,uint,uchar *&amp;,uint *)</td><td class="column-2"></td>
</tr>
</tbody>
</table>

<p>How is <span style="font-family: 'courier new', courier, monospace;">sysnetd</span> related to Lazarus? The following section shows similarities with Lazarus’s Windows backdoor called BADCALL.</p>
<h3>BADCALL for Linux</h3>
<p>We attribute <span style="font-family: 'courier new', courier, monospace;">sysnetd</span> to Lazarus because of its similarities with the following two files (and we believe that <span style="font-family: 'courier new', courier, monospace;">sysnetd</span> is a Linux variant of the group’s backdoor for Windows called BADCALL):</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">P2P_DLL.dll</span> (SHA-1: <span style="font-family: 'courier new', courier, monospace;">65122E5129FC74D6B5EBAFCC3376ABAE0145BC14</span>), which shows code similarities to <span style="font-family: 'courier new', courier, monospace;">sysnetd</span> in the form of domains used as a front for fake TLS connection (see Figure 4). It was attributed to Lazarus by CISA in <a href="https://web.archive.org/web/20220124183620/https:/www.cisa.gov/uscert/sites/default/files/publications/MAR-10135536-B_WHITE.PDF" target="_blank" rel="noopener">December 2017</a>. From <a href="https://www.cisa.gov/news-events/analysis-reports/ar19-252a" target="_blank" rel="noopener">September 2019</a>, CISA started to call newer versions of this malware BADCALL (SHA-1: <span style="font-family: 'courier new', courier, monospace;">D288766FA268BC2534F85FD06A5D52264E646C47</span>).</li>
</ul>
<div id="attachment_173262" style="width: 1189px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2023/04/4_similarities_fake_TLS.png"><img class="wp-image-173262 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2023/04/4_similarities_fake_TLS.png" alt="" width="1179" height="514" srcset="https://www.welivesecurity.com/wp-content/uploads/2023/04/4_similarities_fake_TLS.png 1179w, https://www.welivesecurity.com/wp-content/uploads/2023/04/4_similarities_fake_TLS-300x131.png 300w, https://www.welivesecurity.com/wp-content/uploads/2023/04/4_similarities_fake_TLS-768x335.png 768w, https://www.welivesecurity.com/wp-content/uploads/2023/04/4_similarities_fake_TLS-1024x446.png 1024w" sizes="(max-width: 1179px) 100vw, 1179px" /></a><p class="wp-caption-text"><em>Figure 4. Similarities between a Windows and a Linux variant of BADCALL (a list of domains used as a front for a fake TLS connection)</em></p></div>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">prtspool</span> (SHA-1: <span style="font-family: 'courier new', courier, monospace;">58B0516D28BD7218B1908FB266B8FE7582E22A5F</span>), which shows code similarities to <span style="font-family: 'courier new', courier, monospace;">sysnetd</span> (see Figure 5). It was attributed to Lazarus by <a href="https://www.cisa.gov/uscert/ncas/analysis-reports/ar21-048e" target="_blank" rel="noopener">CISA</a> in February 2021. Note as well that SIMPLESEA, a macOS backdoor found during the 3CX incident response, implements the <a href="https://en.wikipedia.org/wiki/A5/1" target="_blank" rel="noopener">A5/1</a> stream cipher.</li>
</ul>
<div id="attachment_173263" style="width: 1060px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2023/04/5_similarities_A5.png"><img class="wp-image-173263 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2023/04/5_similarities_A5.png" alt="" width="1050" height="270" srcset="https://www.welivesecurity.com/wp-content/uploads/2023/04/5_similarities_A5.png 1050w, https://www.welivesecurity.com/wp-content/uploads/2023/04/5_similarities_A5-300x77.png 300w, https://www.welivesecurity.com/wp-content/uploads/2023/04/5_similarities_A5-768x197.png 768w, https://www.welivesecurity.com/wp-content/uploads/2023/04/5_similarities_A5-1024x263.png 1024w" sizes="(max-width: 1050px) 100vw, 1050px" /></a><p class="wp-caption-text"><em>Figure 5. Similarities between AppleJeus for macOS and the Linux variant of BADCALL (the key for the A5/1 stream cipher)</em></p></div>
<p>This Linux version of the BADCALL backdoor, <span style="font-family: 'courier new', courier, monospace;">sysnetd</span>, loads its configuration from a file named <span style="font-family: 'courier new', courier, monospace;">/tmp/vgauthsvclog</span>. Since Lazarus operators have previously disguised their payloads, the use of this name, which is used by the VMware Guest Authentication service, suggests that the targeted system may be a Linux VMware virtual machine. Interestingly, the XOR key in this case is the same as one used in SIMPLESEA from the 3CX investigation.</p>
<div id="attachment_173264" style="width: 561px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2023/04/6_sysnetd_LoadConfig.png"><img class="wp-image-173264 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2023/04/6_sysnetd_LoadConfig.png" alt="" width="551" height="447" srcset="https://www.welivesecurity.com/wp-content/uploads/2023/04/6_sysnetd_LoadConfig.png 551w, https://www.welivesecurity.com/wp-content/uploads/2023/04/6_sysnetd_LoadConfig-300x243.png 300w, https://www.welivesecurity.com/wp-content/uploads/2023/04/6_sysnetd_LoadConfig-222x179.png 222w" sizes="(max-width: 551px) 100vw, 551px" /></a><p class="wp-caption-text"><em>Figure 6. Loading a configuration file by BADCALL for Linux, cf. Figure 8</em></p></div>
<p>Taking a look at the three 32-bit integers, <span style="font-family: 'courier new', courier, monospace;">0xC2B45678</span>, <span style="font-family: 'courier new', courier, monospace;">0x90ABCDEF</span>, and <span style="font-family: 'courier new', courier, monospace;">0xFE268455</span> from Figure 5, which represent a key for a custom implementation of the A5/1 cipher, we realized that the same algorithm and the identical keys were used in Windows malware that dates back to the end of 2014 and was involved in one of the most notorious Lazarus cases: the cybersabotage of Sony Pictures Entertainment (SHA-1: <span style="font-family: 'courier new', courier, monospace;">1C66E67A8531E3FF1C64AE57E6EDFDE7BEF2352D</span>).</p>
<div id="attachment_173265" style="width: 1960px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2023/04/7_similarities_with_SPE.png"><img class="wp-image-173265 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2023/04/7_similarities_with_SPE.png" alt="" width="1950" height="887" srcset="https://www.welivesecurity.com/wp-content/uploads/2023/04/7_similarities_with_SPE.png 1950w, https://www.welivesecurity.com/wp-content/uploads/2023/04/7_similarities_with_SPE-300x136.png 300w, https://www.welivesecurity.com/wp-content/uploads/2023/04/7_similarities_with_SPE-768x349.png 768w, https://www.welivesecurity.com/wp-content/uploads/2023/04/7_similarities_with_SPE-1024x466.png 1024w" sizes="(max-width: 1950px) 100vw, 1950px" /></a><p class="wp-caption-text"><em>Figure 7. The decryption routine shared between the BADCALL for Linux and targeted destructive malware for Windows from 2014</em></p></div>
<h3>Additional attribution data points</h3>
<p>To recap what we’ve covered so far, we attribute the 3CX supply-chain attack to the Lazarus group with a high level of confidence. This is based on the following factors:</p>
<ol>
<li>Malware (the intrusion set):
<ol style="list-style-type: lower-alpha;">
<li>The IconicLoader (<span style="font-family: 'courier new', courier, monospace;">samcli.dll</span>) uses the same type of strong encryption – AES-GCM – as SimplexTea (whose attribution to Lazarus was established via the similarity with BALLCALL for Linux); only the keys and initialization vectors differ.</li>
<li>Based on the PE Rich Headers, both IconicLoader (<span style="font-family: 'courier new', courier, monospace;">samcli.dll</span>) and IconicStealer (<span style="font-family: 'courier new', courier, monospace;">sechost.dll</span>) are projects of a similar size and compiled in the same Visual Studio environment as the executables <span style="font-family: 'courier new', courier, monospace;">iertutil.dll</span> (SHA-1: <span style="font-family: 'courier new', courier, monospace;">5B03294B72C0CAA5FB20E7817002C600645EB475</span>) and <span style="font-family: 'courier new', courier, monospace;">iertutil.dll</span> (SHA-1: <span style="font-family: 'courier new', courier, monospace;">7491BD61ED15298CE5EE5FFD01C8C82A2CDB40EC</span>) reported in the Lazarus cryptocurrency campaigns by <a href="https://www.volexity.com/blog/2022/12/01/buyer-beware-fake-cryptocurrency-applications-serving-as-front-for-applejeus-malware/" target="_blank" rel="noopener">Volexity</a> and <a href="https://www.microsoft.com/en-us/security/blog/2022/12/06/dev-0139-launches-targeted-attacks-against-the-cryptocurrency-industry/" target="_blank" rel="noopener">Microsoft</a>. We include below the YARA rule <span style="font-family: 'courier new', courier, monospace;">RichHeaders_Lazarus_NukeSped_IconicPayloads_3CX_Q12023</span>, which flags all these samples, and no unrelated malicious or clean files, as tested on the current ESET databases and recent VirusTotal submissions.</li>
<li>SimplexTea payload loads its configuration in a very similar way to the SIMPLESEA malware from the 3CX official incident response. The XOR key differs (<span style="font-family: 'courier new', courier, monospace;">0x5E</span> vs. <span style="font-family: 'courier new', courier, monospace;">0x7E</span>), but the configuration bears the same name: <span style="font-family: 'courier new', courier, monospace;">apdl.cf</span> (see Figure 8).</li>
</ol>
</li>
</ol>
<div id="attachment_173266" style="width: 1014px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2023/04/8_SimplexTea_LoadConfig.png"><img class="wp-image-173266 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2023/04/8_SimplexTea_LoadConfig.png" alt="" width="1004" height="647" srcset="https://www.welivesecurity.com/wp-content/uploads/2023/04/8_SimplexTea_LoadConfig.png 1004w, https://www.welivesecurity.com/wp-content/uploads/2023/04/8_SimplexTea_LoadConfig-300x193.png 300w, https://www.welivesecurity.com/wp-content/uploads/2023/04/8_SimplexTea_LoadConfig-768x495.png 768w, https://www.welivesecurity.com/wp-content/uploads/2023/04/8_SimplexTea_LoadConfig-65x42.png 65w" sizes="(max-width: 1004px) 100vw, 1004px" /></a><p class="wp-caption-text"><em>Figure 8. Loading a configuration file by SimplexTea for Linux, cf. Figure 6</em></p></div>
<ol start="2">
<li>Infrastructure:
<ol style="list-style-type: lower-alpha;">
<li>There is shared network infrastructure with SimplexTea, as it uses <span style="font-family: 'courier new', courier, monospace;">https://journalide[.]org/djour.php</span> as it C&amp;C, whose domain is reported in the <a href="https://www.3cx.com/blog/news/mandiant-initial-results/" target="_blank" rel="noopener">official results</a> of the incident response of the 3CX compromise by Mandiant.</li>
</ol>
</li>
</ol>
<div id="attachment_173267" style="width: 1145px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2023/04/9_SimplexTea_CnC.png"><img class="wp-image-173267 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2023/04/9_SimplexTea_CnC.png" alt="" width="1135" height="513" srcset="https://www.welivesecurity.com/wp-content/uploads/2023/04/9_SimplexTea_CnC.png 1135w, https://www.welivesecurity.com/wp-content/uploads/2023/04/9_SimplexTea_CnC-300x136.png 300w, https://www.welivesecurity.com/wp-content/uploads/2023/04/9_SimplexTea_CnC-768x347.png 768w, https://www.welivesecurity.com/wp-content/uploads/2023/04/9_SimplexTea_CnC-1024x463.png 1024w" sizes="(max-width: 1135px) 100vw, 1135px" /></a><p class="wp-caption-text"><em>Figure 9. A hardcoded URL in SimplexTea for Linux</em></p></div>
<h2>Conclusion</h2>
<p>The 3CX compromise has gained a lot of attention from the security community since its disclosure on March 29<sup>th</sup>. This compromised software, deployed on various IT infrastructures, which allows the download and execution of any kind of payload, can have devastating impacts. Unfortunately, no software publisher is immune to being compromised and inadvertently distributing trojanized versions of their applications.</p>
<p>The stealthiness of a supply-chain attack makes this method of distributing malware very appealing from an attacker’s perspective. Lazarus has already used <a href="https://www.welivesecurity.com/2020/11/16/lazarus-supply-chain-attack-south-korea/" target="_blank" rel="noopener">this technique</a> in the past, targeting South Korean users of WIZVERA VeraPort software in 2020. Similarities with existing malware from the Lazarus toolset and with the group’s typical techniques strongly suggest the recent 3CX compromise is the work of Lazarus as well.</p>
<p>It is also interesting to note that Lazarus can produce and use malware for all major desktop operating systems: Windows, macOS, and Linux. Both Windows and macOS systems were targeted during the 3CX incident, with 3CX’s VoIP software for both operating systems being trojanized to include malicious code to fetch arbitrary payloads. In the case of 3CX, both Windows and macOS second-stage malware versions exist. This article demonstrates the existence of a Linux backdoor that probably corresponds to the SIMPLESEA macOS malware seen in the 3CX incident. We named this Linux component SimplexTea and showed that it is part of Operation DreamJob, Lazarus’s flagship campaign using job offers to lure and compromise unsuspecting victims.</p>
<p><em><div class="update-block">For any inquiries about our research published on WeLiveSecurity, please contact us at <a href="mailto:threatintel@eset.com?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=autotagging&amp;utm_content=eset-research&amp;utm_term=en">threatintel@eset.com</a>.</em></p>
<p><em>ESET Research offers private APT intelligence reports and data feeds. For any inquiries about this service, visit the <a href="https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=wls-research&amp;utm_content=linux-malware-strengthens-links-lazarus-3cx-supply-chain-attack" target="_blank" rel="noopener">ESET Threat Intelligence</a> page.</div></em></p>
<h2>IoCs</h2>
<h3>Files</h3>

<table id="tablepress-1261" class="tablepress tablepress-id-1261">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Filename</th><th class="column-3">ESET detection name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">0CA1723AFE261CD85B05C9EF424FC50290DCE7DF</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">guiconfigd</span></td><td class="column-3">Linux/NukeSped.E</td><td class="column-4"><nobr>SimplexTea for Linux.</nobr></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">3A63477A078CE10E53DFB5639E35D74F93CEFA81</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">HSBC_job_offer&#8228;pdf</span></td><td class="column-3">Linux/NukeSped.E</td><td class="column-4">OdicLoader, a 64-bit downloader for Linux, written in Go.</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">9D8BADE2030C93D0A010AA57B90915EB7D99EC82</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">HSBC_job_offer.pdf.zip</span></td><td class="column-3">Linux/NukeSped.E</td><td class="column-4">A ZIP archive with a Linux payload, from VirusTotal.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">F6760FB1F8B019AF2304EA6410001B63A1809F1D</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">sysnetd</span></td><td class="column-3">Linux/NukeSped.G</td><td class="column-4">BADCALL for Linux.</td>
</tr>
</tbody>
</table>

<h3>Network</h3>

<table id="tablepress-1262" class="tablepress tablepress-id-1262">
<thead>
<tr class="row-1 odd">
	<th class="column-1">IP address</th><th class="column-2">Domain</th><th class="column-3">Hosting provider</th><th class="column-4">First seen</th><th class="column-5">Details</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">23.254.211[.]230</span></td><td class="column-2">N/A</td><td class="column-3">Hostwinds LLC.</td><td class="column-4">N/A</td><td class="column-5">C&amp;C server for BADCALL for Linux</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">38.108.185[.]79</span><br />
<span style="font-family: courier new, courier, monospace;">38.108.185[.]115</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">od[.]lk</span></td><td class="column-3">Cogent Communications</td><td class="column-4"><nobr>2023-03-16</nobr></td><td class="column-5">Remote OpenDrive storage containing SimplexTea (<span style="font-family: courier new, courier, monospace;">/d/NTJfMzg4MDE1NzJf/vxmedia</span>)</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">172.93.201[.]88</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">journalide[.]org</span></td><td class="column-3">Nexeon Technologies, Inc.</td><td class="column-4"><nobr>2023-03-29</nobr></td><td class="column-5">C&amp;C server for SimplexTea (<span style="font-family: courier new, courier, monospace;">/djour.php</span>)</td>
</tr>
</tbody>
</table>

<h2>MITRE ATT&amp;CK techniques</h2>

<table id="tablepress-1263" class="tablepress tablepress-id-1263">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Reconnaissance</td><td class="column-2"><a href="https://attack.mitre.org/versions/v12/techniques/T1593/001/" rel="noopener" target="_blank">T1593.001</a></td><td class="column-3">Search Open Websites/Domains: Social Media</td><td class="column-4">Lazarus attackers probably approached a target with a fake HSBC-themed job offer that would fit the target’s interest. This has been done mostly via LinkedIn in the past. </td>
</tr>
<tr class="row-3 odd">
	<td rowspan="4" class="column-1">Resource Development</td><td class="column-2"><a href="https://attack.mitre.org/versions/v12/techniques/T1583/001/" rel="noopener" target="_blank">T1584.001</a></td><td class="column-3">Acquire Infrastructure: Domains</td><td class="column-4">Unlike many previous cases of compromised C&amp;Cs used in Operation DreamJob, Lazarus operators registered their own domain for the Linux target.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v12/techniques/T1587/001/" rel="noopener" target="_blank">T1587.001</a></td><td class="column-3">Develop Capabilities: Malware</td><td class="column-4">Custom tools from the attack are very likely developed by the attackers.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1585/003/" rel="noopener" target="_blank">T1585.003</a></td><td class="column-3">Establish Accounts: Cloud Accounts</td><td class="column-4">The attackers hosted the final stage on the cloud service OpenDrive.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1608/001/" rel="noopener" target="_blank">T1608.001</a></td><td class="column-3">Stage Capabilities: Upload Malware</td><td class="column-4">The attackers hosted the final stage on the cloud service OpenDrive.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1204/002/" rel="noopener" target="_blank">T1204.002</a></td><td class="column-3">User Execution: Malicious File</td><td class="column-4">OdicLoader masquerades as a PDF file in order to fool the target.</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/versions/v12/techniques/T1566/002/" rel="noopener" target="_blank">T1566.002</a></td><td class="column-3">Phishing: Spearphishing Link</td><td class="column-4">The target likely received a link to third-party remote storage with a malicious ZIP archive, which was later submitted to VirusTotal.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1546/004/" rel="noopener" target="_blank">T1546.004</a></td><td class="column-3">Event Triggered Execution: Unix Shell Configuration Modification</td><td class="column-4">OdicLoader modifies the victim’s Bash profile, so SimplexTea is launched each time Bash is stared and its output is muted.</td>
</tr>
<tr class="row-10 even">
	<td rowspan="6" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/versions/v12/techniques/T1134/002/" rel="noopener" target="_blank">T1134.002</a></td><td class="column-3">Access Token Manipulation: Create Process with Token</td><td class="column-4">SimplexTea can create a new process, if instructed by its C&amp;C server.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v11/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td><td class="column-3">Deobfuscate/Decode Files or Information</td><td class="column-4">SimplexTea stores its configuration in an encrypted <span style="font-family: courier new, courier, monospace;">apdl.cf</span>.</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v12/techniques/T1027/009/" rel="noopener" target="_blank">T1027.009</a></td><td class="column-3">Obfuscated Files or Information: Embedded Payloads</td><td class="column-4">The droppers of all malicious chains contain an embedded data array with an additional stage.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v12/techniques/T1562/003/" rel="noopener" target="_blank">T1562.003</a></td><td class="column-3">Impair Defenses: Impair Command History Logging</td><td class="column-4">OdicLoader modifies the victim’s Bash profile, so the output and error messages from SimplexTea are muted. SimplexTea executes new processes with the same technique.</td>
</tr>
<tr class="row-14 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v12/techniques/T1070/004/" rel="noopener" target="_blank">T1070.004</a></td><td class="column-3">Indicator Removal: File Deletion</td><td class="column-4">SimplexTea has the ability to delete files securely.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v12/techniques/T1497/003/" rel="noopener" target="_blank">T1497.003</a></td><td class="column-3">Virtualization/Sandbox Evasion: Time Based Evasion</td><td class="column-4">SimplexTea implements multiple custom sleep delays in its execution.</td>
</tr>
<tr class="row-16 even">
	<td class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/versions/v12/techniques/T1083/" rel="noopener" target="_blank">T1083</a></td><td class="column-3">File and Directory Discovery</td><td class="column-4">SimplexTea can list the directory content together with their names, sizes, and timestamps (mimicking the <span style="font-family: courier new, courier, monospace;">ls -la</span> command).</td>
</tr>
<tr class="row-17 odd">
	<td rowspan="4" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/versions/v12/techniques/T1071/001/" rel="noopener" target="_blank">T1071.001</a></td><td class="column-3">Application Layer Protocol: Web Protocols</td><td class="column-4">SimplexTea can use HTTP and HTTPS for communication with its C&amp;C server, using a statically linked Curl library.</td>
</tr>
<tr class="row-18 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v11/techniques/T1573/001/" rel="noopener" target="_blank">T1573.001</a></td><td class="column-3">Encrypted Channel: Symmetric Cryptography</td><td class="column-4">SimplexTea encrypts C&amp;C traffic using the AES-GCM algorithm.</td>
</tr>
<tr class="row-19 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v11/techniques/T1132/001/" rel="noopener" target="_blank">T1132.001</a></td><td class="column-3">Data Encoding: Standard Encoding</td><td class="column-4">SimplexTea encodes C&amp;C traffic using base64.</td>
</tr>
<tr class="row-20 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1090/" rel="noopener" target="_blank">T1090</a></td><td class="column-3">Proxy</td><td class="column-4">SimplexTea can utilize a proxy for communications.</td>
</tr>
<tr class="row-21 odd">
	<td class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/versions/v12/techniques/T1041/" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over C2 Channel</td><td class="column-4">SimplexTea can exfiltrate data as ZIP archives to its C&amp;C server.</td>
</tr>
</tbody>
</table>

<h2>Appendix</h2>
<p>This YARA rule flags the cluster containing both IconicLoader and IconicStealer, as well as the payloads deployed in the cryptocurrency campaigns from December 2022.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6457bfad3665e108041822" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
/*
The following rule will only work with YARA version &gt;= 3.11.0
*/
import "pe"
rule RichHeaders_Lazarus_NukeSped_IconicPayloads_3CX_Q12023
{
	meta:
		description = " Rich Headers-based rule covering the IconicLoader and IconicStealer from the 3CX supply chain incident, and also payloads from the cryptocurrency campaigns from 2022-12"
		author = "ESET Research"
		date = "2023-03-31"
		hash = "3B88CDA62CDD918B62EF5AA8C5A73A46F176D18B"
		hash = "CAD1120D91B812ACAFEF7175F949DD1B09C6C21A"
		hash = "5B03294B72C0CAA5FB20E7817002C600645EB475"
		hash = "7491BD61ED15298CE5EE5FFD01C8C82A2CDB40EC"
	condition:
		pe.rich_signature.toolid(259, 30818) == 9 and
		pe.rich_signature.toolid(256, 31329) == 1 and
		pe.rich_signature.toolid(261, 30818) &gt;= 30 and pe.rich_signature.toolid(261, 30818) &lt;= 38 and
		pe.rich_signature.toolid(261, 29395) &gt;= 134 and pe.rich_signature.toolid(261, 29395) &lt;= 164 and
		pe.rich_signature.toolid(257, 29395) &gt;= 6 and pe.rich_signature.toolid(257, 29395) &lt;= 14
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-1">1</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-2">2</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-3">3</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-4">4</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-5">5</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-6">6</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-7">7</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-8">8</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-9">9</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-10">10</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-11">11</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-12">12</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-13">13</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-14">14</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-15">15</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-16">16</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-17">17</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-18">18</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-19">19</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-20">20</div><div class="crayon-num" data-line="crayon-6457bfad3665e108041822-21">21</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6457bfad3665e108041822-1">/*</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-2">The following rule will only work with YARA version &gt;= 3.11.0</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-3">*/</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-4">import "pe"</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-5">rule RichHeaders_Lazarus_NukeSped_IconicPayloads_3CX_Q12023</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-6">{</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-7">	meta:</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-8">		description = " Rich Headers-based rule covering the IconicLoader and IconicStealer from the 3CX supply chain incident, and also payloads from the cryptocurrency campaigns from 2022-12"</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-9">		author = "ESET Research"</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-10">		date = "2023-03-31"</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-11">		hash = "3B88CDA62CDD918B62EF5AA8C5A73A46F176D18B"</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-12">		hash = "CAD1120D91B812ACAFEF7175F949DD1B09C6C21A"</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-13">		hash = "5B03294B72C0CAA5FB20E7817002C600645EB475"</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-14">		hash = "7491BD61ED15298CE5EE5FFD01C8C82A2CDB40EC"</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-15">	condition:</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-16">		pe.rich_signature.toolid(259, 30818) == 9 and</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-17">		pe.rich_signature.toolid(256, 31329) == 1 and</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-18">		pe.rich_signature.toolid(261, 30818) &gt;= 30 and pe.rich_signature.toolid(261, 30818) &lt;= 38 and</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-19">		pe.rich_signature.toolid(261, 29395) &gt;= 134 and pe.rich_signature.toolid(261, 29395) &lt;= 164 and</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-20">		pe.rich_signature.toolid(257, 29395) &gt;= 6 and pe.rich_signature.toolid(257, 29395) &lt;= 14</div><div class="crayon-line" id="crayon-6457bfad3665e108041822-21">}</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>&nbsp;</p>
<p><a class="no-fancy" href="https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=wls-research&amp;utm_content=linux-malware-strengthens-links-lazarus-3cx-supply-chain-attack" target="_blank" rel="noopener"><img class="aligncenter wp-image-168101 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2022/12/eset-threat-intelligence.png" alt="" width="915" height="296" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/12/eset-threat-intelligence.png 915w, https://www.welivesecurity.com/wp-content/uploads/2022/12/eset-threat-intelligence-300x97.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/12/eset-threat-intelligence-768x248.png 768w" sizes="(max-width: 915px) 100vw, 915px" /></a></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/pkalnai/" title="Peter Kálnai">
                    Peter Kálnai                </a>
            </div>
        </div>
                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/marc-etienne/" title="Marc-Etienne M.Léveillé">
                    Marc-Etienne M.Léveillé                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2023-04-20 11:30:34">20 Apr 2023 - 11:30AM</time>
                                    </span>
                                </div>
                            
                                <div class="widgets row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                <h3><span class="text"><em>Sign up to receive an email update whenever a new article is published in our <a href="https://www.welivesecurity.com/category/ukraine-crisis-digital-security-resource-center/" target="_blank" rel="noopener">Ukraine Crisis – Digital Security Resource Center</a></em></span></h3>
            </div>
        </div>
        <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
            <form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
                <div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="TOPIC" value="We Live Security Ukraine Newsletter">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button class="button-flag">
                        Submit                    </button>
                </div>
            </form>
        </div>
    </div>
                                <div class="widgets row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                <h3><span class="text">Newsletter</span></h3>
            </div>
        </div>
        <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
            <form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
                <div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="NEWSLETTER" value="We Live Security">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button class="">
                        Submit                    </button>
                </div>
            </form>
        </div>
    </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/eset-research/" class="category-tag-btn">ESET Research</a>                                                <a href="https://www.welivesecurity.com/2023/04/26/evasive-panda-apt-group-malware-updates-popular-chinese-software/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2023/04/evasive-panda-eset-research-chinese-software-update-623x432.jpg"
                                                         alt="Linux malware strengthens links between Lazarus and the 3CX supply&#8209;chain attack">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2023/04/26/evasive-panda-apt-group-malware-updates-popular-chinese-software/">
                                                    Evasive Panda APT group delivers malware via updates for popular Chinese software                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/eset-research/" class="category-tag-btn">ESET Research</a>                                                <a href="https://www.welivesecurity.com/2023/04/18/discarded-not-destroyed-old-routers-reveal-corporate-secrets/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2023/04/corporate-IT-router.jpg"
                                                         alt="Linux malware strengthens links between Lazarus and the 3CX supply&#8209;chain attack">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2023/04/18/discarded-not-destroyed-old-routers-reveal-corporate-secrets/">
                                                    Discarded, not destroyed: Old routers reveal corporate secrets                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/eset-research/" class="category-tag-btn">ESET Research</a>                                                <a href="https://www.welivesecurity.com/2023/03/30/eset-research-podcast-year-fighting-rockets-soldiers-wipers-ukraine/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2022/07/eset-research-podcast-rsa-623x416.png"
                                                         alt="Linux malware strengthens links between Lazarus and the 3CX supply&#8209;chain attack">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2023/03/30/eset-research-podcast-year-fighting-rockets-soldiers-wipers-ukraine/">
                                                    ESET Research Podcast: A&nbsp;year of fighting rockets, soldiers, and wipers in Ukraine                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/eset-research/" class="category-tag-btn">ESET Research</a>                                                <a href="https://www.welivesecurity.com/2023/03/16/not-so-private-messaging-trojanized-whatsapp-telegram-cryptocurrency-wallets/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2023/03/whatsapp-telegram-crypto-wallets-clippers-623x432.jpg"
                                                         alt="Linux malware strengthens links between Lazarus and the 3CX supply&#8209;chain attack">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2023/03/16/not-so-private-messaging-trojanized-whatsapp-telegram-cryptocurrency-wallets/">
                                                    Not-so-private messaging: Trojanized WhatsApp and Telegram apps go after cryptocurrency wallets                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal information								</a>
							</span>
													<span>
								<a href="#">
									Manage cookies								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2023%2F04%2F20%2Flinux-malware-strengthens-links-lazarus-3cx-supply-chain-attack%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2023%2F04%2F20%2Flinux-malware-strengthens-links-lazarus-3cx-supply-chain-attack%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2023%2F04%2F20%2Flinux-malware-strengthens-links-lazarus-3cx-supply-chain-attack%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/js/main.js?id=fef3139dcedd23afc232"></script>
    <!-- Version: v1.13.1.b3e4e0.pro.azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"173252 https:\/\/backend.welivesecurity.com\/?p=173252","disqusShortname":"welivesecurity","disqusTitle":"Linux malware strengthens links between Lazarus and the 3CX supply\u2011chain attack","disqusUrl":"https:\/\/www.welivesecurity.com\/2023\/04\/20\/linux-malware-strengthens-links-lazarus-3cx-supply-chain-attack\/","postId":"173252"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
  </body>
</html>
